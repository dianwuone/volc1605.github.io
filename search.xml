<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[java操作Excel]]></title>
      <url>https://volc1605.github.io/2016/12/24/java%E8%A7%A3%E6%9E%90Excel%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      <content type="html"><![CDATA[<h3 id="java解析-xlsx或者xls格式数据"><a href="#java解析-xlsx或者xls格式数据" class="headerlink" title="java解析.xlsx或者xls格式数据"></a>java解析.xlsx或者xls格式数据</h3><a id="more"></a>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</div><div class="line"><span class="keyword">import</span> java.lang.reflect.Method;</div><div class="line"><span class="keyword">import</span> java.text.DecimalFormat;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Cell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Row;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Sheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Workbook;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.WorkbookFactory;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@param</span> &lt;E&gt;</div><div class="line"> * <span class="doctag">@ClassName</span> ReadExcelToList</div><div class="line"> * <span class="doctag">@Description</span> 读取xlsx数据返回list集合</div><div class="line"> * <span class="doctag">@Author</span> youtanzhi</div><div class="line"> * <span class="doctag">@Date</span> 2016年12月23日 下午4:09:30 需要注意的是导入的 poi相关jar包版本号要一致</div><div class="line"> * 需要两个jar包:poi和poi-ooxml</div><div class="line"> *       &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</div><div class="line"> *       &lt;artifactId&gt;poi&lt;/artifactId&gt;</div><div class="line"> *       &lt;version&gt;3.10-FINAL&lt;/version&gt; &lt;/dependency&gt; &lt;!--</div><div class="line"> *       https://mvnrepository.com/artifact/org.apache.poi/poi-ooxml --&gt;</div><div class="line"> *       &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</div><div class="line"> *       &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;</div><div class="line"> *       &lt;version&gt;3.10-FINAL&lt;/version&gt; &lt;/dependency&gt;</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReadExcelToList</span>&lt;<span class="title">E</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;E&gt; <span class="title">getList</span><span class="params">(String file_dir, Class&lt;? extends Object&gt; classObj)</span> <span class="keyword">throws</span> IOException,</span></div><div class="line">	    InstantiationException, IllegalAccessException, IllegalArgumentException, InvocationTargetException &#123;</div><div class="line">	List&lt;E&gt; dataList = <span class="keyword">new</span> ArrayList&lt;E&gt;();</div><div class="line">	Method[] methods = classObj.getMethods();</div><div class="line">	Method m = <span class="keyword">null</span>;</div><div class="line">	List&lt;Method&gt; beanMehtodList = <span class="keyword">new</span> ArrayList&lt;Method&gt;();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; methods.length; x++) &#123;</div><div class="line">	    m = methods[x];</div><div class="line">	    beanMehtodList.add(m);</div><div class="line">	&#125;</div><div class="line">	Workbook book = <span class="keyword">null</span>;</div><div class="line">	book = getExcelWorkbook(file_dir);</div><div class="line">	Sheet sheet = getSheetByNum(book, <span class="number">0</span>);</div><div class="line">	<span class="keyword">int</span> lastRowNum = sheet.getLastRowNum();</div><div class="line">	System.out.println(<span class="string">"last number is "</span> + lastRowNum);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= lastRowNum; i++) &#123;</div><div class="line">	    Row row = <span class="keyword">null</span>;</div><div class="line">	    row = sheet.getRow(i);</div><div class="line">	    <span class="keyword">if</span> (row != <span class="keyword">null</span>) &#123;</div><div class="line">		System.out.println(<span class="string">"reading line is "</span> + i);</div><div class="line">		<span class="keyword">int</span> lastCellNum = row.getLastCellNum();</div><div class="line">		System.out.println(<span class="string">"lastCellNum is "</span> + lastCellNum);</div><div class="line">		Cell cell = <span class="keyword">null</span>;</div><div class="line">		<span class="comment">// 创建泛型对象</span></div><div class="line">		Object newInstance = classObj.newInstance();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; lastCellNum; j++) &#123;</div><div class="line">		    cell = row.getCell(j);</div><div class="line">		    String value = getValue(cell);</div><div class="line">		    <span class="keyword">if</span> (j == <span class="number">0</span>) &#123;</div><div class="line">			Method method = beanMehtodList.get(<span class="number">4</span>);</div><div class="line">			method.invoke(newInstance, value);</div><div class="line">		    &#125;</div><div class="line">		&#125;</div><div class="line">		dataList.add((E) newInstance);</div><div class="line">	    &#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> dataList;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Sheet <span class="title">getSheetByNum</span><span class="params">(Workbook book, <span class="keyword">int</span> number)</span> </span>&#123;</div><div class="line">	Sheet sheet = <span class="keyword">null</span>;</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">	    sheet = book.getSheetAt(number);</div><div class="line">	    <span class="comment">// if(sheet == null)&#123;</span></div><div class="line">	    <span class="comment">// sheet = book.createSheet("Sheet"+number);</span></div><div class="line">	    <span class="comment">// &#125;</span></div><div class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">	    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e.getMessage());</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> sheet;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Workbook <span class="title">getExcelWorkbook</span><span class="params">(String filePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">	Workbook book = <span class="keyword">null</span>;</div><div class="line">	File file = <span class="keyword">null</span>;</div><div class="line">	FileInputStream fis = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">	    file = <span class="keyword">new</span> File(filePath); <span class="comment">// filePath:E:/f/t.xls</span></div><div class="line">	    <span class="keyword">if</span> (!file.exists()) &#123;</div><div class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"文件不存在"</span>);</div><div class="line">	    &#125; <span class="keyword">else</span> &#123;</div><div class="line">		fis = <span class="keyword">new</span> FileInputStream(file);</div><div class="line">		book = WorkbookFactory.create(fis);</div><div class="line">	    &#125;</div><div class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">	    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e.getMessage());</div><div class="line">	&#125; <span class="keyword">finally</span> &#123;</div><div class="line">	    <span class="keyword">if</span> (fis != <span class="keyword">null</span>) &#123;</div><div class="line">		fis.close();</div><div class="line">	    &#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> book;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">(Cell hssfCell)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (hssfCell.getCellType() == hssfCell.CELL_TYPE_BOOLEAN) &#123;</div><div class="line">	    <span class="comment">// 返回布尔类型的值</span></div><div class="line">	    <span class="keyword">return</span> String.valueOf(hssfCell.getBooleanCellValue());</div><div class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (hssfCell.getCellType() == hssfCell.CELL_TYPE_NUMERIC) &#123;</div><div class="line">	    <span class="comment">// 返回数值类型的值</span></div><div class="line">	    Object inputValue = <span class="keyword">null</span>;<span class="comment">// 单元格值</span></div><div class="line">	    Long longVal = Math.round(hssfCell.getNumericCellValue());</div><div class="line">	    Double doubleVal = hssfCell.getNumericCellValue();</div><div class="line">	    <span class="keyword">if</span> (Double.parseDouble(longVal + <span class="string">".0"</span>) == doubleVal) &#123; <span class="comment">// 判断是否含有小数位.0</span></div><div class="line">		inputValue = longVal;</div><div class="line">	    &#125; <span class="keyword">else</span> &#123;</div><div class="line">		inputValue = doubleVal;</div><div class="line">	    &#125;</div><div class="line">	    DecimalFormat df = <span class="keyword">new</span> DecimalFormat(<span class="string">"#.####"</span>); <span class="comment">// 格式化为四位小数，按自己需求选择；</span></div><div class="line">	    <span class="keyword">return</span> String.valueOf(df.format(inputValue)); <span class="comment">// 返回String类型</span></div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">	    <span class="comment">// 返回字符串类型的值</span></div><div class="line">	    <span class="keyword">return</span> String.valueOf(hssfCell.getStringCellValue());</div><div class="line">	&#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">imporDataFromExcel</span><span class="params">(Map&lt;String, Object&gt; param)</span> </span>&#123;</div><div class="line">	String file = <span class="string">"E:/f/t.xls"</span>;</div><div class="line">	StationRegister stationRegister = <span class="keyword">new</span> StationRegister();</div><div class="line">	ReadExcelToList&lt;StationRegister&gt; readExcelToList = <span class="keyword">new</span> ReadExcelToList&lt;StationRegister&gt;();</div><div class="line">	List&lt;StationRegister&gt; list = <span class="keyword">null</span>;</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">	    <span class="keyword">try</span> &#123;</div><div class="line">			list = readExcelToList.getList(file, stationRegister.getClass());</div><div class="line">	    &#125; <span class="keyword">catch</span> (IllegalArgumentException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">	    &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">	    &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">	    &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">	    &#125;</div><div class="line">	&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">	    e.printStackTrace();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="java导出为-xlsx或者xls"><a href="#java导出为-xlsx或者xls" class="headerlink" title="java导出为.xlsx或者xls"></a>java导出为.xlsx或者xls</h3><p>导出.xlsx<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileOutputStream;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.util.HSSFColor;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Cell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.CellStyle;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Font;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Row;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Sheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Workbook;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@ClassName</span> ReadDataToXlsx2</div><div class="line"> * <span class="doctag">@Description</span> 导出excel.xlsx格式</div><div class="line"> * <span class="doctag">@Author</span> youtanzhi</div><div class="line"> * <span class="doctag">@Date</span> 2016年12月27日 上午10:48:56</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReadDataToXlsx2</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// 存储路径</span></div><div class="line">    <span class="keyword">private</span> String excelPath = <span class="string">"D:/data.xlsx"</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">	ReadDataToXlsx2 excel = <span class="keyword">new</span> ReadDataToXlsx2();</div><div class="line">	<span class="keyword">if</span> (excel.createExcelFile()) &#123;</div><div class="line">	    System.out.println(<span class="string">"data.xlsx is created successfully."</span>);</div><div class="line">	&#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">createExcelFile</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">boolean</span> isCreateSuccess = <span class="keyword">false</span>;</div><div class="line">	Workbook workbook = <span class="keyword">null</span>;</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">	    workbook = <span class="keyword">new</span> XSSFWorkbook();</div><div class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">	    System.out.println(<span class="string">"It cause Error on CREATING excel workbook: "</span>);</div><div class="line">	    e.printStackTrace();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (workbook != <span class="keyword">null</span>) &#123;</div><div class="line">	    Sheet sheet = workbook.createSheet(Constants.SHEETNAME);</div><div class="line">	    <span class="comment">// 合并单元格(表格标题)</span></div><div class="line">	    CellRangeAddress cra = <span class="keyword">new</span> CellRangeAddress(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">10</span>); <span class="comment">// 合并单元格的首行、最后一行、首列、最后一列</span></div><div class="line">	    sheet.addMergedRegion(cra);</div><div class="line">	    Row row_t = sheet.createRow(<span class="number">0</span>);</div><div class="line">	    Cell cell_t = row_t.createCell(<span class="number">0</span>);</div><div class="line">	    cell_t.setCellValue(<span class="string">"When you're right , no one remembers, when you're wrong ,no one forgets ."</span>);</div><div class="line">	    <span class="comment">// 字段标题</span></div><div class="line">	    Row row0 = sheet.createRow(Constants.TITELHIGHT);</div><div class="line">	    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">11</span>; i++) &#123;</div><div class="line">		Cell cell_1 = row0.createCell(i, Cell.CELL_TYPE_STRING);</div><div class="line">		CellStyle style = getStyle(workbook);</div><div class="line">		cell_1.setCellStyle(style);</div><div class="line">		cell_1.setCellValue(<span class="string">"HELLO"</span> + i + <span class="string">"Column"</span>);</div><div class="line">		sheet.autoSizeColumn(i);</div><div class="line">	    &#125;</div><div class="line">	    <span class="comment">// 表格内容</span></div><div class="line">	    <span class="keyword">for</span> (<span class="keyword">int</span> rowNum = Constants.TITELHIGHT + <span class="number">1</span>; rowNum &lt; <span class="number">200</span>; rowNum++) &#123;</div><div class="line">		Row row = sheet.createRow(rowNum);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">11</span>; i++) &#123;</div><div class="line">		    Cell cell = row.createCell(i, Cell.CELL_TYPE_STRING);</div><div class="line">		    cell.setCellValue(<span class="string">"cell"</span> + String.valueOf(rowNum + <span class="number">1</span>) + String.valueOf(i + <span class="number">1</span>));</div><div class="line">		&#125;</div><div class="line">	    &#125;</div><div class="line">	    <span class="keyword">try</span> &#123;</div><div class="line">		FileOutputStream outputStream = <span class="keyword">new</span> FileOutputStream(excelPath);</div><div class="line">		workbook.write(outputStream);</div><div class="line">		outputStream.flush();</div><div class="line">		outputStream.close();</div><div class="line">		isCreateSuccess = <span class="keyword">true</span>;</div><div class="line">	    &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">		System.out.println(<span class="string">"It cause Error on WRITTING excel workbook: "</span>);</div><div class="line">		e.printStackTrace();</div><div class="line">	    &#125;</div><div class="line">	&#125;</div><div class="line">	File sss = <span class="keyword">new</span> File(excelPath);</div><div class="line">	System.out.println(sss.getAbsolutePath());</div><div class="line">	<span class="keyword">return</span> isCreateSuccess;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> CellStyle <span class="title">getStyle</span><span class="params">(Workbook workbook)</span> </span>&#123;</div><div class="line">	CellStyle style = workbook.createCellStyle();</div><div class="line">	style.setAlignment(CellStyle.ALIGN_CENTER);</div><div class="line">	style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);</div><div class="line">	<span class="comment">// 设置单元格字体</span></div><div class="line">	Font headerFont = workbook.createFont(); <span class="comment">// 字体</span></div><div class="line">	headerFont.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">14</span>);</div><div class="line">	headerFont.setColor(HSSFColor.RED.index);</div><div class="line">	headerFont.setFontName(<span class="string">"宋体"</span>);</div><div class="line">	style.setFont(headerFont);</div><div class="line">	style.setWrapText(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">	<span class="comment">// 设置单元格边框及颜色</span></div><div class="line">	style.setBorderBottom((<span class="keyword">short</span>) <span class="number">1</span>);</div><div class="line">	style.setBorderLeft((<span class="keyword">short</span>) <span class="number">1</span>);</div><div class="line">	style.setBorderRight((<span class="keyword">short</span>) <span class="number">1</span>);</div><div class="line">	style.setBorderTop((<span class="keyword">short</span>) <span class="number">1</span>);</div><div class="line">	style.setWrapText(<span class="keyword">true</span>);</div><div class="line">	<span class="keyword">return</span> style;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getExcelPath</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.excelPath;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setExcelPath</span><span class="params">(String excelPath)</span> </span>&#123;</div><div class="line">	<span class="keyword">this</span>.excelPath = excelPath;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@ClassName</span> Constants</div><div class="line">     * <span class="doctag">@Description</span> 表格属性常量</div><div class="line">     * <span class="doctag">@Author</span> youtanzhi</div><div class="line">     * <span class="doctag">@Date</span> 2016年12月27日 上午10:59:06</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Constants</span> </span>&#123;</div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SHEETNAME = <span class="string">"标题1"</span>; <span class="comment">// 表格1标题</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TITELHIGHT = <span class="number">2</span>; <span class="comment">// 标题高度</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>导出.xls</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.OutputStream;</div><div class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</div><div class="line"><span class="keyword">import</span> java.util.Date;</div><div class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Set;</div><div class="line"><span class="keyword">import</span> java.util.Map.Entry;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFCell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFRow;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFSheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</div><div class="line"><span class="keyword">import</span> org.apache.poi.hssf.util.CellRangeAddress;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.CellStyle;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Font;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.IndexedColors;</div><div class="line"></div><div class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"deprecation"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelUtil</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HSSFWorkbook wb;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> CellStyle titleStyle; <span class="comment">// 标题行样式</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Font titleFont; <span class="comment">// 标题行字体</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> CellStyle dateStyle; <span class="comment">// 日期行样式</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Font dateFont; <span class="comment">// 日期行字体</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> CellStyle headStyle; <span class="comment">// 表头行样式</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Font headFont; <span class="comment">// 表头行字体</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> CellStyle contentStyle; <span class="comment">// 内容行样式</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Font contentFont; <span class="comment">// 内容行字体</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@throws</span> IllegalAccessException</div><div class="line">     * <span class="doctag">@throws</span> IllegalArgumentException</div><div class="line">     * <span class="doctag">@Description</span>: 将Map里的集合对象数据输出Excel数据流</div><div class="line">	 * ExportSetInfo实体类包含表格名称、字段、表格数据</div><div class="line">     */</div><div class="line">    <span class="meta">@SuppressWarnings</span>(&#123; <span class="string">"unchecked"</span> &#125;)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">export2Excel</span><span class="params">(ExportSetInfo setInfo)</span> </span></div><div class="line">	    <span class="keyword">throws</span> IOException, IllegalArgumentException, IllegalAccessException &#123;</div><div class="line">	init();</div><div class="line">	Set&lt;Entry&lt;String, List&gt;&gt; set = setInfo.getObjsMap().entrySet();</div><div class="line">	String[] sheetNames = <span class="keyword">new</span> String[setInfo.getObjsMap().size()];</div><div class="line">	<span class="keyword">int</span> sheetNameNum = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (Entry&lt;String, List&gt; entry : set) &#123;</div><div class="line">	    sheetNames[sheetNameNum] = entry.getKey();</div><div class="line">	    sheetNameNum++;</div><div class="line">	&#125;</div><div class="line">	HSSFSheet[] sheets = getSheets(setInfo.getObjsMap().size(), sheetNames);</div><div class="line">	<span class="keyword">int</span> sheetNum = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (Entry&lt;String, List&gt; entry : set) &#123;</div><div class="line">	    <span class="comment">// Sheet</span></div><div class="line">	    List objs = entry.getValue();</div><div class="line">	    <span class="comment">// 标题行</span></div><div class="line">	    createTableTitleRow(setInfo, sheets, sheetNum);</div><div class="line">	    <span class="comment">// 日期行</span></div><div class="line">	    createTableDateRow(setInfo, sheets, sheetNum);</div><div class="line">	    <span class="comment">// 表头</span></div><div class="line">	    creatTableHeadRow(setInfo, sheets, sheetNum);</div><div class="line">	    <span class="comment">// 表体</span></div><div class="line">	    String[] fieldNames = setInfo.getFieldNames().get(sheetNum);</div><div class="line">	    <span class="keyword">int</span> rowNum = <span class="number">3</span>;</div><div class="line">	    <span class="keyword">for</span> (Object obj : objs) &#123;</div><div class="line">		HSSFRow contentRow = sheets[sheetNum].createRow(rowNum);</div><div class="line">		contentRow.setHeight((<span class="keyword">short</span>) <span class="number">300</span>);</div><div class="line">		HSSFCell[] cells = getCells(contentRow, setInfo.getFieldNames().get(sheetNum).length);</div><div class="line">		<span class="keyword">int</span> cellNum = <span class="number">1</span>; <span class="comment">// 去掉一列序号，因此从1开始</span></div><div class="line">		<span class="keyword">if</span> (fieldNames != <span class="keyword">null</span>) &#123;</div><div class="line">		    <span class="keyword">for</span> (<span class="keyword">int</span> num = <span class="number">0</span>; num &lt; fieldNames.length; num++) &#123;</div><div class="line">			Object value = ReflectionUtils.invokeGetterMethod(obj, fieldNames[num]);</div><div class="line">			cells[cellNum].setCellValue(value == <span class="keyword">null</span> ? <span class="string">""</span> : value.toString());</div><div class="line">			cellNum++;</div><div class="line">		    &#125;</div><div class="line">		&#125;</div><div class="line">		rowNum++;</div><div class="line">	    &#125;</div><div class="line">	    adjustColumnSize(sheets, sheetNum, fieldNames); <span class="comment">// 自动调整列宽</span></div><div class="line">	    sheetNum++;</div><div class="line">	&#125;</div><div class="line">	wb.write(setInfo.getOut());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 初始化</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">	wb = <span class="keyword">new</span> HSSFWorkbook();</div><div class="line"></div><div class="line">	titleFont = wb.createFont();</div><div class="line">	titleStyle = wb.createCellStyle();</div><div class="line">	dateStyle = wb.createCellStyle();</div><div class="line">	dateFont = wb.createFont();</div><div class="line">	headStyle = wb.createCellStyle();</div><div class="line">	headFont = wb.createFont();</div><div class="line">	contentStyle = wb.createCellStyle();</div><div class="line">	contentFont = wb.createFont();</div><div class="line"></div><div class="line">	initTitleCellStyle();</div><div class="line">	initTitleFont();</div><div class="line">	initDateCellStyle();</div><div class="line">	initDateFont();</div><div class="line">	initHeadCellStyle();</div><div class="line">	initHeadFont();</div><div class="line">	initContentCellStyle();</div><div class="line">	initContentFont();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 自动调整列宽</div><div class="line">     */</div><div class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unused"</span>)</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">adjustColumnSize</span><span class="params">(HSSFSheet[] sheets, <span class="keyword">int</span> sheetNum, String[] fieldNames)</span> </span>&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fieldNames.length + <span class="number">1</span>; i++) &#123;</div><div class="line">	    sheets[sheetNum].autoSizeColumn(i, <span class="keyword">true</span>);</div><div class="line">	&#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 创建标题行(需合并单元格)</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createTableTitleRow</span><span class="params">(ExportSetInfo setInfo, HSSFSheet[] sheets, <span class="keyword">int</span> sheetNum)</span> </span>&#123;</div><div class="line">	CellRangeAddress titleRange = <span class="keyword">new</span> CellRangeAddress(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, setInfo.getFieldNames().get(sheetNum).length);</div><div class="line">	sheets[sheetNum].addMergedRegion(titleRange);</div><div class="line">	HSSFRow titleRow = sheets[sheetNum].createRow(<span class="number">0</span>);</div><div class="line">	titleRow.setHeight((<span class="keyword">short</span>) <span class="number">800</span>);</div><div class="line">	HSSFCell titleCell = titleRow.createCell(<span class="number">0</span>);</div><div class="line">	titleCell.setCellStyle(titleStyle);</div><div class="line">	titleCell.setCellValue(setInfo.getTitles()[sheetNum]);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 创建日期行(需合并单元格)</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createTableDateRow</span><span class="params">(ExportSetInfo setInfo, HSSFSheet[] sheets, <span class="keyword">int</span> sheetNum)</span> </span>&#123;</div><div class="line">	CellRangeAddress dateRange = <span class="keyword">new</span> CellRangeAddress(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, setInfo.getFieldNames().get(sheetNum).length);</div><div class="line">	sheets[sheetNum].addMergedRegion(dateRange);</div><div class="line">	HSSFRow dateRow = sheets[sheetNum].createRow(<span class="number">1</span>);</div><div class="line">	dateRow.setHeight((<span class="keyword">short</span>) <span class="number">350</span>);</div><div class="line">	HSSFCell dateCell = dateRow.createCell(<span class="number">0</span>);</div><div class="line">	dateCell.setCellStyle(dateStyle);</div><div class="line">	dateCell.setCellValue(<span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>).format(<span class="keyword">new</span> Date()));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 创建表头行(需合并单元格)</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">creatTableHeadRow</span><span class="params">(ExportSetInfo setInfo, HSSFSheet[] sheets, <span class="keyword">int</span> sheetNum)</span> </span>&#123;</div><div class="line">	<span class="comment">// 表头</span></div><div class="line">	HSSFRow headRow = sheets[sheetNum].createRow(<span class="number">2</span>);</div><div class="line">	headRow.setHeight((<span class="keyword">short</span>) <span class="number">350</span>);</div><div class="line">	<span class="comment">// 序号列</span></div><div class="line">	HSSFCell snCell = headRow.createCell(<span class="number">0</span>);</div><div class="line">	snCell.setCellStyle(headStyle);</div><div class="line">	snCell.setCellValue(<span class="string">"序号"</span>);</div><div class="line">	<span class="comment">// 列头名称</span></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> num = <span class="number">1</span>, len = setInfo.getHeadNames().get(sheetNum).length; num &lt;= len; num++) &#123;</div><div class="line">	    HSSFCell headCell = headRow.createCell(num);</div><div class="line">	    headCell.setCellStyle(headStyle);</div><div class="line">	    headCell.setCellValue(setInfo.getHeadNames().get(sheetNum)[num - <span class="number">1</span>]);</div><div class="line">	&#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 创建所有的Sheet</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HSSFSheet[] getSheets(<span class="keyword">int</span> num, String[] names) &#123;</div><div class="line">	HSSFSheet[] sheets = <span class="keyword">new</span> HSSFSheet[num];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</div><div class="line">	    sheets[i] = wb.createSheet(names[i]);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> sheets;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 创建内容行的每一列(附加一列序号)</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HSSFCell[] getCells(HSSFRow contentRow, <span class="keyword">int</span> num) &#123;</div><div class="line">	HSSFCell[] cells = <span class="keyword">new</span> HSSFCell[num + <span class="number">1</span>];</div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, len = cells.length; i &lt; len; i++) &#123;</div><div class="line">	    cells[i] = contentRow.createCell(i);</div><div class="line">	    cells[i].setCellStyle(contentStyle);</div><div class="line">	&#125;</div><div class="line">	<span class="comment">// 设置序号列值，因为出去标题行和日期行，所有-2</span></div><div class="line">	cells[<span class="number">0</span>].setCellValue(contentRow.getRowNum() - <span class="number">2</span>);</div><div class="line"></div><div class="line">	<span class="keyword">return</span> cells;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 初始化标题行样式</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initTitleCellStyle</span><span class="params">()</span> </span>&#123;</div><div class="line">	titleStyle.setAlignment(CellStyle.ALIGN_CENTER);</div><div class="line">	titleStyle.setVerticalAlignment(CellStyle.VERTICAL_CENTER);</div><div class="line">	titleStyle.setFont(titleFont);</div><div class="line">	titleStyle.setFillBackgroundColor(IndexedColors.SKY_BLUE.index);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 初始化日期行样式</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initDateCellStyle</span><span class="params">()</span> </span>&#123;</div><div class="line">	dateStyle.setAlignment(CellStyle.ALIGN_CENTER_SELECTION);</div><div class="line">	dateStyle.setVerticalAlignment(CellStyle.VERTICAL_CENTER);</div><div class="line">	dateStyle.setFont(dateFont);</div><div class="line">	dateStyle.setFillBackgroundColor(IndexedColors.SKY_BLUE.index);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 初始化表头行样式</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initHeadCellStyle</span><span class="params">()</span> </span>&#123;</div><div class="line">	headStyle.setAlignment(CellStyle.ALIGN_CENTER);</div><div class="line">	headStyle.setVerticalAlignment(CellStyle.VERTICAL_CENTER);</div><div class="line">	headStyle.setFont(headFont);</div><div class="line">	headStyle.setFillBackgroundColor(IndexedColors.YELLOW.index);</div><div class="line">	headStyle.setBorderTop(CellStyle.BORDER_MEDIUM);</div><div class="line">	headStyle.setBorderBottom(CellStyle.BORDER_THIN);</div><div class="line">	headStyle.setBorderLeft(CellStyle.BORDER_THIN);</div><div class="line">	headStyle.setBorderRight(CellStyle.BORDER_THIN);</div><div class="line">	headStyle.setTopBorderColor(IndexedColors.BLUE.index);</div><div class="line">	headStyle.setBottomBorderColor(IndexedColors.BLUE.index);</div><div class="line">	headStyle.setLeftBorderColor(IndexedColors.BLUE.index);</div><div class="line">	headStyle.setRightBorderColor(IndexedColors.BLUE.index);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 初始化内容行样式</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initContentCellStyle</span><span class="params">()</span> </span>&#123;</div><div class="line">	contentStyle.setAlignment(CellStyle.ALIGN_CENTER);</div><div class="line">	contentStyle.setVerticalAlignment(CellStyle.VERTICAL_CENTER);</div><div class="line">	contentStyle.setFont(contentFont);</div><div class="line">	contentStyle.setBorderTop(CellStyle.BORDER_THIN);</div><div class="line">	contentStyle.setBorderBottom(CellStyle.BORDER_THIN);</div><div class="line">	contentStyle.setBorderLeft(CellStyle.BORDER_THIN);</div><div class="line">	contentStyle.setBorderRight(CellStyle.BORDER_THIN);</div><div class="line">	contentStyle.setTopBorderColor(IndexedColors.BLUE.index);</div><div class="line">	contentStyle.setBottomBorderColor(IndexedColors.BLUE.index);</div><div class="line">	contentStyle.setLeftBorderColor(IndexedColors.BLUE.index);</div><div class="line">	contentStyle.setRightBorderColor(IndexedColors.BLUE.index);</div><div class="line">	contentStyle.setWrapText(<span class="keyword">true</span>); <span class="comment">// 字段换行</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 初始化标题行字体</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initTitleFont</span><span class="params">()</span> </span>&#123;</div><div class="line">	titleFont.setFontName(<span class="string">"华文楷体"</span>);</div><div class="line">	titleFont.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">20</span>);</div><div class="line">	titleFont.setBoldweight(Font.BOLDWEIGHT_BOLD);</div><div class="line">	titleFont.setCharSet(Font.DEFAULT_CHARSET);</div><div class="line">	titleFont.setColor(IndexedColors.BLUE_GREY.index);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 初始化日期行字体</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initDateFont</span><span class="params">()</span> </span>&#123;</div><div class="line">	dateFont.setFontName(<span class="string">"隶书"</span>);</div><div class="line">	dateFont.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">10</span>);</div><div class="line">	dateFont.setBoldweight(Font.BOLDWEIGHT_BOLD);</div><div class="line">	dateFont.setCharSet(Font.DEFAULT_CHARSET);</div><div class="line">	dateFont.setColor(IndexedColors.BLUE_GREY.index);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 初始化表头行字体</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initHeadFont</span><span class="params">()</span> </span>&#123;</div><div class="line">	headFont.setFontName(<span class="string">"宋体"</span>);</div><div class="line">	headFont.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">10</span>);</div><div class="line">	headFont.setBoldweight(Font.BOLDWEIGHT_BOLD);</div><div class="line">	headFont.setCharSet(Font.DEFAULT_CHARSET);</div><div class="line">	headFont.setColor(IndexedColors.BLUE_GREY.index);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 初始化内容行字体</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initContentFont</span><span class="params">()</span> </span>&#123;</div><div class="line">	contentFont.setFontName(<span class="string">"宋体"</span>);</div><div class="line">	contentFont.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">10</span>);</div><div class="line">	contentFont.setBoldweight(Font.BOLDWEIGHT_NORMAL);</div><div class="line">	contentFont.setCharSet(Font.DEFAULT_CHARSET);</div><div class="line">	contentFont.setColor(IndexedColors.BLUE_GREY.index);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@Description</span>: 封装Excel导出的设置信息</div><div class="line">     * <span class="doctag">@author</span>: 谭又中</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ExportSetInfo</span> </span>&#123;</div><div class="line">	<span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</div><div class="line">	<span class="keyword">private</span> LinkedHashMap&lt;String, List&gt; objsMap;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> String[] titles;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> List&lt;String[]&gt; headNames;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> List&lt;String[]&gt; fieldNames;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> OutputStream out;</div><div class="line"></div><div class="line">	<span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</div><div class="line">	<span class="function"><span class="keyword">public</span> LinkedHashMap&lt;String, List&gt; <span class="title">getObjsMap</span><span class="params">()</span> </span>&#123;</div><div class="line">	    <span class="keyword">return</span> objsMap;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * <span class="doctag">@param</span> objMap</div><div class="line">	 *            导出数据</div><div class="line">	 * </div><div class="line">	 *            泛型 String : 代表sheet名称 List : 代表单个sheet里的所有行数据</div><div class="line">	 */</div><div class="line">	<span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setObjsMap</span><span class="params">(LinkedHashMap&lt;String, List&gt; objsMap)</span> </span>&#123;</div><div class="line">	    <span class="keyword">this</span>.objsMap = objsMap;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">public</span> List&lt;String[]&gt; getFieldNames() &#123;</div><div class="line">	    <span class="keyword">return</span> fieldNames;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * <span class="doctag">@param</span> clazz</div><div class="line">	 *            对应每个sheet里的每行数据的对象的属性名称</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFieldNames</span><span class="params">(List&lt;String[]&gt; fieldNames)</span> </span>&#123;</div><div class="line">	    <span class="keyword">this</span>.fieldNames = fieldNames;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">public</span> String[] getTitles() &#123;</div><div class="line">	    <span class="keyword">return</span> titles;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * <span class="doctag">@param</span> titles</div><div class="line">	 *            对应每个sheet里的标题，即顶部大字</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTitles</span><span class="params">(String[] titles)</span> </span>&#123;</div><div class="line">	    <span class="keyword">this</span>.titles = titles;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">public</span> List&lt;String[]&gt; getHeadNames() &#123;</div><div class="line">	    <span class="keyword">return</span> headNames;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * <span class="doctag">@param</span> headNames</div><div class="line">	 *            对应每个页签的表头的每一列的名称</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeadNames</span><span class="params">(List&lt;String[]&gt; headNames)</span> </span>&#123;</div><div class="line">	    <span class="keyword">this</span>.headNames = headNames;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> OutputStream <span class="title">getOut</span><span class="params">()</span> </span>&#123;</div><div class="line">	    <span class="keyword">return</span> out;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * <span class="doctag">@param</span> out</div><div class="line">	 *            Excel数据将输出到该输出流</div><div class="line">	 */</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOut</span><span class="params">(OutputStream out)</span> </span>&#123;</div><div class="line">	    <span class="keyword">this</span>.out = out;</div><div class="line">	&#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[关于mysql关键字between and，>=<，in，or性能及优化]]></title>
      <url>https://volc1605.github.io/2016/12/22/%E5%85%B3%E4%BA%8Emysql%E5%85%B3%E9%94%AE%E5%AD%97between-and%EF%BC%8C-%EF%BC%8Cin%EF%BC%8Cor%E6%80%A7%E8%83%BD%E5%8F%8A%E4%BC%98%E5%8C%96/</url>
      <content type="html"><![CDATA[<h3 id="关于IN关键字的效率问题"><a href="#关于IN关键字的效率问题" class="headerlink" title="关于IN关键字的效率问题"></a>关于IN关键字的效率问题</h3><a id="more"></a>
<p>查询表<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select count(1) from tk_plan_wait;</div><div class="line">+----------+</div><div class="line">| count(1) |</div><div class="line">+----------+</div><div class="line">|    20312 |</div><div class="line">+----------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure></p>
<p>这个表的总记录数为20312行</p>
<p>查询表索引<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">mysql&gt; show index from tk_plan_wait;</div><div class="line">+--------------+------------+-----------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</div><div class="line">| Table        | Non_unique | Key_name        | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |</div><div class="line">+--------------+------------+-----------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</div><div class="line">| tk_plan_wait |          0 | PRIMARY         |            1 | idx         | A         |       20703 |     NULL | NULL   |      | BTREE      |         |               |</div><div class="line">| tk_plan_wait |          0 | tk_plan_wait_pk |            1 | PLAN_NUM    | A         |       20703 |     NULL | NULL   |      | BTREE      |         |               |</div><div class="line">+--------------+------------+-----------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</div><div class="line">2 rows in set (0.00 sec)</div></pre></td></tr></table></figure></p>
<p>由于索引PLAN_NUM字段是unique唯一类型，可以看到其散列程度（Cardinality）是非常高的，因此该索引是很有效的。<br>其中字段rows为1，只扫描了一行，含有索引其执行效率很高。  </p>
<blockquote>
<p>使用in关键字根据有索引字段查询  </p>
</blockquote>
<p>使用优化器EXPLAIN执行含有索引的sql请看执行情况<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; EXPLAIN SELECT * FROM `tk_plan_wait` WHERE PLAN_NUM in('367b069a-4f2c-4d6e-899a-9c9690760d19');</div><div class="line">+----+-------------+--------------+------------+-------+-----------------+-----------------+---------+-------+------+----------+-------+</div><div class="line">| id | select_type | table        | partitions | type  | possible_keys   | key             | key_len | ref   | rows | filtered | Extra |</div><div class="line">+----+-------------+--------------+------------+-------+-----------------+-----------------+---------+-------+------+----------+-------+</div><div class="line">|  1 | SIMPLE      | tk_plan_wait | NULL       | const | tk_plan_wait_pk | tk_plan_wait_pk | 152     | const |    1 |   100.00 | NULL  |</div><div class="line">+----+-------------+--------------+------------+-------+-----------------+-----------------+---------+-------+------+----------+-------+</div><div class="line">1 row in set, 1 warning (0.00 sec)</div></pre></td></tr></table></figure></p>
<p style="color:red"><br>其中字段rows为1，只扫描了一行，含有索引其执行效率很高。<br></p>

<blockquote>
<p>使用in关键字根据没有添加索引字段查询  </p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; EXPLAIN SELECT * FROM `tk_plan_wait` WHERE TASK_ARG1 in('t');</div><div class="line">+----+-------------+--------------+------------+------+---------------+------+---------+------+-------+----------+-------------+</div><div class="line">| id | select_type | table        | partitions | type | possible_keys | key  | key_len | ref  | rows  | filtered | Extra       |</div><div class="line">+----+-------------+--------------+------------+------+---------------+------+---------+------+-------+----------+-------------+</div><div class="line">|  1 | SIMPLE      | tk_plan_wait | NULL       | ALL  | NULL          | NULL | NULL    | NULL | 20703 |    10.00 | Using where |</div><div class="line">+----+-------------+--------------+------------+------+---------------+------+---------+------+-------+----------+-------------+</div><div class="line">1 row in set, 1 warning (0.00 sec)</div></pre></td></tr></table></figure>
<p></p><p style="color:red"><br>其中字段rows为20703，in在不使用含有索引字段查询的情况下是进行了全表扫描的。<br></p><br>待续…<br>参考：<a href="http://amao12580.github.io/post/2016/07/MySQL-in-operator-must-lead-to-full-scan/" target="_blank" rel="external">http://amao12580.github.io/post/2016/07/MySQL-in-operator-must-lead-to-full-scan/</a><p></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[memcache]]></title>
      <url>https://volc1605.github.io/2016/12/12/memcache/</url>
      <content type="html"><![CDATA[<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>1.由于memcached是基于libevent的，因此需要安装libevent，libevent-devel<br><a id="more"></a><br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">yum</span> install  libevent libevent-devel -y</div></pre></td></tr></table></figure></p>
<p>下载：<br><a href="http://www.monkey.org/~provos/libevent-2.0.10-stable.tar.gz" target="_blank" rel="external">http://www.monkey.org/~provos/libevent-2.0.10-stable.tar.gz</a><br>2.解压<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">tar</span> zxvf libevent-2.0.10-stable.tar.gz</div></pre></td></tr></table></figure></p>
<p>3.进入目录<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">cd</span> libevent-2.0.10-stable</div></pre></td></tr></table></figure></p>
<p>4.切换到root<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">su</span></div></pre></td></tr></table></figure></p>
<p>5.安装gcc<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">yum</span> install gcc</div></pre></td></tr></table></figure></p>
<p>6.设置安装路径<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./configure -prefix=/usr</div></pre></td></tr></table></figure></p>
<p>7.编译<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">make</span></div></pre></td></tr></table></figure></p>
<p>8.安装<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">make</span> install</div></pre></td></tr></table></figure></p>
<p>9.测试libevent是否安装成功  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ls -al /usr/lib | grep libevent</div><div class="line">lrwxrwxrwx 1 root root 21 11?? 12 17:38 libevent-1.2.so.1 -&gt; libevent-1.2.so.1.0.3</div><div class="line">-rwxr-xr-x 1 root root 263546 11?? 12 17:38 libevent-1.2.so.1.0.3</div><div class="line">-rw-r–r– 1 root root 454156 11?? 12 17:38 libevent.a</div><div class="line">-rwxr-xr-x 1 root root 811 11?? 12 17:38 libevent.la</div><div class="line">lrwxrwxrwx 1 root root 21 11?? 12 17:38 libevent.so -&gt; libevent-1.2.so.1.0.3</div></pre></td></tr></table></figure>
<p>还不错，都安装上了。<br>安装libevent参考：<br>    <a href="http://blog.csdn.net/zhangm168/article/details/6272801" target="_blank" rel="external">http://blog.csdn.net/zhangm168/article/details/6272801</a></p>
<p>10.安装gcc<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">yum</span> install gcc* make*</div></pre></td></tr></table></figure></p>
<p>11.下载memcache<br>    地址:<a href="http://www.danga.com/memcached/dist/memcached-1.2.0.tar.gz" target="_blank" rel="external">http://www.danga.com/memcached/dist/memcached-1.2.0.tar.gz</a><br>12.在/tmp解压memcache  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">tar</span> zxvf memcached-1.4.33.tar.gz</div></pre></td></tr></table></figure>
<p>安装memcached，同时需要安装中指定libevent的安装位置：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">cd /tmp</div><div class="line">tar zxvf memcached-1.4.33.tar.gz</div><div class="line">cd memcached-1.4.33.tar.gz</div><div class="line">./configure –with-libevent=/usr</div><div class="line">make</div><div class="line">make install</div></pre></td></tr></table></figure></p>
<p>如果中间出现报错，请仔细检查错误信息，按照错误信息来配置或者增加相应的库或者路径。<br>安装完成后会把memcached放到 /usr/local/bin/memcached ，<br>测试是否成功安装memcached：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ls -al /usr/local/bin/mem*</div><div class="line">-rwxr-xr-x 1 root root 137986 11?? 12 17:39 /usr/local/bin/memcached</div><div class="line">-rwxr-xr-x 1 root root 140179 11?? 12 17:39 /usr/local/bin/memcached-debug</div></pre></td></tr></table></figure>
<p>13.启动memcache<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/bin/memcached -d -m 10 -u root -l 116.62.29.229 -p 12000 -c 256 -P /tmp/memcached.pid</div></pre></td></tr></table></figure></p>
<p>结束memcache<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">kill</span> cat /tmp/memcached.pid</div></pre></td></tr></table></figure></p>
<p>测试：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">[root@localhost /]# telnet 192.168.141.64 12000</div><div class="line">Trying 192.168.141.64...</div><div class="line">Connected to 192.168.141.64 (192.168.141.64).</div><div class="line">Escape character is '^]'.</div><div class="line">set key1 0 60 4</div><div class="line">zhou</div><div class="line">STORED</div><div class="line">get key1</div><div class="line">VALUE key1 0 4</div><div class="line">zhou</div><div class="line">END</div></pre></td></tr></table></figure></p>
<p>退出：quit或者ctrl + ] 然后在按q就行了。</p>
<p>把Memcached服务加载到Linux的启动项中.万一机器断电系统重启.那么Memcached就会自动启动了.<br>假如启动Memcache的服务器端的命令为：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/bin/memcached -d -m 10 -u root -l 192.168.141.64 -p 12000 -c 256 -P</div></pre></td></tr></table></figure>
<p>想开机自动启动的话，只需在/etc/rc.d/rc.local中加入一行，下面命令  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/memcached/bin/memcached -d -m 10 -p 12000 -u apache -c 256</div></pre></td></tr></table></figure>
<p>上面有些东西可以参考一下：即，ip不指定时，默认是本机，用户:最好选择是：apache 或 deamon<br>这样，也就是属于哪个用户的服务，由哪个用户启动。  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">kill</span> -9 <span class="string">"进程号"</span></div></pre></td></tr></table></figure>
<p>参考<br>配置参考：<a href="http://blog.csdn.net/u013615806/article/details/51461759" target="_blank" rel="external">http://blog.csdn.net/u013615806/article/details/51461759</a><br>配置参考:<a href="http://www.itgo.me/a/x2750105529827921816/memcached" target="_blank" rel="external">http://www.itgo.me/a/x2750105529827921816/memcached</a>  </p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[linux安装JDK]]></title>
      <url>https://volc1605.github.io/2016/12/12/linux%E5%AE%89%E8%A3%85JDK/</url>
      <content type="html"><![CDATA[<h1 id="jdk安装"><a href="#jdk安装" class="headerlink" title="jdk安装"></a>jdk安装</h1><p>下载地址:<br>    <a href="http://www.oracle.com/technetwork/cn/java/javase/downloads/jdk8-downloads-2133151-zhs.html" target="_blank" rel="external">http://www.oracle.com/technetwork/cn/java/javase/downloads/jdk8-downloads-2133151-zhs.html</a><br>修改jdk中bin目录中的访问权限<br><a id="more"></a></p>
<p>chmod [who] [opt] [mode] 文件/目录名  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">chmod</span> a+rwx java</div></pre></td></tr></table></figure>
<p>1.修改etc/profile文件，追加一下jdk配置并保存<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">export</span> JAVA_HOME=/usr/java/jdk1.6.0_45  </div><div class="line"><span class="attribute">export</span> JAVA_BIN=/usr/java/jdk1.6.0_45/bin  </div><div class="line"><span class="attribute">export</span> PATH=$PATH:$JAVA_HOME/bin  </div><div class="line"><span class="attribute">export</span> CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar  </div><div class="line"><span class="attribute">export</span> JAVA_HOME JAVA_BIN PATH CLASSPATH</div></pre></td></tr></table></figure></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">source</span> /etc/profile</div></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">source</span> /etc/profile  # 刷新系统配置文件</div></pre></td></tr></table></figure>
<p>2.在这个目录下/usr/local/java/jdk1.7.0_71/bin/修改java文件权限<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">chmod</span>  777 java </div><div class="line"><span class="attribute">java</span> -version</div></pre></td></tr></table></figure></p>
<p>问题  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">Error</span> occurred during initialization of VM  </div><div class="line"><span class="attribute">Could</span> not reserve enough space for object heap</div></pre></td></tr></table></figure>
<p>解决方法<br>    在tomcat的bin目录下，catalina.sh文件的tomcat内存参数配置过大，超过机器可用内存总数造成，修改到适当的值即可，修改的参数   为：JAVA_OPTS=”-Xms50m -Xmx60m”</p>
<h1 id="查看tomcat是否启动"><a href="#查看tomcat是否启动" class="headerlink" title="查看tomcat是否启动"></a>查看tomcat是否启动</h1><p>命令：ps -ef|grep java 或者 ps -aux | grep tomcat<br>如果出现一下情况说明tomcat已启用</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">root</span> 7010 1 0 Apr19 ? 00:30:13 /usr/local/java/bin/java -Djava.util.logging.config.file=/usr/local/tomcat/conf/logging.properties -Djava.awt.headless=true -Dfile.encoding=UTF-8 -server -Xms1024m -Xmx1024m -XX:NewSize=256m -XX:MaxNewSize=256m -XX:PermSize=256m -XX:MaxPermSize=256m -XX:+DisableExplicitGC -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs=/usr/local/tomcat/endorsed -classpath /usr/local/tomcat/bin/bootstrap.jar -Dcatalina.base=/usr/local/tomcat -Dcatalina.home=/usr/local/tomcat -Djava.io.tmpdir=/usr/local/tomcat/temp org.apache.catalina.startup.Bootstrap start</div></pre></td></tr></table></figure>
<p>如果出现一下情况说明tomcat已停用<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">root</span> 7010 1 0 Apr19 ? 00:30:30<span class="meta"> [java]</span></div></pre></td></tr></table></figure></p>
<p>安装JDK和Tomcat参考<br>配置参考：<a href="http://blog.csdn.net/zhuying_linux/article/details/6583096/" target="_blank" rel="external">http://blog.csdn.net/zhuying_linux/article/details/6583096/</a><br>配置参考：<a href="http://www.jb51.net/article/85478.htm" target="_blank" rel="external">http://www.jb51.net/article/85478.htm</a>  </p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Dubbo+zookeeper]]></title>
      <url>https://volc1605.github.io/2016/12/12/DUBBO+ZOOKEEPER/</url>
      <content type="html"><![CDATA[<h1 id="安装zookeeper"><a href="#安装zookeeper" class="headerlink" title="安装zookeeper"></a>安装zookeeper</h1><p>1.下载安装包<br>下载地址：<a href="http://mirrors.hust.edu.cn/apache/zookeeper/zookeeper-3.4.6/" target="_blank" rel="external">http://mirrors.hust.edu.cn/apache/zookeeper/zookeeper-3.4.6/</a><br><a id="more"></a><br>在/webapp下解压安装文件<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">tar</span> -xzvf zookeeper-3.4.5.tar.gz</div></pre></td></tr></table></figure></p>
<p>/webapp/zookeeper-3.4.5下创建logs文件夹<br>2.zookeeper的环境变量的配置  </p>
<p>在/etc/profile文件中加入如下的内容：  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#set zookeeper environment</span></div><div class="line"><span class="attribute">export</span> ZOOKEEPER_HOME=/home/haduser/zookeeper/zookeeper-3.4.5</div><div class="line"><span class="attribute">export</span> PATH=$PATH:$ZOOKEEPER_HOME/bin:$ZOOKEEPER_HOME/conf</div></pre></td></tr></table></figure>
<p>3.集群部署<br>    在Zookeeper集群环境下只要一半以上的机器正常启动了，那么Zookeeper服务将是可用的。因此，集群上部署Zookeeper最好使用奇数台机器，这样如果有5台机器，只要3台正常工作则服务将正常使用。<br>下面我们将对Zookeeper的配置文件的参数进行设置：</p>
<p>进入zookeeper-3.4.5/conf</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$:cp zoo_sample.cfg zoo.cfg</div><div class="line">$:vim zoo.cfg</div></pre></td></tr></table></figure>
<p><img src="https://volc1605.github.io/images/DUBBO+ZOOKEEPER/1.png" alt="1">   </p>
<p>注意上图的配置中master，slave1分别为主机名，具体的对应的主机可参见之前的Hadoop的安装与配置的博文<br>在上面的配置文件中”server.id=host:port:port”中的第一个port是从机器（follower）连接到主机器（leader）的端口号，第二个port是进行leadership选举的端口号。  </p>
<p>接下来在dataDir所指定的目录下创建一个文件名为myid的文件，文件中的内容只有一行，为本主机对应的id值，也就是上图中server.id中的id。例如：在服务器1中的myid的内容应该写入1。</p>
<p>4.远程复制分发安装文件  </p>
<p>接下来将上面的安装文件拷贝到集群中的其他机器上对应的目录下：<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">haduser</span>@master:~/zookeeper$ scp -r zookeeper-3.4.5/ slave1:/home/haduser/zookeeper/zookeeper-3.4.5  </div><div class="line"><span class="attribute">haduser</span>@master:~/zookeeper$ scp -r zookeeper-3.4.5/ slave2:/home/haduser/zookeeper/zookeeper-3.4.5</div></pre></td></tr></table></figure></p>
<p>拷贝完成后修改对应的机器上的myid。例如修改slave1中的myid如下：<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">haduser</span>@slave1:~/zookeeper/zookeeper-3.4.5$ echo <span class="string">"2"</span> &gt; data/myid  </div><div class="line"><span class="attribute">haduser</span>@slave1:~/zookeeper/zookeeper-3.4.5$ cat data/myid</div></pre></td></tr></table></figure></p>
<p>内容为：2    </p>
<p>5.启动ZooKeeper集群<br>    在ZooKeeper集群的每个结点上，执行启动ZooKeeper服务的脚本，如下所示：<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">haduser</span>@master:~/zookeeper/zookeeper-3.4.5$ bin/zkServer.sh start</div><div class="line"><span class="attribute">haduser</span>@slave1:~/zookeeper/zookeeper-3.4.5$ bin/zkServer.sh start</div><div class="line"><span class="attribute">haduser</span>@slave2:~/zookeeper/zookeeper-3.4.5$ bin/zkServer.sh start</div></pre></td></tr></table></figure></p>
<p><img src="https://volc1605.github.io/images/DUBBO+ZOOKEEPER/2.png" alt="2"><br>其中，QuorumPeerMain是zookeeper进程，启动正常。<br>如上依次启动了所有机器上的Zookeeper之后可以通过ZooKeeper的脚本来查看启动状态，包括集群中各个结点的角色（或是Leader，或是Follower），如下所示，是在ZooKeeper集群中的每个结点上查询的结果：</p>
<p><img src="https://volc1605.github.io/images/DUBBO+ZOOKEEPER/3.png" alt="3"><br>通过上面状态查询结果可见，slave1是集群的Leader，其余的两个结点是Follower。  </p>
<p>另外，可以通过客户端脚本，连接到ZooKeeper集群上。对于客户端来说，ZooKeeper是一个整体（ensemble），连接到ZooKeeper集群实际上感觉在独享整个集群的服务，所以，你可以在任何一个结点上建立到服务集群的连接，例如：<br>查看是否安装启动成功<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">bin</span>/zkCli.sh -server 116.62.2.289:2181</div></pre></td></tr></table></figure></p>
<p><img src="https://volc1605.github.io/images/DUBBO+ZOOKEEPER/4.png" alt="4"> </p>
<p>脚本启动<br>脚本内容：<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">aaa</span>=` ps aux| grep <span class="string">"/webapp/zookeeper"</span> | grep -v grep|awk '&#123;print <span class="number">$2</span>&#125;'`</div><div class="line"></div><div class="line"><span class="attribute">if</span><span class="meta"> [ "$aaa" = "" ];</span></div><div class="line">then</div><div class="line">  (/webapp/zookeeper-3.4.5/bin/zkServer.sh start) &amp;&amp; (echo "Start zookeeper  Service  Successful!") || (echo "Start zookeeper Service Fault")</div><div class="line">else</div><div class="line">   echo ""</div><div class="line">   echo "zookeeper is runging"</div><div class="line">   echo ""</div><div class="line"></div><div class="line">fi</div></pre></td></tr></table></figure></p>
<p>启动脚本<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">sh</span> zkServer.sh</div></pre></td></tr></table></figure></p>
<p>启动结果：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@iZbp199af3f3y8j7fr8kolZ bin]# sh stop_zookeeper.sh </div><div class="line"> zookeeper is not runging </div><div class="line">[root@iZbp199af3f3y8j7fr8kolZ bin]# sh start_zookeeper.sh </div><div class="line">JMX enabled by default</div><div class="line">Using config: /webapp/zookeeper-3.4.5/bin/../conf/zoo.cfg</div><div class="line">Starting zookeeper ... STARTED</div><div class="line">Start zookeeper  Service  Successful!</div></pre></td></tr></table></figure></p>
<p>配置参考：<a href="http://www.cnblogs.com/yuyijq/p/3438829.html" target="_blank" rel="external">http://www.cnblogs.com/yuyijq/p/3438829.html</a><br>配置参考：<a href="http://343614597.blog.51cto.com/7056394/1874745" target="_blank" rel="external">http://343614597.blog.51cto.com/7056394/1874745</a><br>启动zookeeper<br>    在zookper-3.3.6/bin目录下执行<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./zkServer.sh start 启动zookeeper</div></pre></td></tr></table></figure></p>
<p>验证zookeeper是否启动<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">netstat</span> -lpn | grep 2181</div></pre></td></tr></table></figure></p>
<h1 id="安装DUBBO"><a href="#安装DUBBO" class="headerlink" title="安装DUBBO"></a>安装DUBBO</h1><p>1.下载dubbo安装包  </p>
<p>2.在根目录创建相应文件夹webapp/deploy/<br>并解压安装文件到deploy文件夹中  </p>
<p>3.配置<br>    /webapp/deploy/dubbo-admin/WEB-INF<br>    中的dubbo.properties文件<br>    内容如下：<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">dubbo</span>.registry.address=zookeeper://127.0.0.1:2181  </div><div class="line"><span class="attribute">dubbo</span>.admin.root.password=root  </div><div class="line"><span class="attribute">dubbo</span>.admin.guest.password=guest</div></pre></td></tr></table></figure></p>
<p>4.然后启动tomcat服务，显示登陆页面，说明dubbo-admin部署成功<br>    访问路径：<a href="http://服务器IP:8080/" target="_blank" rel="external">http://服务器IP:8080/</a><br>    账号：root<br>    密码：root  </p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Nginx]]></title>
      <url>https://volc1605.github.io/2016/12/12/Nginx/</url>
      <content type="html"><![CDATA[<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>1.首先要安装 PCRE<br>    源文件：<a href="http://downloads.sourceforge.net/project/pcre/pcre/8.35/pcre-8.35.tar.gz" target="_blank" rel="external">http://downloads.sourceforge.net/project/pcre/pcre/8.35/pcre-8.35.tar.gz</a><br>    参考地址：<a href="http://www.runoob.com/linux/nginx-install-setup.html" target="_blank" rel="external">http://www.runoob.com/linux/nginx-install-setup.html</a><br><a id="more"></a><br>2.安装nginx<br>    nginx安装路径/webapp/nginx</p>
<p>启动项目报错<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">SEVERE</span>: StandardServer.await: create[8005]: </div><div class="line"><span class="attribute">java</span>.net.BindException: Address already in use</div><div class="line"><span class="attribute">at</span> java.net.PlainSocketImpl.socketBind(Native Method)</div><div class="line"><span class="attribute">at</span> java.net.PlainSocketImpl.bind(PlainSocketImpl.java:383)</div><div class="line"><span class="attribute">at</span> java.net.ServerSocket.bind(ServerSocket.java:328)</div><div class="line"><span class="attribute">at</span> java.net.ServerSocket.&lt;init&gt;(ServerSocket.java:194)</div><div class="line"><span class="attribute">at</span> org.apache.catalina.core.StandardServer.await(StandardServer.java:404)</div><div class="line"><span class="attribute">at</span> org.apache.catalina.startup.Catalina.await(Catalina.java:676)</div><div class="line"><span class="attribute">at</span> org.apache.catalina.startup.Catalina.start(Catalina.java:628)</div><div class="line"><span class="attribute">at</span> sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</div><div class="line"><span class="attribute">at</span> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)</div><div class="line"><span class="attribute">at</span> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)</div><div class="line"><span class="attribute">at</span> java.lang.reflect.Method.invoke(Method.java:597)</div><div class="line"><span class="attribute">at</span> org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)</div><div class="line"><span class="attribute">at</span> org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)</div><div class="line"><span class="attribute">Dec</span> 10, 2016 10:14:38 AM org.apache.coyote.http11.Http11Protocol pause</div></pre></td></tr></table></figure></p>
<p>解决修改：<br>    8005端口被占用了<br>    /webapp/tomcat_bg/conf<br>    修改server.xml文件中的8005端口<br>    <server port="8007" shutdown="SHUTDOWN"></server></p>
<p>常用命令：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">/usr/local/webserver/nginx/sbin/nginx -s reload            # 重新载入配置文件</div><div class="line">/usr/local/webserver/nginx/sbin/nginx -s reopen            # 重启 Nginx</div><div class="line">/usr/local/webserver/nginx/sbin/nginx -s stop              # 停止 Nginx</div></pre></td></tr></table></figure></p>
<h1 id="验证nginx是否安装成功"><a href="#验证nginx是否安装成功" class="headerlink" title="验证nginx是否安装成功"></a>验证nginx是否安装成功</h1><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd  /usr/local/nginx/sbin  </div><div class="line">./nginx -t</div></pre></td></tr></table></figure>
<p>3.nginx.conf配置<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">#user  nobody;</div><div class="line">worker_processes  1;</div><div class="line"></div><div class="line">#error_log  logs/error.log;</div><div class="line">#error_log  logs/error.log  notice;</div><div class="line">#error_log  logs/error.log  info;</div><div class="line"></div><div class="line">#pid        logs/nginx.pid;</div><div class="line"></div><div class="line"></div><div class="line">events &#123;</div><div class="line">    worker_connections  1024;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">http &#123;</div><div class="line">    include       mime.types;</div><div class="line">    default_type  application/octet-stream;</div><div class="line"></div><div class="line">    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</div><div class="line">    #                  '$status $body_bytes_sent "$http_referer" '</div><div class="line">    #                  '"$http_user_agent" "$http_x_forwarded_for"';</div><div class="line"></div><div class="line">    #access_log  logs/access.log  main;</div><div class="line"></div><div class="line">    sendfile        on;</div><div class="line">    #tcp_nopush     on;</div><div class="line"></div><div class="line">    #keepalive_timeout  0;</div><div class="line">    keepalive_timeout  65;</div><div class="line"></div><div class="line">    #gzip  on;</div><div class="line"></div><div class="line">    server &#123;</div><div class="line">        listen       80;</div><div class="line">        server_name  localhost;</div><div class="line"></div><div class="line">        #charset koi8-r;</div><div class="line"></div><div class="line">        #access_log  logs/host.access.log  main;</div><div class="line"></div><div class="line">        location / &#123;</div><div class="line">            root   /webapp/webdir/share;</div><div class="line">            index  index.html index.htm;</div><div class="line">        &#125;</div><div class="line">	location /xx/ &#123;</div><div class="line">	     proxy_pass   http://127.0.0.1:1111/xx/;</div><div class="line">        &#125;</div><div class="line">	location /xx/ &#123;</div><div class="line">	     proxy_pass   http://127.0.0.1:1111/;</div><div class="line">	&#125;</div><div class="line">	location /xx/ &#123;</div><div class="line">	     proxy_pass   http://127.0.0.1:1111/;</div><div class="line">	&#125; </div><div class="line">        #error_page  404              /404.html;</div><div class="line"></div><div class="line">        # redirect server error pages to the static page /50x.html</div><div class="line">        #</div><div class="line">        error_page   500 502 503 504  /50x.html;</div><div class="line">        location = /50x.html &#123;</div><div class="line">            root   html;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</div><div class="line">        #</div><div class="line">        #location ~ \.php$ &#123;</div><div class="line">        #    proxy_pass   http://127.0.0.1;</div><div class="line">        #&#125;</div><div class="line"></div><div class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</div><div class="line">        #</div><div class="line">        #location ~ \.php$ &#123;</div><div class="line">        #    root           html;</div><div class="line">        #    fastcgi_pass   127.0.0.1:9000;</div><div class="line">        #    fastcgi_index  index.php;</div><div class="line">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</div><div class="line">        #    include        fastcgi_params;</div><div class="line">        #&#125;</div><div class="line"></div><div class="line">        # deny access to .htaccess files, if Apache's document root</div><div class="line">        # concurs with nginx's one</div><div class="line">        #</div><div class="line">        #location ~ /\.ht &#123;</div><div class="line">        #    deny  all;</div><div class="line">        #&#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</div><div class="line">    #</div><div class="line">    #server &#123;</div><div class="line">    #    listen       8000;</div><div class="line">    #    listen       somename:8080;</div><div class="line">    #    server_name  somename  alias  another.alias;</div><div class="line"></div><div class="line">    #    location / &#123;</div><div class="line">    #        root   html;</div><div class="line">    #        index  index.html index.htm;</div><div class="line">    #    &#125;</div><div class="line">    #&#125;</div><div class="line"></div><div class="line"></div><div class="line">    # HTTPS server</div><div class="line">    #</div><div class="line">    #server &#123;</div><div class="line">    #    listen       443 ssl;</div><div class="line">    #    server_name  localhost;</div><div class="line"></div><div class="line">    #    ssl_certificate      cert.pem;</div><div class="line">    #    ssl_certificate_key  cert.key;</div><div class="line"></div><div class="line">    #    ssl_session_cache    shared:SSL:1m;</div><div class="line">    #    ssl_session_timeout  5m;</div><div class="line"></div><div class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</div><div class="line">    #    ssl_prefer_server_ciphers  on;</div><div class="line"></div><div class="line">    #    location / &#123;</div><div class="line">    #        root   html;</div><div class="line">    #        index  index.html index.htm;</div><div class="line">    #    &#125;</div><div class="line">    #&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[linux操作mysql]]></title>
      <url>https://volc1605.github.io/2016/12/12/linux%E6%93%8D%E4%BD%9Cmysql/</url>
      <content type="html"><![CDATA[<h1 id="linux安装mysql"><a href="#linux安装mysql" class="headerlink" title="linux安装mysql"></a>linux安装mysql</h1><p>1.查看服务器中是否已经安装了mysql<br><a id="more"></a></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">ps</span> -aux | grep <span class="string">"mysql"</span>   # 查看有关mysql进程</div><div class="line"><span class="attribute">rpm</span> -qa | grep mysql     # 用于查看linux服务器是否安装了默认的mysql</div><div class="line"><span class="attribute">rpm</span> -e mysql　　         # 普通删除模式</div><div class="line"><span class="attribute">rpm</span> -e --nodeps mysql　　# 强力删除模式，如果使用上面命令删除时，提示有依赖的其它文件，则用该命令可以对其进行强力删除  </div><div class="line"><span class="attribute">rpm</span> -e mysql-5.7.13-linux-glibc2.5-x86_64 --nodeps  # 卸载已经安装的mysql-5.7.13-linux-glibc2.5-x86_64数据库</div></pre></td></tr></table></figure>
<p>2.解压mysql源码文件  </p>
<p>下载mysql：网址:<a href="http://downloads.mysql.com/archives/community/" target="_blank" rel="external">http://downloads.mysql.com/archives/community/</a><br>    这里下载mysql-5.7.12-linux-glibc2.5-x86_64.tar版本<br>    把下载好的mysql安装文件放到/home/mysql中，如果没有mysql文件夹先创建，再放到里面<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">cd</span> /home/mysql  # 进入mysql目录准备解压mysql源文件</div><div class="line"><span class="attribute">tar</span> -zxf mysql-5.7.12-linux-glibc2.5-x86_64.tar.gz -C /home/mysql   # 解压到/home/mysql文件夹下</div></pre></td></tr></table></figure></p>
<p>3.创建mysql的用户组/用户, data目录及其用户目录<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">userdel</span> mysql                                           # 删除用户</div><div class="line"><span class="attribute">groupdel</span> mysql                                          # 删除用户组名</div><div class="line"><span class="attribute">mkdir</span> /home/mysql                                       # 在home文件夹下创建文件夹mysql</div><div class="line"><span class="attribute">mkdir</span> /home/mysql/data                                  # 在mysql文件夹下创建文件夹data  </div><div class="line"><span class="attribute">groupadd</span> mysql                                          # 创建一个名为mysql的用户组       </div><div class="line"><span class="attribute">useradd</span> -g mysql -d /home/mysql mysql                   # 在用户组下创建用户</div></pre></td></tr></table></figure></p>
<p>4.初始化mysql数据库<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /home/mysql                                         # 进入安装目录</div><div class="line">./bin/mysql_install_db  --user=mysql --basedir=/home/mysql --datadir=/home/mysql/data</div></pre></td></tr></table></figure></p>
<p>mysql5.7新特性：由上面可以看出， mysql_install_db 已经不再推荐使用了，建议改成 mysqld –initialize 完成实例初始化。  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">./bin/mysqld --user=mysql --basedir=/home/mysql --datadir=/home/mysql/data --initialize</div><div class="line">./mysqld --user=mysql --basedir=/home/mysql --datadir=/home/mysql/data --initialize</div><div class="line">[Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details).</div><div class="line">[ERROR] --initialize specified but the data directory has files in it. Aborting. 2016-04-08T01:46:53.155879Z 0</div><div class="line">[ERROR] Aborting</div></pre></td></tr></table></figure>
<p>出现上面的错误是因为我们没有清空mysql的data目录， 执行清空命令如下：  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">cd /home/mysql/data                        # 进入安装目录下的data目录</div><div class="line">rm -fr *                                   # 清空数据</div><div class="line">cd /home/mysql      </div><div class="line">./bin/mysqld --user=mysql --basedir=/home/mysql --datadir=/home/mysql/data --initialize</div><div class="line">[Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details). 2016-04-08T01:47:59.945537Z 0</div><div class="line">[Warning] InnoDB: New log files created, LSN=45790 2016-04-08T01:48:00.333528Z 0 [Warning] InnoDB: Creating foreign key constraint system tables. 2016-04-08T01:48:00.434908Z 0</div><div class="line">[Warning] No existing UUID has been found, so we assume that this is the first time that this server has been started. Generating a new UUID: ece26421-fd2b-11e5-a1e3-00163e001e5c. 2016-04-08T01:48:00.440125Z 0</div><div class="line">[Warning] Gtid table is not ready to be used. Table 'mysql.gtid_executed' cannot be opened. 2016-04-08T01:48:00.440904Z 1</div><div class="line">[Note] A temporary password is generated for root@localhost: 2EC+qfcossJ=</div></pre></td></tr></table></figure>
<p>牢记上面的随机密码， 如上**mjT,#x_5sW, 下面我们修改密码时需要用到。  </p>
<p>5.检测下是否能启动mysql服务<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd /home/mysql</div><div class="line">./support-files/mysql.server start</div><div class="line">Starting MySQL.. OK!</div></pre></td></tr></table></figure></p>
<p>正常<br>如果出现以下问题，需要修改/support-files/mysql.server<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">./support-files/mysql.server start</div><div class="line">./support-files/mysql.server: line 276: cd: /usr/local/mysql: No such file or directory</div><div class="line">Starting MySQL ERROR! Couldn't find MySQL server (/usr/local/mysql/bin/mysqld_safe)</div></pre></td></tr></table></figure></p>
<p>修改/home/mysql/support-files/mysql.server文件中的basedir和datadir路径<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">vim support-files/mysql.server</div><div class="line">--------------------------</div><div class="line">...</div><div class="line">basedir=/home/mysql</div><div class="line">datadir=/home/mysql/data</div><div class="line">...</div><div class="line">--------------------------</div><div class="line">./support-files/mysql.server</div><div class="line">start Starting MySQL.. OK!</div></pre></td></tr></table></figure></p>
<p>6.创建软链接<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">ln</span> -s /home/mysql/bin/mysql /usr/bin/mysql</div></pre></td></tr></table></figure></p>
<p>7.创建配置文件<br>    1、将默认生成的my.cnf备份<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">mv</span> /etc/my.cnf /etc/my.cnf.bak</div></pre></td></tr></table></figure></p>
<p>如果这一步报错，没有关系，正常情况下是由于/ect文件夹下没有my.cnf锁引起的，创建一下就可以了，或者你不会创建 ， 直接使用 vim<br>/ect/my.cnf 命令编辑 ，然后直接退出编辑就可以，在执行这个命令就不会出错了，退出编辑命令  esc键  -&gt; (shift键+ ：(冒号键) -&gt; wq! ),然后在执行上面的命令就不会报错了。  </p>
<p>2、进入mysql的安装目录支持文件目录  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">cd</span> /home/mysql/support-files</div></pre></td></tr></table></figure>
<p>3、拷贝配置文件模板为新的mysql配置文件</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">cp</span> my-default.cnf /etc/my.cnf</div></pre></td></tr></table></figure>
<p>4、设置编码，可按需修改新的配置文件选项， 不修改配置选项， mysql则按默认配置参数运行<br>如下是我修改配置文件/etc/my.cnf， 设置编码为utf8以防乱码  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">vim /etc/my.cnf</div><div class="line"> </div><div class="line">[mysqld]</div><div class="line"> </div><div class="line">basedir = /home/mysql</div><div class="line">datadir = /home/mysql/data</div><div class="line"> </div><div class="line">character_set_server=utf8</div><div class="line">init_connect='SET NAMES utf8'</div><div class="line"> </div><div class="line"> </div><div class="line">[client]</div><div class="line">default-character-set=utf8</div></pre></td></tr></table></figure>
<p>有的时候使用这个命令后，前3步有问题的这里可能my.cnf文件是空的，这个不要紧，既然没有生成，那么你就自己编辑喽！具体编辑怎么实现就参照步骤6  </p>
<p>8.配置mysql服务开机自动启动<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">cp</span> /home/mysql/support-files/mysql.server /etc/init.d/mysqld      # 拷贝启动文件到/etc/init.d/下并重命令为mysqld</div><div class="line"><span class="attribute">chmod</span> 755 /etc/init.d/mysqld                                      # 增加执行权限</div><div class="line"><span class="attribute">chkconfig</span> --list mysqld                                           # 检查自启动项列表中没有mysqld这个，</div><div class="line"><span class="attribute">chkconfig</span> --add mysqld                                            # 如果没有就添加mysqld：</div><div class="line"><span class="attribute">chkconfig</span> mysqld <span class="literal">on</span>                                               # 用这个命令设置开机启动：</div></pre></td></tr></table></figure></p>
<p>如果在执行第一步就报错，则说明刚刚在第8步中配置出问题了，那你就重新设置一下  </p>
<p><img src="https://volc1605.github.io/images/linux操作mysql/1.png" alt="1"><br>如果后面的操作中出现以下的问题<br><img src="https://volc1605.github.io/images/linux操作mysql/2.png" alt="2"></p>
<p>这样就是电脑环境的问题了，你就直接把<br><img src="https://volc1605.github.io/images/linux操作mysql/3.png" alt="3"></p>
<p>9.mysql服务的启动/重启/停止<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">service</span> mysqld start                                               # 启动服务</div><div class="line"><span class="attribute">service</span> mysqld restart                                             # 重启服务</div><div class="line"><span class="attribute">service</span> mysqld stop                                                # 停止服务</div></pre></td></tr></table></figure></p>
<p>10.修改mysql登录密码<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">mysql</span>&gt; SET PASSWORD = PASSWORD('123456'); # PASSWORD()里面的123456是我设置的新密码，你也可以设置成你的密码</div><div class="line"><span class="attribute">Query</span> OK, 0 rows affected, 1 warning (0.00 sec)</div><div class="line"><span class="attribute">Rows</span> matched: 2 Changed: 0 Warnings: 1</div><div class="line"><span class="attribute">mysql</span>&gt; ALTER USER 'root'@'localhost' PASSWORD EXPIRE NEVER;</div><div class="line"><span class="attribute">Query</span> OK, 0 rows affected, 1 warning (0.00 sec)</div><div class="line"><span class="attribute">Rows</span> matched: 2 Changed: 0 Warnings: 1</div><div class="line"><span class="attribute">mysql</span>&gt; flush privileges;</div><div class="line"><span class="attribute">Query</span> OK, 0 rows affected, 1 warning (0.00 sec)</div><div class="line"><span class="attribute">Rows</span> matched: 2 Changed: 0 Warnings: 1</div></pre></td></tr></table></figure></p>
<p>11.mysql远程授权<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">[root@testfornss ~]# mysql -u root -p  </div><div class="line">Enter password:</div><div class="line">Welcome to the MySQL monitor. Commands end with ; or \g.</div><div class="line">Your MySQL connection id is 4</div><div class="line">Server version: 5.7.13 MySQL Community Server (GPL)</div><div class="line"> </div><div class="line">Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.</div><div class="line"> </div><div class="line">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line">affiliates. Other names may be trademarks of their respective</div><div class="line">owners.</div><div class="line"> </div><div class="line">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</div><div class="line"> </div><div class="line">mysql&gt; grant all privileges on *.* to 'root'@'%' identified by '123456';</div><div class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</div><div class="line"> </div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
<p>12.设置访问mysql数据库不区分大小写<br>    修改目录下/etc的my.cnf<br>    在[mysqld]配置下追加<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">lower_case_table_names</span>=1</div></pre></td></tr></table></figure></p>
<p>0代表区别大小写  </p>
<p>问题：<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">mysql</span> -u bg -p # 回车输入密码连不上</div><div class="line"><span class="attribute">mysql</span> -r bg -p # 回车输入密码可以连上</div></pre></td></tr></table></figure></p>
<p>解决方法：<br>properties配置数据库properties配置数据库：<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">master</span>.name=csp</div><div class="line"><span class="attribute">master</span>.url=jdbc:mysql://116.62.29.200:3306/bg?characterEncoding=utf-8&amp;allowMultiQueries=true</div><div class="line"><span class="attribute">master</span>.driverClassName=com.mysql.jdbc.Driver</div><div class="line"></div><div class="line"><span class="comment"># \u5f00\u53d1\u73af\u5883</span></div><div class="line"><span class="attribute">master</span>.username=root           # 名称是root，不是bg</div><div class="line"><span class="attribute">master</span>.password=bmx84185858</div></pre></td></tr></table></figure></p>
<p>参考资源：<a href="http://www.cnblogs.com/gaojupeng/p/5727069.html" target="_blank" rel="external">http://www.cnblogs.com/gaojupeng/p/5727069.html</a></p>
<h1 id="登录mysql"><a href="#登录mysql" class="headerlink" title="登录mysql"></a>登录mysql</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">mysql</span> -u root -p  	# 登录</div><div class="line"><span class="attribute">quit</span>;  				# 退出</div></pre></td></tr></table></figure>
<h1 id="开启查询日志"><a href="#开启查询日志" class="headerlink" title="开启查询日志"></a>开启查询日志</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">show variables like &apos;%quer%&apos;;</div></pre></td></tr></table></figure>
<p>结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">+----------------------------------------+--------------------------------------------------------+</div><div class="line">| Variable_name                          | Value                                                  |</div><div class="line">+----------------------------------------+--------------------------------------------------------+</div><div class="line">| binlog_rows_query_log_events           | OFF                                                    |</div><div class="line">| ft_query_expansion_limit               | 20                                                     |</div><div class="line">| have_query_cache                       | YES                                                    |</div><div class="line">| log_queries_not_using_indexes          | OFF                                                    |</div><div class="line">| log_throttle_queries_not_using_indexes | 0                                                      |</div><div class="line">| long_query_time                        | 10.000000                                              |</div><div class="line">| query_alloc_block_size                 | 8192                                                   |</div><div class="line">| query_cache_limit                      | 1048576                                                |</div><div class="line">| query_cache_min_res_unit               | 4096                                                   |</div><div class="line">| query_cache_size                       | 1048576                                                |</div><div class="line">| query_cache_type                       | OFF                                                    |</div><div class="line">| query_cache_wlock_invalidate           | OFF                                                    |</div><div class="line">| query_prealloc_size                    | 8192                                                   |</div><div class="line">| slow_query_log                         | OFF                                                    |</div><div class="line">| slow_query_log_file                    | /usr/local/mysql/data/iZbp199af3f3y8j7fr8kolZ-slow.log |</div><div class="line">+----------------------------------------+--------------------------------------------------------+</div><div class="line">15 rows in set (0.00 sec)</div></pre></td></tr></table></figure></p>
<p>Linux下找到mysql的配置文件my.cnf, 在mysqld下方加入慢查询的配置语句(注意:一定要在[mysqld]下的下方加入)</p>
<h1 id="重启mysql服务的报错"><a href="#重启mysql服务的报错" class="headerlink" title="重启mysql服务的报错"></a>重启mysql服务的报错</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@iZbp199af3f3y8j7fr8kolZ /]# service mysqld start</div><div class="line">Starting MySQL...The server quit without updating PID file [FAILED]cal/mysql/data/iZbp199af3f3y8j7fr8kolZ.pid).</div></pre></td></tr></table></figure>
<p>解决方法:<br>配置my.cnf文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"># 设置不区分大小写</div><div class="line"> lower_case_table_names=1</div><div class="line"> </div><div class="line"># 开启慢查询</div><div class="line">  slow_query_log=on</div><div class="line"></div><div class="line"># 设置多少时长为慢查询</div><div class="line"> long_query_time=0.00001</div><div class="line"> </div><div class="line"># 错误日志</div><div class="line"> log-error=/usr/local/mysql/logs/error.log</div><div class="line"># 慢查寻信息日志</div><div class="line"> slow_query_log_file=/usr/local/mysql/logs/slowquery.log</div><div class="line"> </div><div class="line"># log=/usr/local/mysql/logs/mysql.log</div><div class="line"># log_slow_queries=/usr/local/mysql/logs/slowquery.log</div><div class="line"># mysql5.6版本以上，取消了参数log_slow_queries，更改为slow_query_log_file</div><div class="line"># log_slow_queries=/home/db/madb/log/slow_query.log</div></pre></td></tr></table></figure></p>
<p>mysql获取随机数更新百万数据  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT FLOOR( MAX(NOW()) * RAND()) as r;</div></pre></td></tr></table></figure>
<p>重启mysql服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo /usr/local/mysql/support-files/mysql.server restart</div></pre></td></tr></table></figure></p>
<p>查询多长时间为慢查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">show variables like &apos;long_query_time&apos;;</div></pre></td></tr></table></figure>
<p>查询输出记录次数最多的10条SQL语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/mysql/bin/mysqldumpslow -s c -t 10 /usr/local/mysql/logs/slowquery.log</div></pre></td></tr></table></figure></p>
<p>/usr/local/mysql/bin/mysqldumpslow -s t -t 2 -a /usr/local/mysql/logs/slowquery.log</p>
<p>如果正在运行的是线上库，不方便重启   </p>
<p>MySQL从5.1及以后版本支持了 开启slow query in runtime。只需要执行：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SET GLOBAL slow_query_log = &apos;ON&apos;;</div></pre></td></tr></table></figure>
<p>如果不生效，试一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; FLUSH LOGS;</div></pre></td></tr></table></figure>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Maven]]></title>
      <url>https://volc1605.github.io/2016/11/26/Maven/</url>
      <content type="html"><![CDATA[<h1 id="Maven项目不显示-Maven-Dependencies"><a href="#Maven项目不显示-Maven-Dependencies" class="headerlink" title="Maven项目不显示 Maven Dependencies"></a>Maven项目不显示 Maven Dependencies</h1><p>从别目录结构正确的项目中复制.classpath文件，覆盖不显示Maven Dependencies的项目目录中的.classpath</p>
<h1 id="去掉dynamic-web-module勾选后，每次更新maven项目都会出现以下结构"><a href="#去掉dynamic-web-module勾选后，每次更新maven项目都会出现以下结构" class="headerlink" title="去掉dynamic web module勾选后，每次更新maven项目都会出现以下结构"></a>去掉dynamic web module勾选后，每次更新maven项目都会出现以下结构</h1><p><img src="https://volc1605.github.io/images/Maven/mavenConstruction2.png" alt="maven"></p>
<p>解决方法：<br>项目properties中maven-&gt;javaee integration去掉勾选<br>去除maven项目中javascript resources引用jar包<br>properties中project facets只选择java，去掉javascript<br>去除maven项目结构目录中含有web app 2.3<br>properties中project facets只选择java 去掉dynamic web module</p>
<h1 id="解决maven项目名称出现个红叉报错"><a href="#解决maven项目名称出现个红叉报错" class="headerlink" title="解决maven项目名称出现个红叉报错"></a>解决maven项目名称出现个红叉报错</h1><p>properties中project facets的java版本号选择不当</p>
<h1 id="目录下的创建普通文件夹"><a href="#目录下的创建普通文件夹" class="headerlink" title="目录下的创建普通文件夹"></a>目录下的创建普通文件夹</h1><p>properties中的javabuild path resource-&gt;excluded **</p>
<h1 id="pom文件war报错"><a href="#pom文件war报错" class="headerlink" title="pom文件war报错"></a>pom文件war报错</h1><p>1.加上webapp中的web.xml文件<br>2.properties中maven deployment assembly(用来配置添加根目录文件夹)不显示<br>    需要在project facets中修改</p>
<h1 id="项目启动报错"><a href="#项目启动报错" class="headerlink" title="项目启动报错"></a>项目启动报错</h1><p>原因jar包冲突<br>D:\java-tools\apache-maven-3.2.3\repo\org\apache\tomcat\servlet-api\6.0.28\servlet-api-6.0.28.jar</p>
<h1 id="xsd文件找不到"><a href="#xsd文件找不到" class="headerlink" title="xsd文件找不到"></a>xsd文件找不到</h1><p>报错提示，要引入jar包。或者手动添加xsd文件或者手动指定(参考：<a href="http://www.ibm.com/developerworks/cn/xml/x-1008dubb/" target="_blank" rel="external">http://www.ibm.com/developerworks/cn/xml/x-1008dubb/</a>)</p>
<h2 id="解决pom文件报错和multiple-problems-have-occurred错误"><a href="#解决pom文件报错和multiple-problems-have-occurred错误" class="headerlink" title="解决pom文件报错和multiple problems have occurred错误"></a>解决pom文件报错和multiple problems have occurred错误</h2><p>错误实质上都是jar依赖的问题，只需两步就可解决<br>进入出问题的jar包所在的本地仓库目录<br>1、    删除所有以.lastUpdate结尾的文件<br>a)    1、切换到maven的本地仓库<br>b)    2、在当前目录打开cmd命令行<br>c)    3、执行命令：for /r %i in (*.lastUpdated) do del %i<br>2、    在项目上执行 Maven Update （Alt + F5）</p>
<h2 id="如何避免jar下载不全导致项目报错"><a href="#如何避免jar下载不全导致项目报错" class="headerlink" title="如何避免jar下载不全导致项目报错"></a>如何避免jar下载不全导致项目报错</h2><p>使用相对稳定的私服下载地址：开源中国(<a href="http://maven.oschina.net/help.html" target="_blank" rel="external">http://maven.oschina.net/help.html</a>)<br>在maven指向的setting.xml文件中进行改变私服URL配置。</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[java设计模式]]></title>
      <url>https://volc1605.github.io/2016/11/24/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<h1 id="singleton单例模式"><a href="#singleton单例模式" class="headerlink" title="singleton单例模式"></a>singleton单例模式</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> myprogram;</div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@ClassName</span> Singleton</div><div class="line"> * <span class="doctag">@Description</span> 单例模式-懒汉式</div><div class="line"> * 既实现了线程安全，又避免了同步带来的性能影响</div><div class="line"> * <span class="doctag">@Author</span> youtanzhi</div><div class="line"> * <span class="doctag">@Date</span> 2016年11月15日 下午3:58:33</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">LazyHolder</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton INSTANCE = <span class="keyword">new</span> Singleton();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> LazyHolder.INSTANCE;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> myprogram;</div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@ClassName</span> Singleton1</div><div class="line"> * <span class="doctag">@Description</span> 饿汉式单例类.在类初始化时，已经自行实例化</div><div class="line"> * <span class="doctag">@Author</span> youtanzhi</div><div class="line"> * <span class="doctag">@Date</span> 2016年11月15日 下午4:02:31</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton1</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton1</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton1 single = <span class="keyword">new</span> Singleton1();</div><div class="line"></div><div class="line">    <span class="comment">// 静态工厂方法</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton1 <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> single;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[LINUX]]></title>
      <url>https://volc1605.github.io/2016/11/23/linux/</url>
      <content type="html"><![CDATA[<h1 id="LINUX常用命令"><a href="#LINUX常用命令" class="headerlink" title="LINUX常用命令"></a>LINUX常用命令</h1><blockquote>
<p>ls命令   </p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">ls</span> -l                                             # 目录详细结构</div></pre></td></tr></table></figure>
<a id="more"></a>                                        
<blockquote>
<p>mkdir命令                                         </p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">mkdir</span> folder1                                     # 创建folder1文件夹</div></pre></td></tr></table></figure>
<blockquote>
<p>rm命令                                            </p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">rm</span> folder1                                        # 删除folder1文件夹</div><div class="line"><span class="attribute">rm</span> file                                           # 删除文件</div></pre></td></tr></table></figure>
<blockquote>
<p>cp命令                                            </p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">cp</span> file1 file2                                    # 复制file1文件到file2</div></pre></td></tr></table></figure>
<blockquote>
<p>mv命令                                            </p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">mv</span> file1.txt file2.txt                            # 重命名</div><div class="line"><span class="attribute">mv</span> folder1 folder2                                # 移动folder1文件夹(包含folder1)到folder2文件夹</div></pre></td></tr></table></figure>
<blockquote>
<p>vi命令  </p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">vi</span> file1.txt                                      # 查看file1.txt文件第一页(command mode),trl + f进行翻页</div><div class="line">                                                  <span class="comment"># 按i建进入编辑模式(insert mode)</span></div><div class="line">				                  <span class="comment"># 退出vi命令:</span></div><div class="line">				                  <span class="comment"># Esc按键(command mode) 输入':q'回车退出</span></div><div class="line">				                  <span class="comment"># ':wq'保存退出</span></div><div class="line">				                  <span class="comment"># ':q!'强制退出</span></div><div class="line">				                  <span class="comment"># 输入':/str'回车查找str字符串，按n查看下一个</span></div></pre></td></tr></table></figure>
<blockquote>
<p>cat命令  </p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">cat</span> file1.txt                                     # 查看file1.txt所有信息</div><div class="line"><span class="attribute">cat</span> file1.txt | grep 'info'                       # 查看file1.txt中匹配'info'所在行信息,并标记'info'字符串</div><div class="line"><span class="attribute">cat</span> file1 file2 &gt; file                            # file1和file2合并到file问价并显示</div><div class="line"><span class="attribute">cat</span> must.txt | tail -n +10 | head -n 10           # 查看must.txt文件，从第10行起显示10行，即'10-19'行</div></pre></td></tr></table></figure>
<blockquote>
<p>tail命令                                          </p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">tailf</span> catalina.out | grep 'countTime'             # 只实时显示含有'countTime'所在行的信息</div><div class="line"><span class="attribute">tail</span> -f file1                                     # 实时显示file1文件后十条并进入编辑模式</div><div class="line"><span class="attribute">tail</span> -n 200 -f file1                              # 实时显示file1后200行变化信息，和上面的命令效果相似	</div><div class="line"><span class="attribute">tail</span> -n 200 file1 | grep 'test'                   # 查看file1文件后200行，高亮'test'(最常用)</div><div class="line"><span class="attribute">tail</span> -n 200 -f file1 | grep 'INFO*'               # 实时显示file1后200行变化信息，并标记处'INFO'字符串(最常用)</div></pre></td></tr></table></figure>
<blockquote>
<p>find命令                                          </p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">find</span> folder1 -type f -name <span class="string">"*.txt"</span>                # 查询当前目录下的folder1文件夹中匹配'*.txt'的文件或文件夹</div><div class="line"><span class="attribute">find</span> folder1 -name 'must.txt' -ls                 # 查询当前目录下的folder1文件夹中匹配'*.txt'的文件或文件夹，并显示信息</div><div class="line"><span class="attribute">find</span> -type f -name 'must.txt'|xargs grep 'str'    # 查询当前目录下的must.txt文件中匹配'str'所在行的信息</div><div class="line"><span class="attribute">find</span> / -name <span class="string">"memca*"</span>							  # 根据文件名称全局查找</div><div class="line"><span class="attribute">grep</span> -rn <span class="string">"str"</span> *                                  # 查询当前目录下的must.txt文件中匹配'str'所在行的信息</div><div class="line">    <span class="comment"># * : 表示当前目录所有文件，也可以是某个文件名</span></div><div class="line">    <span class="comment"># -r 是递归查找</span></div><div class="line">    <span class="comment"># -n 是显示行号</span></div><div class="line">    <span class="comment"># -R 查找所有文件包含子目录</span></div><div class="line">    <span class="comment"># -i 忽略大小写</span></div></pre></td></tr></table></figure>
<blockquote>
<p>echo命令</p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">echo</span> <span class="string">"hello world"</span> &gt; file.txt                     # 当前目录下创建file.txt文件并添加数据</div></pre></td></tr></table></figure>
<h1 id="查看服务器外网ip"><a href="#查看服务器外网ip" class="headerlink" title="查看服务器外网ip"></a>查看服务器外网ip</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">curl</span> http://members.3322.org/dyndns/getip</div></pre></td></tr></table></figure>
<h1 id="查看服务器网络地址"><a href="#查看服务器网络地址" class="headerlink" title="查看服务器网络地址"></a>查看服务器网络地址</h1><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">[root@iZbp199af3f3y8j7fr8kolZ ~]# ifconfig</div><div class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</div><div class="line">        inet 10.27.235.142  netmask 255.255.252.0  broadcast 10.27.235.255</div><div class="line">        ether 00:16:3e:0d:f7:47  txqueuelen 1000  (Ethernet)</div><div class="line">        RX packets 15622862  bytes 1152767495 (1.0 GiB)</div><div class="line">        RX errors 0  dropped 0  overruns 0  frame 0</div><div class="line">        TX packets 107645  bytes 7704353 (7.3 MiB)</div><div class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</div><div class="line"></div><div class="line">eth1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</div><div class="line">        inet 116.62.29.229  netmask 255.255.252.0  broadcast 116.62.31.255</div><div class="line">        ether 00:16:3e:0c:a6:a1  txqueuelen 1000  (Ethernet)</div><div class="line">        RX packets 261064410  bytes 18335028955 (17.0 GiB)</div><div class="line">        RX errors 0  dropped 0  overruns 0  frame 0</div><div class="line">        TX packets 5924776  bytes 1812912938 (1.6 GiB)</div><div class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</div><div class="line"></div><div class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</div><div class="line">        inet 127.0.0.1  netmask 255.0.0.0</div><div class="line">        loop  txqueuelen 0  (Local Loopback)</div><div class="line">        RX packets 18419107  bytes 2800651279 (2.6 GiB)</div><div class="line">        RX errors 0  dropped 0  overruns 0  frame 0</div><div class="line">        TX packets 18419107  bytes 2800651279 (2.6 GiB)</div><div class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</div></pre></td></tr></table></figure>
<p>其中eth0为内网，eth1为外网</p>
<h1 id="更改文件或文件夹权限"><a href="#更改文件或文件夹权限" class="headerlink" title="更改文件或文件夹权限"></a>更改文件或文件夹权限</h1><p>改变一个文件的权限: chmod mode file|dir<br>改变所有子目录的权限: chmod mode dir -R</p>
<p>mode = 777 or 752 and so on.<br>mode的三个数字，分别表示 owner，group,others所具有的权限。<br>1 = x 执行 2 = w 写 4 = r 读，比如owner具有所有权限，1+2+4=7,<br>又比如 group 具有 读 和 执行 权限 1+4 = 5</p>
<h1 id="查看端口使用情况"><a href="#查看端口使用情况" class="headerlink" title="查看端口使用情况"></a>查看端口使用情况</h1><p>查看正在使用的端口号  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">netstat</span> -anp</div><div class="line"><span class="attribute">tcp</span>        0      0 114.55.113.160:50358    106.11.68.13:80 ESTABLISHED 1338/AliYunDun</div></pre></td></tr></table></figure>
<h1 id="查看端口号对应的服务名称"><a href="#查看端口号对应的服务名称" class="headerlink" title="查看端口号对应的服务名称"></a>查看端口号对应的服务名称</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">lsof</span> -i:<span class="string">"50358"</span></div><div class="line"><span class="attribute">AliYunDun</span> 1338 root   11u  IPv4 7340009      0t0  TCP 114.55.113.160:50358-&gt;106.11.68.13:http (ESTABLISHED)</div></pre></td></tr></table></figure>
<h1 id="根据pid查看进程信息所在目录"><a href="#根据pid查看进程信息所在目录" class="headerlink" title="根据pid查看进程信息所在目录"></a>根据pid查看进程信息所在目录</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">lsof</span> -p <span class="string">"24619"</span></div></pre></td></tr></table></figure>
<h1 id="根据PID进程号关闭服务"><a href="#根据PID进程号关闭服务" class="headerlink" title="根据PID进程号关闭服务"></a>根据PID进程号关闭服务</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">kill</span> -9 <span class="string">"1338"</span></div></pre></td></tr></table></figure>
<h1 id="根据服务名称查看是否启用"><a href="#根据服务名称查看是否启用" class="headerlink" title="根据服务名称查看是否启用"></a>根据服务名称查看是否启用</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">ps</span> -aux | grep <span class="string">"memcache"</span></div><div class="line"><span class="attribute">root</span>     25899  0.0  0.0 112648   972 pts/0    S+   11:16   0:00 grep --color=auto memcache</div></pre></td></tr></table></figure>
<h1 id="和sh执行脚本的区别"><a href="#和sh执行脚本的区别" class="headerlink" title="./和sh执行脚本的区别"></a>./和sh执行脚本的区别</h1><p>./需要执行权限<br>sh不需要，sh是个软链接，它可能是一个任意的shell，通常默认是bash shell<br>用type命令可以查看<br>./执行调用的是你开头一行定义的shell，不指定系统会调用默认shell程序  </p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[MySQL]]></title>
      <url>https://volc1605.github.io/2016/11/19/MySQL/</url>
      <content type="html"><![CDATA[<h1 id="部门表dept和员工表empMySQL练习"><a href="#部门表dept和员工表empMySQL练习" class="headerlink" title="部门表dept和员工表empMySQL练习"></a>部门表dept和员工表empMySQL练习</h1><blockquote>
<p>建表</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">Navicat MySQL Data Transfer</div><div class="line"></div><div class="line">Source Server         : 10.1.1.241</div><div class="line">Source Server Version : 50547</div><div class="line">Source Host           : 10.1.1.241:3306</div><div class="line">Source Database       : test</div><div class="line"></div><div class="line">Target Server Type    : MYSQL</div><div class="line">Target Server Version : 50547</div><div class="line">File Encoding         : 65001</div><div class="line"></div><div class="line">Date: 2016-11-15 15:41:17</div><div class="line">*/</div><div class="line"></div><div class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS=<span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="comment">-- Table structure for bonus</span></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`bonus`</span>;</div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`bonus`</span> (</div><div class="line">  <span class="string">`empno`</span> <span class="built_in">decimal</span>(<span class="number">4</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`job`</span> <span class="built_in">varchar</span>(<span class="number">9</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`sal`</span> <span class="built_in">decimal</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`comm`</span> <span class="built_in">decimal</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></div><div class="line">) <span class="keyword">ENGINE</span>=MyISAM <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</div><div class="line"></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="comment">-- Records of bonus</span></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="comment">-- Table structure for dept</span></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`dept`</span>;</div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`dept`</span> (</div><div class="line">  <span class="string">`deptno`</span> <span class="built_in">decimal</span>(<span class="number">2</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`dname`</span> <span class="built_in">varchar</span>(<span class="number">14</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`loc`</span> <span class="built_in">varchar</span>(<span class="number">13</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></div><div class="line">) <span class="keyword">ENGINE</span>=MyISAM <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</div><div class="line"></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="comment">-- Records of dept</span></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`dept`</span> <span class="keyword">VALUES</span> (<span class="string">'10'</span>, <span class="string">'ACCOUNTING'</span>, <span class="string">'NEW YORK'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`dept`</span> <span class="keyword">VALUES</span> (<span class="string">'20'</span>, <span class="string">'RESEARCH'</span>, <span class="string">'DALLAS'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`dept`</span> <span class="keyword">VALUES</span> (<span class="string">'30'</span>, <span class="string">'SALES'</span>, <span class="string">'CHICAGO'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`dept`</span> <span class="keyword">VALUES</span> (<span class="string">'40'</span>, <span class="string">'OPERATIONS'</span>, <span class="string">'BOSTON'</span>);</div><div class="line"></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="comment">-- Table structure for emp</span></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`emp`</span>;</div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`emp`</span> (</div><div class="line">  <span class="string">`empno`</span> <span class="built_in">decimal</span>(<span class="number">4</span>,<span class="number">0</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`ename`</span> <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`job`</span> <span class="built_in">varchar</span>(<span class="number">9</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`mgr`</span> <span class="built_in">decimal</span>(<span class="number">4</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`hiredate`</span> datetime <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`sal`</span> <span class="built_in">decimal</span>(<span class="number">7</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`comm`</span> <span class="built_in">decimal</span>(<span class="number">7</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`deptno`</span> <span class="built_in">decimal</span>(<span class="number">2</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></div><div class="line">) <span class="keyword">ENGINE</span>=MyISAM <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</div><div class="line"></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="comment">-- Records of emp</span></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7369'</span>, <span class="string">'SMITH'</span>, <span class="string">'CLERK'</span>, <span class="string">'7902'</span>, <span class="string">'1980-12-17 00:00:00'</span>, <span class="string">'960.00'</span>, <span class="literal">null</span>, <span class="string">'20'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7499'</span>, <span class="string">'ALLEN'</span>, <span class="string">'SALESMAN'</span>, <span class="string">'7698'</span>, <span class="string">'1981-02-20 00:00:00'</span>, <span class="string">'2764.80'</span>, <span class="string">'300.00'</span>, <span class="string">'30'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7521'</span>, <span class="string">'WARD'</span>, <span class="string">'SALESMAN'</span>, <span class="string">'7698'</span>, <span class="string">'1981-02-22 00:00:00'</span>, <span class="string">'2160.00'</span>, <span class="string">'500.00'</span>, <span class="string">'30'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7566'</span>, <span class="string">'JONES'</span>, <span class="string">'MANAGER'</span>, <span class="string">'7839'</span>, <span class="string">'1981-04-02 00:00:00'</span>, <span class="string">'3570.00'</span>, <span class="literal">null</span>, <span class="string">'20'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7654'</span>, <span class="string">'MARTIN'</span>, <span class="string">'SALESMAN'</span>, <span class="string">'7698'</span>, <span class="string">'1981-09-28 00:00:00'</span>, <span class="string">'2160.00'</span>, <span class="string">'1400.00'</span>, <span class="string">'30'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7698'</span>, <span class="string">'BLAKE'</span>, <span class="string">'MANAGER'</span>, <span class="string">'7839'</span>, <span class="string">'1981-05-01 00:00:00'</span>, <span class="string">'4924.80'</span>, <span class="literal">null</span>, <span class="string">'30'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7782'</span>, <span class="string">'CLARK'</span>, <span class="string">'MANAGER'</span>, <span class="string">'7839'</span>, <span class="string">'1981-06-09 00:00:00'</span>, <span class="string">'2940.00'</span>, <span class="literal">null</span>, <span class="string">'10'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7788'</span>, <span class="string">'SCOTT'</span>, <span class="string">'ANALYST'</span>, <span class="string">'7566'</span>, <span class="string">'1982-12-09 00:00:00'</span>, <span class="string">'3600.00'</span>, <span class="literal">null</span>, <span class="string">'20'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7839'</span>, <span class="string">'KING'</span>, <span class="string">'PRESIDENT'</span>, <span class="literal">null</span>, <span class="string">'1981-11-17 00:00:00'</span>, <span class="string">'6000.00'</span>, <span class="literal">null</span>, <span class="string">'10'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7844'</span>, <span class="string">'TURNER'</span>, <span class="string">'SALESMAN'</span>, <span class="string">'7698'</span>, <span class="string">'1981-09-08 00:00:00'</span>, <span class="string">'2592.00'</span>, <span class="string">'0.00'</span>, <span class="string">'30'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7876'</span>, <span class="string">'ADAMS'</span>, <span class="string">'CLERK'</span>, <span class="string">'7788'</span>, <span class="string">'1983-01-12 00:00:00'</span>, <span class="string">'1320.00'</span>, <span class="literal">null</span>, <span class="string">'20'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7900'</span>, <span class="string">'JAMES'</span>, <span class="string">'CLERK'</span>, <span class="string">'7698'</span>, <span class="string">'1981-12-03 00:00:00'</span>, <span class="string">'1641.60'</span>, <span class="literal">null</span>, <span class="string">'30'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7902'</span>, <span class="string">'FORD'</span>, <span class="string">'ANALYST'</span>, <span class="string">'7566'</span>, <span class="string">'1981-12-03 00:00:00'</span>, <span class="string">'3600.00'</span>, <span class="literal">null</span>, <span class="string">'20'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7934'</span>, <span class="string">'MILLER'</span>, <span class="string">'CLERK'</span>, <span class="string">'7782'</span>, <span class="string">'1982-01-23 00:00:00'</span>, <span class="string">'1560.00'</span>, <span class="literal">null</span>, <span class="string">'10'</span>);</div><div class="line"></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="comment">-- Table structure for salgrade</span></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`salgrade`</span>;</div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`salgrade`</span> (</div><div class="line">  <span class="string">`grade`</span> <span class="built_in">decimal</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`losal`</span> <span class="built_in">decimal</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</div><div class="line">  <span class="string">`hisal`</span> <span class="built_in">decimal</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></div><div class="line">) <span class="keyword">ENGINE</span>=MyISAM <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</div><div class="line"></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="comment">-- Records of salgrade</span></div><div class="line"><span class="comment">-- ----------------------------</span></div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`salgrade`</span> <span class="keyword">VALUES</span> (<span class="string">'1'</span>, <span class="string">'700'</span>, <span class="string">'1200'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`salgrade`</span> <span class="keyword">VALUES</span> (<span class="string">'2'</span>, <span class="string">'1201'</span>, <span class="string">'1400'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`salgrade`</span> <span class="keyword">VALUES</span> (<span class="string">'3'</span>, <span class="string">'1401'</span>, <span class="string">'2000'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`salgrade`</span> <span class="keyword">VALUES</span> (<span class="string">'4'</span>, <span class="string">'2001'</span>, <span class="string">'3000'</span>);</div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`salgrade`</span> <span class="keyword">VALUES</span> (<span class="string">'5'</span>, <span class="string">'3001'</span>, <span class="string">'9999'</span>);</div></pre></td></tr></table></figure>
<a id="more"></a>
<blockquote>
<p>练习</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 1.更新名称为'SALES'部门下的所有员工薪水上涨20%</span></div><div class="line"><span class="keyword">UPDATE</span> emp e <span class="keyword">SET</span> e.sal = e.sal * (<span class="number">1</span> + <span class="number">0.2</span>) <span class="keyword">WHERE</span> e.deptno = ( <span class="keyword">SELECT</span> d.deptno <span class="keyword">FROM</span> dept d <span class="keyword">WHERE</span> d.dname = <span class="string">'SALES'</span> );</div><div class="line"><span class="comment">-- 2.找出部门10中所有经理(MANAGER) 和部门20中所有办事员（CLERK）的详细资料</span></div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp e <span class="keyword">WHERE</span> ( e.deptno = <span class="string">'10'</span> <span class="keyword">AND</span> e.job = <span class="string">'MANAGER'</span> ) <span class="keyword">OR</span> ( e.deptno = <span class="string">'20'</span> <span class="keyword">AND</span> e.job = <span class="string">'CLERK'</span>);</div><div class="line"><span class="comment">-- 3.找出部门10中所有经理，部门20中所有的办事员，既不是经理又不是办事员，但是薪金大于或等于2000的所有员工的资料</span></div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> (deptno = <span class="number">10</span> <span class="keyword">AND</span> job = <span class="string">'MANAGER'</span>) <span class="keyword">OR</span> (deptno = <span class="number">20</span> <span class="keyword">AND</span> job = <span class="string">'CLERK'</span>) <span class="keyword">OR</span> ( job <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="string">'MANAGER'</span>, <span class="string">'CLERK'</span>) <span class="keyword">AND</span> sal &gt;= <span class="number">2000</span>);</div><div class="line"><span class="comment">-- 4.找出收取佣金（comm）的员工的不同工作：[DISTINCT-&gt;消除重复的关键字]</span></div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> job <span class="keyword">FROM</span> emp e <span class="keyword">WHERE</span> e.comm <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</div><div class="line"><span class="comment">-- 5.找个各月倒数第三天受雇的所有员工</span></div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp e <span class="keyword">WHERE</span> e.hiredate = <span class="keyword">DATE_FORMAT</span>(<span class="keyword">LAST_DAY</span>(e.hiredate) - <span class="number">2</span>, <span class="string">'%Y-%m-%d %H:%i:%s'</span>);</div><div class="line">	<span class="comment">-- 需要注意的是有两点转换格式的大小写：</span></div><div class="line">	<span class="comment">-- 1.</span></div><div class="line">	<span class="comment">-- LAST_DAY(e.hiredate) 获取到的日期格式：2016-09-30</span></div><div class="line">	<span class="comment">-- LAST_DAY(e.hiredate) - 2 获取到的日期格式：20160928</span></div><div class="line">	<span class="comment">-- 2.转换格式的大小写：</span></div><div class="line">	<span class="comment">-- DATE_FORMAT('2016-11-15', '%Y-%m-%d %H:%i:%s');-&gt;2016-11-15 00:12:00</span></div><div class="line">	<span class="comment">-- DATE_FORMAT('2016-11-15', '%Y-%m-%d %h:%I:%S');-&gt;2016-11-15 12:00:00</span></div><div class="line"><span class="comment">-- 6.找出早于2012年前受雇的员工</span></div><div class="line">	<span class="comment">-- mysql:</span></div><div class="line">	<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp e <span class="keyword">WHERE</span> <span class="keyword">DATE_FORMAT</span>(e.hiredate, <span class="string">'%Y%m%d%H%i%s'</span>) &lt; <span class="string">'2012'</span>;</div><div class="line">	<span class="comment">-- oracle:</span></div><div class="line">	<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> MONTHS_BETWEEN(hiredate,<span class="string">'20120000'</span>)&gt;<span class="number">0</span>;</div><div class="line">	<span class="comment">-- MONTHS_BETWEEN('2012-01-01', '2016-11-12');表示2012-01-01到2016-11-12的月数，以小数形式返回</span></div><div class="line"><span class="comment">-- 7.按照首字母大写其余字母小写的方式显示员工姓名</span></div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>( <span class="keyword">UPPER</span>(<span class="keyword">LEFT</span>(e.ename, <span class="number">1</span>)), <span class="keyword">LOWER</span>( ( <span class="keyword">RIGHT</span> (e.ename, <span class="keyword">LENGTH</span>(e.ename) - <span class="number">1</span>) ) ) ) <span class="keyword">as</span> ename <span class="keyword">FROM</span> emp e;	</div><div class="line"><span class="comment">-- 8.显示正好为5个字符的员工的姓名</span></div><div class="line"><span class="keyword">SELECT</span> e.ename ad ename <span class="keyword">FROM</span> emp e <span class="keyword">WHERE</span> <span class="keyword">LENGTH</span>(e.ename) = <span class="number">5</span>;	</div><div class="line"><span class="comment">-- 9.显示姓名不带'R'的员工的姓名</span></div><div class="line"><span class="keyword">SELECT</span> ename <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> ename <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">'%R%'</span>;	</div><div class="line"><span class="comment">-- 10.显示所有员工姓名的前3个字符</span></div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">SUBSTR</span>(e.ename, <span class="number">1</span>, <span class="number">3</span>) <span class="keyword">FROM</span> emp e;</div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">LEFT</span>(e.ename, <span class="number">3</span>) <span class="keyword">FROM</span> emp e;</div><div class="line"><span class="comment">-- 11.显示所有员工的姓名，并且用“x” 替换替换所有的 “A”</span></div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">REPLACE</span>(ename,<span class="string">'A'</span>,<span class="string">'x'</span>) <span class="keyword">FROM</span> emp;</div><div class="line"><span class="comment">-- 12.显示员工的姓名和受雇日期，并根据其服务年限，把资料最老的员工排在第在前面</span></div><div class="line"><span class="keyword">SELECT</span> ename,hiredate <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> hiredate; <span class="comment">-- mysql默认是ASC升序	</span></div><div class="line"><span class="comment">-- 13.显示所有员工的姓名，加入公司的年份和月份，按受雇日期所在的年排序，若年份相同则讲最早月份的员工排在最前面</span></div><div class="line"><span class="keyword">SELECT</span> e.ename, <span class="keyword">DATE_FORMAT</span>(e.hiredate,<span class="string">'%Y'</span>) <span class="keyword">YEAR</span>, <span class="keyword">DATE_FORMAT</span>(e.hiredate,<span class="string">'%m'</span>) <span class="keyword">MONTH</span> <span class="keyword">FROM</span> emp e <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">YEAR</span>, <span class="keyword">MONTH</span>;</div><div class="line"><span class="comment">-- 14.显示在一个月为30天的情况所有员工的日薪金，并且忽略余数</span></div><div class="line"><span class="keyword">SELECT</span> e.ename, <span class="keyword">ROUND</span>(e.sal/<span class="number">30</span>) 日薪金 <span class="keyword">FROM</span> emp e;	</div><div class="line"><span class="comment">-- 15.找出在（任何年份）的2月受聘的所有员工</span></div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp e <span class="keyword">WHERE</span> <span class="keyword">MONTH</span>(e.hiredate) = <span class="number">2</span>;	</div><div class="line"><span class="comment">-- 16.对于每个员工，显示其加入公司的天数</span></div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">datediff</span>(<span class="keyword">SYSDATE</span>(),<span class="string">'2016-11-15 09:41:18'</span>) 两日期之间天数<span class="number">1</span>, <span class="keyword">TO_DAYS</span>(<span class="keyword">SYSDATE</span>()) - <span class="keyword">TO_DAYS</span>(<span class="string">'2016-11-15 09:41:18'</span>) 两日期之间天数<span class="number">2</span> <span class="keyword">FROM</span> emp e;	</div><div class="line">17.以年月的方式显示所有员工的服务年限</div><div class="line"><span class="keyword">SELECT</span> (<span class="keyword">YEAR</span>(<span class="keyword">SYSDATE</span>())-<span class="keyword">YEAR</span>(e.hiredate)) 年份, (<span class="keyword">YEAR</span>(<span class="keyword">SYSDATE</span>())-<span class="keyword">YEAR</span>(e.hiredate))*<span class="number">12</span> + <span class="keyword">MONTH</span>(<span class="keyword">SYSDATE</span>())-<span class="keyword">MONTH</span>(e.hiredate) 月份 <span class="keyword">FROM</span> emp e;	</div><div class="line"><span class="comment">-- 18.列出至少有三个员工的所有部门和部门信息</span></div><div class="line">	<span class="comment">-- 方式一:</span></div><div class="line">	<span class="keyword">SELECT</span> d.deptno, d.dname, d.loc, <span class="keyword">count</span>(<span class="number">1</span>) 部门人数 <span class="keyword">FROM</span> emp e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> dept d <span class="keyword">ON</span> d.deptno = e.deptno <span class="keyword">GROUP</span> <span class="keyword">BY</span> e.deptno <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(e.empno) &gt; <span class="number">3</span>;</div><div class="line">	<span class="comment">-- 方式二</span></div><div class="line">	<span class="keyword">SELECT</span> d.*, ed.count 部门人数 <span class="keyword">FROM</span> dept d, (<span class="keyword">SELECT</span> deptno, <span class="keyword">COUNT</span>(empno) <span class="keyword">COUNT</span> <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(empno) &gt; <span class="number">3</span>) ed <span class="keyword">WHERE</span> d.deptno = ed.deptno;</div><div class="line"><span class="comment">-- 19.列出薪金比“ALLEN”多的所有员工</span></div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp e <span class="keyword">WHERE</span> e.sal &gt; (<span class="keyword">SELECT</span> e1.sal <span class="keyword">FROM</span> emp e1 <span class="keyword">WHERE</span> e1.ename=<span class="string">'ALLEN'</span>);	</div><div class="line"><span class="comment">-- 20.列出所有员工的姓名及其上级的姓名</span></div><div class="line"><span class="keyword">SELECT</span> e.ename 员工姓名, e1.ename 员工上级姓名 <span class="keyword">FROM</span> emp e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> emp e1 <span class="keyword">ON</span> e.mgr=e1.empno;	</div><div class="line"><span class="comment">-- 21.列出受雇日期早于直接上级的所有员工的编号，姓名，部门名称</span></div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp e <span class="keyword">WHERE</span> e.hiredate &lt; (<span class="keyword">SELECT</span> e1.hiredate <span class="keyword">FROM</span> emp e1 <span class="keyword">WHERE</span> e1.empno=e.mgr);</div><div class="line"><span class="comment">-- 22.列出部门名称和这些部门员工的信息，同时列出那些没有员工的部门</span></div><div class="line"><span class="keyword">SELECT</span> d.dname, e.* <span class="keyword">FROM</span> dept d <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> emp e <span class="keyword">ON</span> e.deptno = d.deptno;	</div><div class="line"><span class="comment">-- 23.列出“CLERK”的姓名和部门名称，部门人数</span></div><div class="line"><span class="keyword">SELECT</span> e.ename, d.dname, ep.cou <span class="keyword">FROM</span> emp e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> dept d <span class="keyword">ON</span> d.deptno=e.deptno <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> e1.deptno, <span class="keyword">COUNT</span>(empno) cou <span class="keyword">FROM</span> emp e1 <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno) ep <span class="keyword">ON</span> ep.deptno=d.deptno <span class="keyword">WHERE</span> e.job = <span class="string">'CLERK'</span>;	</div><div class="line"><span class="comment">-- 24.列出最低薪金大于1500的各种工作以及从事此工作的全部雇员人数</span></div><div class="line"><span class="keyword">SELECT</span> e.job, ep.count <span class="keyword">FROM</span> emp e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> e1.job, <span class="keyword">count</span>(e1.job) <span class="keyword">COUNT</span> <span class="keyword">FROM</span> emp e1 <span class="keyword">GROUP</span> <span class="keyword">BY</span> e1.job) ep <span class="keyword">ON</span> e.job=ep.job <span class="keyword">WHERE</span> e.sal&gt;<span class="number">1500</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> e.job;	</div><div class="line"><span class="comment">-- 25.列出薪金高于工资平均薪金的所有员工，所在部门，上级领导，公司的工资等级</span></div><div class="line"><span class="keyword">SELECT</span> e.empno, d.dname 所在部门名称,e1.ename 上级领导,e.sal 工资, s.grade 工资等级 <span class="keyword">FROM</span> emp e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> dept d <span class="keyword">ON</span> d.deptno=e.deptno <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> emp e1 <span class="keyword">ON</span> e.mgr=e1.empno <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> salgrade s <span class="keyword">ON</span> e.sal <span class="keyword">BETWEEN</span> s.losal <span class="keyword">AND</span> s.hisal <span class="keyword">WHERE</span> e.sal&gt; (<span class="keyword">SELECT</span> <span class="keyword">AVG</span>(e1.sal) <span class="keyword">FROM</span> emp e1);</div><div class="line"><span class="comment">-- 26.列出和“SCOTT”从事相同工作的所有员工及部门名称</span></div><div class="line"><span class="keyword">SELECT</span> e1.empno, e1.job, e1.deptno, d.dname <span class="keyword">FROM</span> emp e1 <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> dept d <span class="keyword">ON</span> d.deptno=e1.deptno <span class="keyword">WHERE</span> e1.job= (<span class="keyword">SELECT</span> e.job <span class="keyword">FROM</span> emp e <span class="keyword">WHERE</span> e.ename=<span class="string">'SCOTT'</span>);	</div><div class="line"><span class="comment">-- 27.列出薪金等于部门30中员工薪金的所有员工的姓名和薪金</span></div><div class="line"><span class="keyword">SELECT</span> ename, sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="keyword">IN</span> (<span class="keyword">SELECT</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno=<span class="string">'30'</span>) <span class="keyword">AND</span> deptno!=<span class="string">'30'</span>;</div><div class="line"><span class="comment">-- 28.列出薪金高于在部门30工作的所有员工的薪金的员工姓名和薪金、部门名称</span></div><div class="line"><span class="keyword">SELECT</span> e.ename 员工姓名, e.sal 薪金, d.dname <span class="keyword">FROM</span> emp e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> dept d <span class="keyword">ON</span> d.deptno=e.deptno <span class="keyword">WHERE</span> e.sal&gt; (<span class="keyword">SELECT</span> <span class="keyword">max</span>(e1.sal) <span class="keyword">FROM</span> emp e1 <span class="keyword">WHERE</span> e1.deptno=<span class="string">'30'</span>);</div><div class="line"><span class="comment">-- 29.列出每个部门工作的员工数量、平均工资和平均服务期限</span></div><div class="line"><span class="keyword">SELECT</span> d.dname 部门名称, <span class="keyword">count</span>(e.deptno) 员工数量, <span class="keyword">AVG</span>(e.sal) 平均工资, <span class="keyword">AVG</span>(((<span class="keyword">YEAR</span> (<span class="keyword">SYSDATE</span>()) - <span class="keyword">YEAR</span> (e.hiredate)) * <span class="number">12</span> + <span class="keyword">MONTH</span> (<span class="keyword">SYSDATE</span>()) - <span class="keyword">MONTH</span> (e.hiredate)) / <span class="number">12</span>) 工作平均年限 <span class="keyword">FROM</span> dept d <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> emp e <span class="keyword">ON</span> e.deptno = d.deptno <span class="keyword">GROUP</span> <span class="keyword">BY</span> e.deptno;	</div><div class="line"><span class="comment">-- 30.列出各个部门的MANAGER 的最低薪金</span></div><div class="line"><span class="keyword">SELECT</span> ep.*, <span class="keyword">MIN</span>(ep.sal) 部门最低薪水 <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> d.dname 部门名称,e.* <span class="keyword">FROM</span> emp e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> dept d <span class="keyword">ON</span> d.deptno=e.deptno <span class="keyword">WHERE</span> e.job=<span class="string">'MANAGER'</span>) ep <span class="keyword">GROUP</span> <span class="keyword">BY</span> ep.部门名称;</div><div class="line"><span class="comment">-- 31.查询出某个员工的上级主管，并要求这些主管中的薪水超过3000</span></div><div class="line"><span class="keyword">SELECT</span> e.* <span class="keyword">FROM</span> emp e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> emp e1 <span class="keyword">ON</span> e1.deptno=e.mgr <span class="keyword">WHERE</span> e.sal&gt;<span class="number">3000</span>;</div><div class="line"><span class="comment">-- 32.求出部门名称中带有’S‘字符的部门员工的工资合计，部门人数</span></div><div class="line"><span class="keyword">SELECT</span> d.dname 部门名称, <span class="keyword">sum</span>(e.sal) 工资合计, <span class="keyword">count</span>(e.deptno) <span class="keyword">FROM</span> dept d <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> emp e <span class="keyword">ON</span> e.deptno=d.deptno <span class="keyword">WHERE</span> d.dname <span class="keyword">LIKE</span> <span class="string">'%S%'</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> d.deptno;	</div><div class="line"><span class="comment">-- 33.给任职日期超过10年的人加薪10%</span></div><div class="line"><span class="keyword">UPDATE</span> emp e <span class="keyword">SET</span> e.sal=e.sal*<span class="number">1.1</span> <span class="keyword">WHERE</span> (<span class="keyword">TIMESTAMPDIFF</span>(<span class="keyword">MONTH</span>,e.hiredate,<span class="keyword">SYSDATE</span>()))/<span class="number">12</span> &gt; <span class="number">10</span>;	</div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">TIMESTAMPDIFF</span>(<span class="keyword">DAY</span>,<span class="string">'2012-10-01'</span>,<span class="string">'2013-01-13'</span>); <span class="comment">-- 获取两日期之间天数</span></div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">DATEDIFF</span>(<span class="string">'2013-01-13'</span>,<span class="string">'2012-10-01'</span>) <span class="keyword">FROM</span> dual; <span class="comment">-- 获取两日期之间天数</span></div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">TIMESTAMPDIFF</span>(<span class="keyword">MONTH</span>,<span class="string">'2012-10-01'</span>,<span class="string">'2013-01-13'</span>); <span class="comment">-- 获取两日期月数</span></div></pre></td></tr></table></figure>
<h1 id="EXISTS和IN"><a href="#EXISTS和IN" class="headerlink" title="EXISTS和IN"></a>EXISTS和IN</h1><p>效率差<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span></div><div class="line">	<span class="number">1</span></div><div class="line"><span class="keyword">FROM</span></div><div class="line">	tp_parcel_info f</div><div class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> tp_station_info s <span class="keyword">ON</span> s.f_station_id = f.f_station_id</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">	<span class="number">1</span> = <span class="number">1</span></div><div class="line"><span class="keyword">AND</span> f.f_parcel_status <span class="keyword">IN</span> (<span class="number">0</span>)</div><div class="line"><span class="keyword">AND</span> f.f_last_time &gt;= <span class="string">'20160901000000'</span></div><div class="line"><span class="keyword">AND</span> f.f_last_time &lt;= <span class="string">'20161131235959'</span></div><div class="line"><span class="keyword">AND</span> f.f_company_id = <span class="string">'108'</span></div><div class="line"><span class="keyword">AND</span> <span class="keyword">EXISTS</span> (</div><div class="line">	<span class="keyword">SELECT</span></div><div class="line">		<span class="number">1</span></div><div class="line">	<span class="keyword">FROM</span></div><div class="line">		tp_express_branch_com_dz d</div><div class="line">	<span class="keyword">WHERE</span></div><div class="line">		d.f_exp_id = <span class="string">'2729'</span></div><div class="line">	<span class="keyword">AND</span> f.f_station_id = d.f_station_id</div><div class="line">	<span class="keyword">AND</span> d.f_branch_state = <span class="number">0</span></div><div class="line">)</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></div><div class="line">	f.f_last_time <span class="keyword">DESC</span></div></pre></td></tr></table></figure></p>
<p>效率高<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span></div><div class="line">	f.f_parcel_id,</div><div class="line">	f.f_exp_id,</div><div class="line">	f.f_branch_id,</div><div class="line">	f.f_station_id,</div><div class="line">	f.f_mail_no,</div><div class="line">	f.f_company_id,</div><div class="line">	f.f_company_name,</div><div class="line">	f.f_recipient_name,</div><div class="line">	f.f_recipient_mobile,</div><div class="line">	f.f_frame_code,</div><div class="line">	f.f_take_code,</div><div class="line">	f.f_num,</div><div class="line">	f.f_input_way,</div><div class="line">	f.f_input_source,</div><div class="line">	f.f_arrive_time,</div><div class="line">	f.f_parcel_status,</div><div class="line">	f.f_is_detention,</div><div class="line">	f.f_out_way,</div><div class="line">	f.f_out_source,</div><div class="line">	f.f_app_notice_status,</div><div class="line">	f.f_weixin_notice_status,</div><div class="line">	f.f_sms_notice_status,</div><div class="line">	f.f_out_time,</div><div class="line">	f.f_last_time,</div><div class="line">	f.f_type,</div><div class="line">	f.f_comment,</div><div class="line">	s.f_station_name</div><div class="line"><span class="keyword">FROM</span></div><div class="line">	tp_parcel_info f</div><div class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> tp_station_info s <span class="keyword">ON</span> s.f_station_id = f.f_station_id</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">	<span class="number">1</span> = <span class="number">1</span></div><div class="line"><span class="keyword">AND</span> f.f_parcel_status <span class="keyword">IN</span> (<span class="number">0</span>)</div><div class="line"><span class="keyword">AND</span> f.f_last_time &gt;= <span class="string">'20160901000000'</span></div><div class="line"><span class="keyword">AND</span> f.f_last_time &lt;= <span class="string">'20161131235959'</span></div><div class="line"><span class="keyword">AND</span> f.f_company_id = <span class="string">'108'</span></div><div class="line"><span class="keyword">AND</span> f.f_station_id <span class="keyword">IN</span> (</div><div class="line">	<span class="keyword">SELECT</span></div><div class="line">		d.f_station_id</div><div class="line">	<span class="keyword">FROM</span></div><div class="line">		tp_express_branch_com_dz d</div><div class="line">	<span class="keyword">WHERE</span></div><div class="line">		d.f_exp_id = <span class="string">'2729'</span></div><div class="line">	<span class="keyword">AND</span> d.f_branch_state = <span class="number">0</span></div><div class="line">)</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></div><div class="line">	f.f_last_time <span class="keyword">DESC</span></div></pre></td></tr></table></figure></p>
<blockquote>
<p>例如</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 例如：表A（小表），表B（大表）</span></div><div class="line"><span class="comment">-- 1：</span></div><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> A <span class="keyword">where</span> cc <span class="keyword">in</span> (<span class="keyword">select</span> cc <span class="keyword">from</span> B)</div><div class="line"><span class="comment">-- 效率低，用到了A表上cc列的索引；</span></div><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> A <span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> cc <span class="keyword">from</span> B <span class="keyword">where</span> cc=A.cc)</div><div class="line"><span class="comment">-- 效率高，用到了B表上cc列的索引。</span></div><div class="line"><span class="comment">-- 相反的</span></div><div class="line"><span class="comment">-- 2：</span></div><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> B <span class="keyword">where</span> cc <span class="keyword">in</span> (<span class="keyword">select</span> cc <span class="keyword">from</span> A)</div><div class="line"><span class="comment">-- 效率高，用到了B表上cc列的索引；</span></div><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> B <span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> cc <span class="keyword">from</span> A <span class="keyword">where</span> cc=B.cc)</div><div class="line"><span class="comment">-- 效率低，用到了A表上cc列的索引。</span></div></pre></td></tr></table></figure>
<blockquote>
<p>总结    </p>
</blockquote>
<font color="#FF0000" face="Menlo">in是把外表和内表作hash连接，而exists是对外表作loop循环，每次loop循环再对内表进行查询，一直以来认为exists比in效率高的说法是不准确的。如果查询的两个表大小相当，那么用in和exists差别不大；如果两个表中一个较小一个较大，则子查询表大的用exists(大表)，子查询表小的用in(小表);<br>跟显示字段的多少没有太大区别。<br></font>

<h3 id="类型长度"><a href="#类型长度" class="headerlink" title="类型长度"></a>类型长度</h3><p>int和bigint超限会改变值<br>char和varchar超限会截取值</p>
<h3 id="win配置mysql"><a href="#win配置mysql" class="headerlink" title="win配置mysql"></a>win配置mysql</h3><h4 id="解压mysql-5-7-17-winx64-zip配置环境变量"><a href="#解压mysql-5-7-17-winx64-zip配置环境变量" class="headerlink" title="解压mysql-5.7.17-winx64.zip配置环境变量"></a>解压mysql-5.7.17-winx64.zip配置环境变量</h4><p>新增编辑用户变量：<br>    MYSQL_HOME<br>    C:\mysql\mysql-5.7.17-winx64<br>在编辑系统变量中path变量新增%MYSQL_HOME%\bin;</p>
<h4 id="初始化和配置"><a href="#初始化和配置" class="headerlink" title="初始化和配置"></a>初始化和配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C:\mysql\mysql-5.7.17-winx64\bin&gt;mysqld  --initialize</div></pre></td></tr></table></figure>
<p>增加服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C:\mysql\mysql-5.7.17-winx64\bin&gt;mysqld -install</div></pre></td></tr></table></figure></p>
<p>启动停止服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">C:\Users\Administrator&gt;net stop mysql</div><div class="line">MySQL 服务正在停止.</div><div class="line">MySQL 服务已成功停止。</div><div class="line"></div><div class="line">C:\Users\Administrator&gt;net start mysql</div><div class="line">MySQL 服务正在启动 .</div><div class="line">MySQL 服务已经启动成功。</div></pre></td></tr></table></figure></p>
<h4 id="查看版本号"><a href="#查看版本号" class="headerlink" title="查看版本号"></a>查看版本号</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\Administrator&gt;mysql -V</div><div class="line">mysql  Ver 14.14 Distrib 5.5.40, for Win64 (x86)</div></pre></td></tr></table></figure>
<p>配置my.ini文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"># For advice on how to change settings please see</div><div class="line"># http://dev.mysql.com/doc/refman/5.6/en/server-configuration-defaults.html</div><div class="line"># *** DO NOT EDIT THIS FILE. It&apos;s a template which will be copied to the</div><div class="line"># *** default location during install, and will be replaced if you</div><div class="line"># *** upgrade to a newer version of MySQL.</div><div class="line"></div><div class="line">[mysqld]</div><div class="line">#绑定IPv4和3306端口</div><div class="line">bind-address = 192.168.1.15</div><div class="line">port = 3306</div><div class="line">log_bin</div><div class="line"># 允许最大连接数</div><div class="line">max_connections = 200</div><div class="line">basedir = C:\mysql\mysql-5.7.17-winx64</div><div class="line">datadir = C:\mysql\mysql-5.7.17-winx64\data</div><div class="line">port = 3306</div><div class="line">server_id = 15</div><div class="line">#设置字符集为utf8  </div><div class="line">loose-default-character-set = utf8</div><div class="line"># join_buffer_size = 128M</div><div class="line"># sort_buffer_size = 2M</div><div class="line"># read_rnd_buffer_size = 2M </div><div class="line">[client]  </div><div class="line">#设置客户端字符集  </div><div class="line">loose-default-character-set = utf8  </div><div class="line"></div><div class="line">[WinMySQLadmin]  </div><div class="line">Server = C:\mysql\mysql-5.7.17-winx64\bin\mysqld.exe</div></pre></td></tr></table></figure></p>
<h3 id="分表"><a href="#分表" class="headerlink" title="分表"></a>分表</h3><p>参考地址：<br><a href="http://www.cnblogs.com/miketwais/articles/mysql_partition.html" target="_blank" rel="external">http://www.cnblogs.com/miketwais/articles/mysql_partition.html</a><br><a href="http://blog.csdn.net/shandalue/article/details/52035040" target="_blank" rel="external">http://blog.csdn.net/shandalue/article/details/52035040</a></p>
<p>哪些引擎可以分表？</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Notes]]></title>
      <url>https://volc1605.github.io/2016/11/01/notes/</url>
      <content type="html"><![CDATA[<h1 id="1-查看端口号并关闭相关进程"><a href="#1-查看端口号并关闭相关进程" class="headerlink" title="1.查看端口号并关闭相关进程"></a>1.查看端口号并关闭相关进程</h1><blockquote>
<p>1.查看端口占用</p>
</blockquote>
<p>在windows命令行窗口下执行：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">netstat -aon|findstr &quot;8080&quot;</div><div class="line">TCP     127.0.0.1:80         0.0.0.0:0               LISTENING       2448</div></pre></td></tr></table></figure>
<p>端口“8080”被PID（进程号）为2448的进程占用。<br>查看端口“8080”被哪个应用占用，，继续执行下面命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tasklist|findstr &quot;2448&quot;</div><div class="line">notepad.exe                     2016 Console                 0     16,064 K</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<blockquote>
<p>2.关闭进程</p>
</blockquote>
<p>2.1 按进程号关闭进程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">taskkill /pid 2152</div></pre></td></tr></table></figure>
<p>多个时格式为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">taskkill /pid 2152 /pid 1284</div></pre></td></tr></table></figure></p>
<p>2.2 按进程名关闭进程</p>
<p>如要关闭notepad.exe,格式为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">taskkill /im notepad.exe</div></pre></td></tr></table></figure>
<p>指定多个时格式为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">taskkill /im notepad.exe /im iexplorer.exe</div></pre></td></tr></table></figure></p>
<p>如果是要关闭所有的,则使用通配符*,即：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">taskkill /im *.exe</div></pre></td></tr></table></figure></p>
<p>2.3 有提示的关闭进程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">taskkill /t /im notepad.exe</div><div class="line">taskkill /t /pid 2152</div></pre></td></tr></table></figure>
<p>这个效果是提示后在使用者确定后关闭,有提示框。<br>2.4 强行终止进程<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">taskkill /f /im notepad.exe</div><div class="line">taskkill /f /pid 2152</div></pre></td></tr></table></figure></p>
<blockquote>
<p>3.端口状态</p>
</blockquote>
<p>3.1 LISTENING状态<br>FTP服务启动后首先处于侦听（LISTENING）状态。</p>
<p>3.2 ESTABLISHED状态<br>ESTABLISHED的意思是建立连接。表示两台机器正在通信。<br>3.3 CLOSE_WAIT<br>对方主动关闭连接或者网络异常导致连接中断，这时我方的状态会变成CLOSE_WAIT 此时我方要调用close()来使得连接正确关闭<br>3.4 TIME_WAIT<br>我方主动调用close()断开连接，收到对方确认后状态变为TIME_WAIT。TCP协议规定TIME_WAIT状态会一直持续2MSL(即两倍的分段最大生存期)，以此来确保旧的连接状态不会对新连接产生影响。处于TIME_WAIT状态的连接占用的资源不会被内核释放，所以作为服务器，在可能的情况下，尽量不要主动断开连接，以减少TIME_WAIT状态造成的资源浪费。<br>目前有一种避免TIME_WAIT资源浪费的方法，就是关闭socket的LINGER选项。但这种做法是TCP协议不推荐使用的，在某些情况下这个操作可能会带来错误。<br>3.5 SYN_SENT状态<br>SYN_SENT状态表示请求连接，当你要访问其它的计算机的服务时首先要发个同步信号给该端口，此时状态为SYN_SENT，如果连接成功了就变为ESTABLISHED，此时SYN_SENT状态非常短暂。但如果发现SYN_SENT非常多且在向不同的机器发出，那你的机器可能中了冲击波或震荡波之类的病毒了。这类病毒为了感染别的计算机，它就要扫描别的计算机，在扫描的过程中对每个要扫描的计算机都要发出了同步请求，这也是出现许多SYN_SENT的原因。</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[JS]]></title>
      <url>https://volc1605.github.io/2016/11/01/JS/</url>
      <content type="html"><![CDATA[<h1 id="1-windows对象setTimeOut-用于发送验证码倒计时"><a href="#1-windows对象setTimeOut-用于发送验证码倒计时" class="headerlink" title="1.windows对象setTimeOut()用于发送验证码倒计时"></a>1.windows对象setTimeOut()用于发送验证码倒计时</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">//短信验证码倒计时</div><div class="line">var wait = 30;</div><div class="line">function time(o) &#123;</div><div class="line">    if (wait == 0) &#123;</div><div class="line">        o.removeAttribute(&quot;disabled&quot;);</div><div class="line">        o.innerHTML = &quot;发送短信验证码&quot;;</div><div class="line">        wait = 30;</div><div class="line">    &#125; else &#123;</div><div class="line">        o.setAttribute(&quot;disabled&quot;, true);  </div><div class="line">        o.innerHTML = &quot;重新发送(&quot; + wait + &quot;)&quot;;</div><div class="line"></div><div class="line">        wait--;  </div><div class="line">        setTimeout(function()&#123;time(o)&#125;, 2)</div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="2-bind-this-用法"><a href="#2-bind-this-用法" class="headerlink" title="2.bind(this)用法"></a>2.bind(this)用法</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">//设立一个简单地对象作为“上下文”</div><div class="line"> var context = &#123; foo: &quot;bar&quot; &#125;;</div><div class="line"></div><div class="line"> //一个在this上下文中指向foo变量的函数</div><div class="line"> function returnFoo () &#123;</div><div class="line">   return this.foo;</div><div class="line"> &#125;</div><div class="line"></div><div class="line"> // 变量在作用域中不存在，因此显示undefined</div><div class="line"> returnFoo(); // =&gt; undefined</div><div class="line"></div><div class="line"> // 如果我们把它绑定在context上下文中</div><div class="line"> var bound = returnFoo.bind(context);</div><div class="line"></div><div class="line"> // 现在的作用域中有这个变量了</div><div class="line"> bound(); // =&gt; &quot;bar&quot;</div></pre></td></tr></table></figure>
<h1 id="js传数组给html"><a href="#js传数组给html" class="headerlink" title="js传数组给html"></a>js传数组给html</h1><p>JS<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> servicePlanList = <span class="built_in">JSON</span>.stringify(canFee);  <span class="comment">// canFee数组</span></div><div class="line"><span class="keyword">this</span>.assign(<span class="string">'servicePlanList'</span>, servicePlanList);</div></pre></td></tr></table></figure></p>
<p>html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">INPUT</span> <span class="attr">ID</span>=<span class="string">"servicePlanList"</span> <span class="attr">NAME</span>=<span class="string">"servicePlanListName"</span> <span class="attr">TYPE</span>=<span class="string">"hidden"</span></span></div><div class="line">  <span class="attr">VALUE</span>=<span class="string">"&lt;?=servicePlanList?&gt;"</span>&gt;<span class="tag">&lt;/<span class="name">INPUT</span>&gt;</span> value的值” [</div><div class="line">&#123;"fState":"1","managerId":123,"serviceFeeId":"5b7627c5ec8d4b96abae3996255f1034","serviceFeeMin":34,"serviceFeeName":"KGKGKA134","serviceFeePer":"12","serviceFeeStart":23,"type":1&#125;,</div><div class="line">&#123;"fState":"1","managerId":123,"serviceFeeId":"5a1248caf9334d77ab04f6a1df68b542","serviceFeeMin":20,"serviceFeeName":"KGKGKA13","serviceFeePer":"12","serviceFeeStart":23,"type":1&#125;]</div><div class="line">”</div><div class="line"><span class="tag">&lt;<span class="name">SCRIPT</span>&gt;</span><span class="javascript"></span></div><div class="line">                        <span class="keyword">var</span> servicePlanList = $(<span class="string">'#servicePlanList'</span>).val();</div><div class="line">servicePlanList = <span class="built_in">eval</span>(<span class="string">"("</span> + servicePlanList +<span class="string">")"</span>); <span class="comment">// eval()语言</span></div><div class="line"><span class="tag">&lt;/<span class="name">SCRIPT</span>&gt;</span></div></pre></td></tr></table></figure>
<h1 id="解决服务器上容器传参到jsp页面出现乱码问题"><a href="#解决服务器上容器传参到jsp页面出现乱码问题" class="headerlink" title="解决服务器上容器传参到jsp页面出现乱码问题"></a>解决服务器上容器传参到jsp页面出现乱码问题</h1><blockquote>
<p>jsp页面需要使用两次encodeURI进行编码处理<br>encodeURI(encodeURI(‘中文’));</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[HTML]]></title>
      <url>https://volc1605.github.io/2016/10/18/HTML/</url>
      <content type="html"><![CDATA[<h1 id="1-input中autocomplete"><a href="#1-input中autocomplete" class="headerlink" title="1.input中autocomplete"></a>1.input中autocomplete</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- autocomplete：为on时返回页面时，input中的值仍然存在 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"user_phone"</span> <span class="attr">id</span>=<span class="string">"user_phone"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control required"</span>   <span class="attr">autocomplete</span>=<span class="string">"off"</span> <span class="attr">placeholder</span>=<span class="string">"请填写您注册的手机号码(登录账号)"</span> <span class="attr">required</span> /&gt;</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="2-UEditor使用注意事项"><a href="#2-UEditor使用注意事项" class="headerlink" title="2.UEditor使用注意事项"></a>2.UEditor使用注意事项</h1><h2 id="2-1引入UEditor和回显图片"><a href="#2-1引入UEditor和回显图片" class="headerlink" title="2.1引入UEditor和回显图片"></a>2.1引入UEditor和回显图片</h2><ul>
<li>jsp页面引用：</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 文档编辑器 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span></span></div><div class="line">	<span class="attr">src</span>=<span class="string">"$&#123;contextPath&#125;/resource/scripts/ueditor/ueditor.config.js"</span>&gt;<span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span></span></div><div class="line">	<span class="attr">src</span>=<span class="string">"$&#123;contextPath&#125;/resource/scripts/ueditor/ueditor.all.min.js"</span>&gt;<span class="undefined"></span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span></span></div><div class="line">	<span class="attr">src</span>=<span class="string">"$&#123;contextPath&#125;/resource/scripts/ueditor/lang/zh-cn/zh-cn.js"</span>&gt;<span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">	<span class="built_in">window</span>.UEDITOR_HOME_URL = <span class="string">"$&#123;contextPath&#125;/resource/scripts/ueditor/"</span>;</div><div class="line">	<span class="keyword">var</span> ue = UE.getEditor(<span class="string">'editor'</span>);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">h5</span>&gt;</span>&amp;nbsp;&amp;nbsp;静态页面内容：<span class="tag">&lt;/<span class="name">h5</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">"editor"</span> <span class="attr">name</span>=<span class="string">"fContent"</span></span></div><div class="line">	<span class="attr">style</span>=<span class="string">"width: 1500px; height: 400px"</span> <span class="attr">data-options</span>=<span class="string">"required:true"</span>&gt;<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>ueditor.config.js配置</li>
</ul>
<p><img src="https://volc1605.github.io/images/html/ueditorConfig.png" alt="ueditorConfig"></p>
<ul>
<li>config.json配置</li>
</ul>
<p><img src="https://volc1605.github.io/images/html/configJson.png" alt="configJson"></p>
<hr>
<h2 id="2-2设置获取ueditor内容"><a href="#2-2设置获取ueditor内容" class="headerlink" title="2.2设置获取ueditor内容"></a>2.2设置获取ueditor内容</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//判断ueditor 编辑器是否创建成功并设置文本内容</span></div><div class="line">ue.addListener(<span class="string">"ready"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">ue.setContent(staticPage.fContent);</div><div class="line">ue.setContent(<span class="string">'hello'</span>);</div><div class="line"><span class="keyword">var</span> html = ue.getContent();</div><div class="line"><span class="keyword">var</span> txt = ue.getContentTxt();</div><div class="line">  alert(txt);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h1 id="3-输入框对齐"><a href="#3-输入框对齐" class="headerlink" title="3.输入框对齐"></a>3.输入框对齐</h1><blockquote>
<p>方式一：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dl</span> <span class="attr">style</span>=<span class="string">"width:253px;float:left"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">dt</span> <span class="attr">style</span>=<span class="string">"width:50px;float:left"</span>&gt;</span>站点名称<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">dd</span> <span class="attr">style</span>=<span class="string">"width:200px;float:left"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"stationName"</span> <span class="attr">id</span>=<span class="string">"stationName"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">dt</span> <span class="attr">style</span>=<span class="string">"width:50px;float:left"</span>&gt;</span>手机号<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">dd</span> <span class="attr">style</span>=<span class="string">"width:200px;float:left"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"tel"</span> <span class="attr">id</span>=<span class="string">"tel"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>方式二：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">'spanId'</span> <span class="attr">style</span>=<span class="string">"width:200px;float:left;"</span>&gt;</span></div><div class="line">			标签121231：</div><div class="line">		<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">'spanId2'</span> <span class="attr">style</span>=<span class="string">"width:200px;float:left;"</span>&gt;</span></div><div class="line">			标签：</div><div class="line">		<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>方式三：</p>
</blockquote>
<p>放入加入style样式table中</p>
<h1 id="失去焦点事件"><a href="#失去焦点事件" class="headerlink" title="失去焦点事件"></a>失去焦点事件</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">onblur=”validate(this, 0)”</div><div class="line">validate: function(item, index) &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Java]]></title>
      <url>https://volc1605.github.io/2016/10/18/Java/</url>
      <content type="html"><![CDATA[<h1 id="1-生成pdf文件"><a href="#1-生成pdf文件" class="headerlink" title="1.生成pdf文件"></a>1.生成pdf文件</h1><p>导包：</p>
<ul>
<li>D:\java-tools\apache-maven-3.2.3\repo\com\itextpdf\itextpdf\5.4.3\itextpdf-5.4.3.jar</li>
<li>D:\java-tools\apache-maven-3.2.3\repo\com\itextpdf\itext-asian\5.2.0\itext-asian-5.2.0.jar</li>
</ul>
<p>ReviewInvocation.java<br><a id="more"></a><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">@Component</span>(<span class="string">"INVO_review"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReviewInvocation</span> <span class="keyword">implements</span> <span class="title">BaseInvocation</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(ReviewInvocation.class);</div><div class="line"></div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    <span class="keyword">private</span> IReviewService reviewService;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> InvocationResult <span class="title">queryReviewList</span><span class="params">(InvocationContext context)</span> </span>&#123;</div><div class="line">	<span class="keyword">long</span> begin = System.currentTimeMillis();</div><div class="line">	InvocationResult result = InvocationResult.newInstance();</div><div class="line">	String userNameSearch = RequestUtil.getStrParamterAsDef(context.getRequest(), <span class="string">"userNameSearch"</span>, <span class="string">""</span>);</div><div class="line">	String reviewTimeSearch = RequestUtil.getStrParamterAsDef(context.getRequest(), <span class="string">"reviewTimeSearch"</span>, <span class="string">""</span>);</div><div class="line">	String fUserMobile = RequestUtil.getStrParamterAsDef(context.getRequest(), <span class="string">"fUserMobile"</span>, <span class="string">""</span>);</div><div class="line">	<span class="keyword">int</span> page = RequestUtil.getIntParamterAsDef(context.getRequest(), <span class="string">"page"</span>, <span class="number">1</span>);</div><div class="line">	<span class="keyword">int</span> rows = RequestUtil.getIntParamterAsDef(context.getRequest(), <span class="string">"rows"</span>, <span class="number">0</span>);</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">	    ReviewBean queryBean = <span class="keyword">new</span> ReviewBean();</div><div class="line">	    queryBean.setReviewTime(reviewTimeSearch);</div><div class="line">	    queryBean.setUserName(userNameSearch);</div><div class="line">	    queryBean.setfUserMobile(fUserMobile);</div><div class="line">	    Map&lt;String, Object&gt; queryMap = reviewService.queryReviewList(queryBean, page, rows);</div><div class="line">	    result.setRetObj(queryMap);</div><div class="line">	    result.setA(ISystemConstants.SYS_SUCCESS);</div><div class="line">	&#125; <span class="keyword">catch</span> (Exception ex) &#123;</div><div class="line">	    logger.error(<span class="string">"ReviewInvocation queryReviewList happen execption."</span>, ex);</div><div class="line">	    result.setRetCode(ISystemConstants.SYS_FAILED);</div><div class="line">	&#125; <span class="keyword">finally</span> &#123;</div><div class="line">	    <span class="keyword">long</span> end = System.currentTimeMillis();</div><div class="line">	    logger.info(<span class="string">"ReviewInvocation queryReviewList cost "</span> + (end - begin) + <span class="string">" ms!"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> InvocationResult <span class="title">queryReviewById</span><span class="params">(InvocationContext context)</span> </span>&#123;</div><div class="line">	<span class="keyword">long</span> begin = System.currentTimeMillis();</div><div class="line">	InvocationResult result = InvocationResult.newInstance();</div><div class="line">	String reviewId = RequestUtil.getStrParamterAsDef(context.getRequest(), <span class="string">"reviewId"</span>, <span class="string">""</span>);</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">	    ReviewBean reviewBean = reviewService.queryReviewById(reviewId);</div><div class="line">	    result.setRetObj(reviewBean);</div><div class="line">	    result.setA(ISystemConstants.SYS_SUCCESS);</div><div class="line">	&#125; <span class="keyword">catch</span> (Exception ex) &#123;</div><div class="line">	    logger.error(<span class="string">"ReviewInvocation queryReviewList happen execption."</span>, ex);</div><div class="line">	    result.setRetCode(ISystemConstants.SYS_FAILED);</div><div class="line">	&#125; <span class="keyword">finally</span> &#123;</div><div class="line">	    <span class="keyword">long</span> end = System.currentTimeMillis();</div><div class="line">	    logger.info(<span class="string">"ReviewInvocation queryReviewList cost "</span> + (end - begin) + <span class="string">" ms!"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> InvocationResult <span class="title">updateReview</span><span class="params">(InvocationContext context)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">	<span class="keyword">long</span> begin = System.currentTimeMillis();</div><div class="line">	InvocationResult result = InvocationResult.newInstance();</div><div class="line">	String reviewId = RequestUtil.getStrParamterAsDef(context.getRequest(), <span class="string">"reviewId"</span>, <span class="string">""</span>);</div><div class="line">	String desc = RequestUtil.getStrParamterAsDef(context.getRequest(), <span class="string">"desc"</span>, <span class="string">""</span>);</div><div class="line">	String combo = RequestUtil.getStrParamterAsDef(context.getRequest(), <span class="string">"combo"</span>, <span class="string">""</span>);</div><div class="line">	String handleType = RequestUtil.getStrParamterAsDef(context.getRequest(), <span class="string">"handleType"</span>, <span class="string">""</span>);</div><div class="line">	String userId = RequestUtil.getStrParamterAsDef(context.getRequest(), <span class="string">"userId"</span>, <span class="string">""</span>);</div><div class="line">	ReviewBean reviewBean2 = <span class="keyword">new</span> ReviewBean();</div><div class="line">	String contractContent = <span class="string">""</span>;</div><div class="line">	<span class="keyword">if</span> (<span class="string">"1"</span>.equals(handleType)) &#123;</div><div class="line">	    <span class="comment">// 批量替换异花括号(包含)中的内容，'&#123;name&#125;'为'zhangsan'</span></div><div class="line">	    HashMap&lt;String, Object&gt; param = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</div><div class="line">	    Map&lt;String, String&gt; tokens = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">	    param.put(<span class="string">"fContractId"</span>, <span class="string">"1"</span>);</div><div class="line">	    param.put(<span class="string">"fContractType"</span>, <span class="string">"1"</span>);</div><div class="line">	    ReviewBean reviewBeanTemp = reviewService.queryContractContent(param);</div><div class="line">	    contractContent = reviewBeanTemp.getfContractContent();</div><div class="line">	    ReviewBean reviewBean = reviewService.queryReviewById(reviewId);</div><div class="line">	    String userName = reviewBean.getUserName();</div><div class="line">	    String idNo = reviewBean.getIdNo();</div><div class="line">	    String provinceName = reviewBean.getProvinceName();</div><div class="line">	    String city = reviewBean.getCityName();</div><div class="line">	    String areaName = reviewBean.getAreaName();</div><div class="line">	    <span class="keyword">if</span> (userName != <span class="keyword">null</span> &amp;&amp; userName != <span class="string">""</span>) &#123;</div><div class="line">		tokens.put(<span class="string">"name"</span>, userName);</div><div class="line">	    &#125;</div><div class="line">	    <span class="keyword">if</span> (idNo != <span class="keyword">null</span> &amp;&amp; idNo != <span class="string">""</span>) &#123;</div><div class="line">		tokens.put(<span class="string">"id"</span>, idNo);</div><div class="line">	    &#125;</div><div class="line">	    <span class="keyword">if</span> (provinceName != <span class="keyword">null</span> &amp;&amp; provinceName != <span class="string">""</span>) &#123;</div><div class="line">		tokens.put(<span class="string">"province"</span>, provinceName);</div><div class="line">	    &#125;</div><div class="line">	    <span class="keyword">if</span> (city != <span class="keyword">null</span> &amp;&amp; city != <span class="string">""</span>) &#123;</div><div class="line">		city = city.substring(<span class="number">0</span>, city.length() - <span class="number">1</span>);</div><div class="line">		tokens.put(<span class="string">"city"</span>, city);</div><div class="line">	    &#125;</div><div class="line">	    <span class="keyword">if</span> (areaName != <span class="keyword">null</span> &amp;&amp; areaName != <span class="string">""</span>) &#123;</div><div class="line">		tokens.put(<span class="string">"area"</span>, areaName);</div><div class="line">	    &#125;</div><div class="line">	    String todayYear = DateTimeUtil.getTodayYear();</div><div class="line">	    String todayMonth = DateTimeUtil.getTodayMonth();</div><div class="line">	    String todayDay = DateTimeUtil.getTodayDay();</div><div class="line">	    tokens.put(<span class="string">"year"</span>, todayYear);</div><div class="line">	    tokens.put(<span class="string">"mon"</span>, todayMonth);</div><div class="line">	    tokens.put(<span class="string">"day"</span>, todayDay);</div><div class="line">	    tokens.put(<span class="string">"nyear"</span>, Integer.parseInt(todayYear) + <span class="number">1</span> + <span class="string">""</span>);</div><div class="line">	    tokens.put(<span class="string">"nmon"</span>, todayMonth);</div><div class="line">	    tokens.put(<span class="string">"nday"</span>, todayDay);</div><div class="line">	    String patternString = <span class="string">"\\&#123;("</span> + StringUtils.join(tokens.keySet(), <span class="string">"|"</span>) + <span class="string">")\\&#125;"</span>;</div><div class="line">	    Pattern pattern = Pattern.compile(patternString);</div><div class="line">	    Matcher matcher = pattern.matcher(contractContent);</div><div class="line">	    StringBuffer sb = <span class="keyword">new</span> StringBuffer();</div><div class="line">	    <span class="keyword">while</span> (matcher.find()) &#123;</div><div class="line">		matcher.appendReplacement(sb, tokens.get(matcher.group(<span class="number">1</span>)));</div><div class="line">	    &#125;</div><div class="line">	    matcher.appendTail(sb);</div><div class="line">	    <span class="comment">// 替换后协议内容</span></div><div class="line">	    contractContent = sb.toString();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">	    <span class="keyword">if</span> (<span class="string">"1"</span>.equals(handleType)) &#123;</div><div class="line">		SystemUserInfoBean userInfo = (SystemUserInfoBean) SessionUtil.getObjectAttribute(context.getRequest(),</div><div class="line">			RequestConstants.ADMIN_SESSION_KEY);</div><div class="line">		reviewService.updateReview(userId, reviewId, desc, combo, handleType,</div><div class="line">			userInfo != <span class="keyword">null</span> &amp;&amp; userInfo.getfUserName() != <span class="keyword">null</span> &amp;&amp; !<span class="string">""</span>.equals(userInfo.getfUserName())</div><div class="line">				? userInfo.getfUserName() : <span class="string">"system"</span>);</div><div class="line">		ReviewBean reviewBeanById = reviewService.queryReviewById(reviewId);</div><div class="line">		String state = reviewBeanById.getState();</div><div class="line">		String fStationId = reviewBeanById.getfStationId();</div><div class="line">		<span class="keyword">if</span> (<span class="string">"1"</span>.equals(state)) &#123;</div><div class="line">		    getPdf(contractContent);</div><div class="line">		    String pdfName = addPic();</div><div class="line">		    Map&lt;String, Object&gt; param = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</div><div class="line">		    <span class="comment">// pdf访问路径</span></div><div class="line">		    String fContractUrl = BaseWebProperties.PDF_READ + File.separator + pdfName + <span class="string">".pdf"</span>;</div><div class="line">		    param.put(<span class="string">"fStationId"</span>, fStationId);</div><div class="line">		    param.put(<span class="string">"fContractUrl"</span>, fContractUrl);</div><div class="line">		    reviewService.addContractInfo(param);</div><div class="line">		&#125;</div><div class="line">		reviewBean2.setfContractContent(contractContent);</div><div class="line">		result.setD(reviewBean2);</div><div class="line">		result.setA(ISystemConstants.SYS_SUCCESS);</div><div class="line">	    &#125;</div><div class="line">	&#125; <span class="keyword">catch</span> (Exception ex) &#123;</div><div class="line">	    logger.error(<span class="string">"ReviewInvocation updateReview happen execption."</span>, ex);</div><div class="line">	    result.setRetCode(ISystemConstants.SYS_FAILED);</div><div class="line">	&#125; <span class="keyword">finally</span> &#123;</div><div class="line">	    <span class="keyword">long</span> end = System.currentTimeMillis();</div><div class="line">	    logger.info(<span class="string">"ReviewInvocation updateReview cost "</span> + (end - begin) + <span class="string">" ms!"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 创建</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getPdf</span><span class="params">(String contractContent)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">	Document document = <span class="keyword">new</span> Document(PageSize.A4, <span class="number">50</span>, <span class="number">50</span>, <span class="number">50</span>, <span class="number">50</span>);</div><div class="line">	String pdfN = <span class="string">"cachePdf"</span>;</div><div class="line">	File file = <span class="keyword">new</span> File(BaseWebProperties.UPLOAD_PDF_PATH + File.separator + pdfN + <span class="string">".pdf"</span>);</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">	    PdfWriter.getInstance(document, <span class="keyword">new</span> FileOutputStream(file));</div><div class="line">	    document.open();</div><div class="line">	    BaseFont bf = BaseFont.createFont(<span class="string">"STSong-Light"</span>, <span class="string">"UniGB-UCS2-H"</span>, BaseFont.NOT_EMBEDDED);</div><div class="line">	    Font font = <span class="keyword">new</span> Font(bf, <span class="number">12</span>, Font.NORMAL);</div><div class="line">	    Image png = Image.getInstance(BaseWebProperties.PIC_READ + File.separator + <span class="string">"title.png"</span>);</div><div class="line">	    png.scaleAbsolute(<span class="number">540</span>, <span class="number">70</span>);</div><div class="line">	    png.setAlignment(Image.ALIGN_CENTER);</div><div class="line">	    document.add(png);</div><div class="line">	    document.add(<span class="keyword">new</span> Paragraph(contractContent, font));</div><div class="line">	    document.close();</div><div class="line">	&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">	    e.printStackTrace();</div><div class="line">	&#125; <span class="keyword">catch</span> (DocumentException e) &#123;</div><div class="line">	    e.printStackTrace();</div><div class="line">	&#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 追加图片到pdf</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addPic</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">	PdfReader reader = <span class="keyword">new</span> PdfReader(BaseWebProperties.PDF_READ + File.separator + <span class="string">"cachePdf.pdf"</span>);</div><div class="line">	<span class="keyword">int</span> n = reader.getNumberOfPages();</div><div class="line">	Document document = <span class="keyword">new</span> Document(reader.getPageSize(n));</div><div class="line">	<span class="keyword">float</span> width = document.getPageSize().getWidth();</div><div class="line">	String pdfName = DateTimeUtil.getTodayChar14();</div><div class="line">	File file = <span class="keyword">new</span> File(BaseWebProperties.UPLOAD_PDF_PATH + File.separator + pdfName + <span class="string">".pdf"</span>);</div><div class="line">	PdfStamper stamp = <span class="keyword">new</span> PdfStamper(reader, <span class="keyword">new</span> FileOutputStream(file));</div><div class="line">	PdfContentByte over;</div><div class="line">	Image img = Image.getInstance(BaseWebProperties.PIC_READ + File.separator + <span class="string">"sign1.PNG"</span>);</div><div class="line">	img.scaleAbsolute(<span class="number">110</span>, <span class="number">110</span>);</div><div class="line">	img.setAbsolutePosition(width - <span class="number">150</span>, <span class="number">350</span>);</div><div class="line">	img.setAlignment(Image.ALIGN_RIGHT);</div><div class="line">	<span class="keyword">if</span> (n &gt; <span class="number">0</span>) &#123;</div><div class="line">	    over = stamp.getOverContent(n);</div><div class="line">	    over.addImage(img);</div><div class="line">	&#125;</div><div class="line">	stamp.close();</div><div class="line">	File file2 = <span class="keyword">new</span> File(BaseWebProperties.UPLOAD_PDF_PATH + File.separator + <span class="string">"cachePdf.pdf"</span>);</div><div class="line">	<span class="keyword">if</span> (file2.exists()) &#123;</div><div class="line">	    file2.delete();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> pdfName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>正则表达式参考资源：<a href="http://jiangzhengjun.iteye.com/blog/513929" target="_blank" rel="external">http://jiangzhengjun.iteye.com/blog/513929</a><h1 id="2-Map排序"><a href="#2-Map排序" class="headerlink" title="2.Map排序"></a>2.Map排序</h1></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    Student student2 = <span class="keyword">new</span> Student(<span class="string">"b"</span>, <span class="string">"2"</span>);</div><div class="line">    Student student3 = <span class="keyword">new</span> Student(<span class="string">"c"</span>, <span class="string">"3"</span>);</div><div class="line">    Student student1 = <span class="keyword">new</span> Student(<span class="string">"a"</span>, <span class="string">"1"</span>);</div><div class="line">    TreeMap&lt;Integer, Object&gt; treeMap = <span class="keyword">new</span> TreeMap&lt;Integer, Object&gt;();<span class="comment">//true</span></div><div class="line">    treeMap.put(<span class="keyword">new</span> Integer(<span class="number">2</span>), student2);</div><div class="line">    treeMap.put(<span class="keyword">new</span> Integer(<span class="number">3</span>), student3);</div><div class="line">    treeMap.put(<span class="keyword">new</span> Integer(<span class="number">1</span>), student1);</div><div class="line">    <span class="comment">/**</span></div><div class="line">     *</div><div class="line">    Set&lt;String&gt; keySet = map.keySet();</div><div class="line">    for(String key : keySet)&#123;</div><div class="line">    	System.out.println("key:" + key + " | value:" + map.get(key));</div><div class="line">    &#125;</div><div class="line">     */</div><div class="line">    HashMap&lt;Integer, Object&gt; hashMap = <span class="keyword">new</span> HashMap&lt;Integer, Object&gt;();</div><div class="line">    hashMap.put(<span class="keyword">new</span> Integer(<span class="number">2</span>), student2);</div><div class="line">    hashMap.put(<span class="keyword">new</span> Integer(<span class="number">3</span>), student3);</div><div class="line">    hashMap.put(<span class="keyword">new</span> Integer(<span class="number">1</span>), student1);</div><div class="line">    <span class="comment">/**</span></div><div class="line">    Iterator&lt;Object&gt; iterator = map.values().iterator();//排序</div><div class="line">    while(iterator.hasNext())&#123;</div><div class="line">    	int value = (Integer)iterator.next();</div><div class="line">    	System.out.println(value);</div><div class="line">    &#125;</div><div class="line">     */</div><div class="line">    LinkedHashMap&lt;Integer, Object&gt; likedMap = <span class="keyword">new</span> LinkedHashMap&lt;Integer, Object&gt;();<span class="comment">//不排序</span></div><div class="line">    likedMap.put(<span class="keyword">new</span> Integer(<span class="number">2</span>), student2);</div><div class="line">    likedMap.put(<span class="keyword">new</span> Integer(<span class="number">3</span>), student3);</div><div class="line">    likedMap.put(<span class="keyword">new</span> Integer(<span class="number">1</span>), student1);</div><div class="line">    <span class="comment">/**</span></div><div class="line">    Set&lt;String&gt; keySet2 = map.keySet();</div><div class="line">    for(String key : keySet2)&#123;</div><div class="line">    	System.out.println("key:" + key + " | value:" + map.get(key));</div><div class="line">    &#125;</div><div class="line">     */</div><div class="line">    System.out.println(<span class="string">"down"</span>);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="3-JAVA代理"><a href="#3-JAVA代理" class="headerlink" title="3.JAVA代理"></a>3.JAVA代理</h1><h2 id="3-1简单代理"><a href="#3-1简单代理" class="headerlink" title="3.1简单代理"></a>3.1简单代理</h2><p>Subject.java接口<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bmx.omp.business.invocation.system;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Subject</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operation2</span><span class="params">(String arg)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>RealSubject.java实现类。被代理对象<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bmx.omp.business.invocation.system;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RealSubject</span> <span class="keyword">implements</span> <span class="title">Subject</span> </span>&#123;<span class="comment">//被代理对象</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span> </span>&#123;</div><div class="line">       System.out.println(<span class="string">"Realer do operation1"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation2</span><span class="params">(String arg)</span> </span>&#123;</div><div class="line">       System.out.println(<span class="string">"Realer do operation2 with "</span> + arg);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ProxySubject.java代理对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bmx.omp.business.invocation.system;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxySubject</span> <span class="keyword">implements</span> <span class="title">Subject</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Subject proxied;<span class="comment">// 被代理对象</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ProxySubject</span><span class="params">(Subject proxied)</span> </span>&#123;</div><div class="line">       <span class="keyword">this</span>.proxied = proxied;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation1</span><span class="params">()</span> </span>&#123;</div><div class="line">       System.out.println(<span class="string">"Proxyer do operation1"</span>);</div><div class="line">       proxied.operation1();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation2</span><span class="params">(String arg)</span> </span>&#123;</div><div class="line">       System.out.println(<span class="string">"Proxyer do operation2 with "</span> + arg);</div><div class="line">       proxied.operation2(arg);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>测试类SimpleProxyDemo.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.zj.proxy.client;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.zj.proxy.Subject;</div><div class="line"><span class="keyword">import</span> com.zj.proxy.RealSubject;</div><div class="line"><span class="keyword">import</span> com.zj.proxy.ProxySubject;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleProxyDemo</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">consumer</span><span class="params">(Subject subject)</span> </span>&#123;</div><div class="line">        subject.operation1();</div><div class="line">        subject.operation2(<span class="string">"ZJ"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        RealSubject real = <span class="keyword">new</span> RealSubject();</div><div class="line">        System.out.println(<span class="string">"===Without Proxy==="</span>);</div><div class="line">        consumer(real);</div><div class="line">        System.out.println(<span class="string">"===Use Proxy==="</span>);</div><div class="line">        consumer(<span class="keyword">new</span> ProxySubject(real));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>结果<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">结果：</div><div class="line">===Without Proxy===</div><div class="line">Realer do operation1</div><div class="line">Realer do operation2 with ZJ</div><div class="line">===Use Proxy===</div><div class="line">Proxyer do operation1</div><div class="line">Realer do operation1</div><div class="line">Proxyer do operation2 with ZJ</div><div class="line">Realer do operation2 with ZJ</div></pre></td></tr></table></figure></p>
<h2 id="3-2动态代理"><a href="#3-2动态代理" class="headerlink" title="3.2动态代理"></a>3.2动态代理</h2><p>DynamicProxyHandler.java代理处理类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.omp.business.invocation.system;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</div><div class="line"><span class="keyword">import</span> java.lang.reflect.Method;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@ClassName</span> DynamicProxyHandler</div><div class="line"> * <span class="doctag">@Description</span> 动态代理处理类</div><div class="line"> * <span class="doctag">@Author</span> youtanzhi</div><div class="line"> * <span class="doctag">@Date</span> 2016年8月23日 下午7:01:55</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicProxyHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;<span class="comment">// 动态代理处理类</span></div><div class="line">  <span class="keyword">private</span> Object proxied;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">DynamicProxyHandler</span><span class="params">(Object RealSubject)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.proxied = RealSubject;<span class="comment">//生成代理对象</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">    System.out.println(<span class="string">"**** proxy: ****\n"</span> + proxy.getClass() + <span class="string">"\nmethod: "</span> + method + <span class="string">"\nargs: "</span> + args);</div><div class="line">    <span class="keyword">if</span> (args != <span class="keyword">null</span>) &#123;</div><div class="line">      <span class="keyword">for</span> (Object arg : args) &#123;</div><div class="line">        System.out.println(<span class="string">"  "</span> + arg);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> method.invoke(proxied, args);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>动态代理测试类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.omp.business.invocation.system;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@ClassName</span> DynamicProxyDemo</div><div class="line"> * <span class="doctag">@Description</span> 动态代理测试类</div><div class="line"> * <span class="doctag">@Author</span> youtanzhi</div><div class="line"> * <span class="doctag">@Date</span> 2016年8月23日 下午7:24:19</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicProxyDemo</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">consumer</span><span class="params">(Subject subject)</span> </span>&#123;</div><div class="line">        subject.operation1();<span class="comment">//执行被代理对象调用的方法时，先执行代理对象的invoke方法</span></div><div class="line">        subject.operation2(<span class="string">"ZJ"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        RealSubject real = <span class="keyword">new</span> RealSubject();</div><div class="line">        System.out.println(<span class="string">"===Without Proxy==="</span>);</div><div class="line">        consumer(real);</div><div class="line">        System.out.println(<span class="string">"===Use Proxy==="</span>);</div><div class="line">        Subject proxy = (Subject) Proxy.newProxyInstance(<span class="comment">//三个参数</span></div><div class="line">                            Subject.class.getClassLoader(), <span class="comment">// 被代理对象类加载器</span></div><div class="line">                            <span class="keyword">new</span> Class[] &#123;Subject.class&#125;, <span class="comment">// 代理类要实现的接口字节码列表(数组)</span></div><div class="line">                            <span class="keyword">new</span> DynamicProxyHandler(real));<span class="comment">// 指派方法调用的处理程序</span></div><div class="line">        consumer(proxy);<span class="comment">// 先处理程序中的invoke方法载执行代理对象执行要执行的方法</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="请求头转换成map"><a href="#请求头转换成map" class="headerlink" title="请求头转换成map"></a>请求头转换成map</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">SortedMap&lt;STRING, STRING&gt; paramMap = <span class="keyword">new</span> TreeMap&lt;STRING, STRING&gt;();</div><div class="line"> Enumeration&lt;STRING&gt; em = request.getParameterNames();</div><div class="line"> <span class="keyword">while</span></div><div class="line"> (em.hasMoreElements()) &#123;</div><div class="line">     String paramKey = em.nextElement();</div><div class="line">     paramMap.put(paramKey, request.getParameter(paramKey));</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h1 id="list元素去重数组与list转换"><a href="#list元素去重数组与list转换" class="headerlink" title="list元素去重数组与list转换"></a>list元素去重数组与list转换</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Com</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">	<span class="comment">// 如何去重list集合中的元素</span></div><div class="line">	<span class="comment">// 方式一：使用for循环</span></div><div class="line">	List&lt;String&gt; arr = <span class="keyword">new</span> ArrayList&lt;String&gt;(); <span class="comment">// aec</span></div><div class="line">	arr.add(<span class="string">"a"</span>);</div><div class="line">	arr.add(<span class="string">"b"</span>);</div><div class="line">	arr.add(<span class="string">"e"</span>);</div><div class="line">	arr.add(<span class="string">"e"</span>);</div><div class="line">	arr.add(<span class="string">"c"</span>);</div><div class="line">	arr.add(<span class="string">"e"</span>);</div><div class="line">	arr.add(<span class="string">"a"</span>);</div><div class="line">	arr.add(<span class="string">"b"</span>);</div><div class="line">	arr.add(<span class="string">"b"</span>);</div><div class="line"><span class="comment">//	for (int i = 0; i &lt; arr.size(); i++) &#123;</span></div><div class="line"><span class="comment">//	    for (int j = i + 1; j &lt; arr.size(); j++) &#123;</span></div><div class="line"><span class="comment">//		if (arr.get(i).equals(arr.get(j))) &#123;</span></div><div class="line"><span class="comment">//		    arr.remove(j);</span></div><div class="line"><span class="comment">//		    if (j != arr.size()) &#123;</span></div><div class="line"><span class="comment">//			j--;</span></div><div class="line"><span class="comment">//		    &#125;</span></div><div class="line"><span class="comment">//		&#125;</span></div><div class="line"><span class="comment">//	    &#125;</span></div><div class="line"><span class="comment">//	&#125;</span></div><div class="line"><span class="comment">//	for (int i = 0; i &lt; arr.size(); i++) &#123;</span></div><div class="line"><span class="comment">//	    System.out.println(arr.get(i));</span></div><div class="line"><span class="comment">//	&#125;</span></div><div class="line">	<span class="comment">// 方式二</span></div><div class="line"><span class="comment">//	for (int i = 0; i &lt; arr.size() - 1; i++) &#123;</span></div><div class="line"><span class="comment">//	    for (int j = arr.size() - 1; j &gt; i; j--) &#123;</span></div><div class="line"><span class="comment">//		if (arr.get(j).equals(arr.get(i))) &#123;</span></div><div class="line"><span class="comment">//		    arr.remove(j);</span></div><div class="line"><span class="comment">//		&#125;</span></div><div class="line"><span class="comment">//	    &#125;</span></div><div class="line"><span class="comment">//	&#125;</span></div><div class="line"><span class="comment">//	System.out.println(arr);</span></div><div class="line">	<span class="comment">// 方式三 放到hashset中</span></div><div class="line"><span class="comment">//	Set h = new HashSet(arr);</span></div><div class="line"><span class="comment">//	arr.clear();</span></div><div class="line"><span class="comment">//	arr.addAll(h);</span></div><div class="line"><span class="comment">//	System.out.println(arr);</span></div><div class="line">	<span class="comment">// String类型list集合转String类型的数组</span></div><div class="line">	String[] arrString = (String[]) arr.toArray(<span class="keyword">new</span> String[] &#123;&#125;);</div><div class="line">	<span class="comment">// String数组转String类型的list集合</span></div><div class="line">	List&lt;String&gt; list = Arrays.asList(arrString);</div><div class="line">	<span class="comment">// 快速打印出数组中元素</span></div><div class="line">	System.out.println(Arrays.toString(arrString));</div><div class="line">	<span class="comment">// int数组转list集合</span></div><div class="line">	Integer[] intA = <span class="keyword">new</span> Integer[] &#123; <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span> &#125;;</div><div class="line">	List dataList = Arrays.asList(intA); <span class="comment">// 说明了asList()d的参数要的是对象数组，而不是基本类型的数组</span></div><div class="line">	System.out.println(dataList);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="SortedMap正序排序"><a href="#SortedMap正序排序" class="headerlink" title="SortedMap正序排序"></a>SortedMap正序排序</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line"><span class="comment">// SoredMap是正序排序</span></div><div class="line">SortedMap&lt;String, Object&gt; s = <span class="keyword">new</span> TreeMap&lt;String, Object&gt;();</div><div class="line"><span class="comment">// Map&lt;String, Object&gt; s = new HashMap&lt;String, Object&gt;();</span></div><div class="line">s.put(<span class="string">"b"</span>, <span class="number">2</span>);</div><div class="line">s.put(<span class="string">"c"</span>, <span class="number">3</span>);</div><div class="line">s.put(<span class="string">"a"</span>, <span class="number">1</span>);</div><div class="line">Set&lt;Entry&lt;String, Object&gt;&gt; entrySet = s.entrySet();</div><div class="line"><span class="keyword">for</span> (Entry i : entrySet) &#123;</div><div class="line">    System.out.println(<span class="string">"key :"</span> + i.getKey());</div><div class="line">    System.out.println(<span class="string">"value :"</span> + i.getValue());</div><div class="line">&#125;</div><div class="line">   &#125;</div><div class="line">   <span class="comment">/**</span></div><div class="line">    * 结果： </div><div class="line">    * key :a value :1 key :b value :2 key :c value :3</div><div class="line">    */</div></pre></td></tr></table></figure>
<h3 id="HashMap可放入TreeMap中进行排序"><a href="#HashMap可放入TreeMap中进行排序" class="headerlink" title="HashMap可放入TreeMap中进行排序"></a>HashMap可放入TreeMap中进行排序</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Map&lt;String, Object&gt; m = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</div><div class="line">m.put(<span class="string">"b"</span>, <span class="number">2</span>);</div><div class="line">m.put(<span class="string">"c"</span>, <span class="number">3</span>);</div><div class="line">m.put(<span class="string">"a"</span>, <span class="number">1</span>);</div><div class="line">SortedMap&lt;String, Object&gt; sort = <span class="keyword">new</span> TreeMap&lt;String, Object&gt;(m);</div><div class="line">Set&lt;Entry&lt;String, Object&gt;&gt; entrySet = sort.entrySet();</div><div class="line"><span class="keyword">for</span> (Entry e : entrySet) &#123;</div><div class="line">    System.out.println(e.getKey());</div><div class="line">    System.out.println(e.getValue());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="ajax返回结果时机"><a href="#ajax返回结果时机" class="headerlink" title="ajax返回结果时机"></a>ajax返回结果时机</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Object retObj = actionDispatcher.dispatchRequest(request, response, <span class="keyword">null</span>);</div><div class="line"> String s = JSONObject.toJSONString(retObj);</div><div class="line"> PrintWriter pw = response.getWriter();</div><div class="line"> pw.print(s); <span class="comment">// 设置返回结果对象，并不返回</span></div><div class="line"> pw.close();  <span class="comment">// (这一步结束之后)PrintWriter对象关闭之后才返回对象，执行ajax的success方法</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="请求体以utf8格式转码获取"><a href="#请求体以utf8格式转码获取" class="headerlink" title="请求体以utf8格式转码获取"></a>请求体以utf8格式转码获取</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getHttpBodyString</span><span class="params">(HttpServletRequest req)</span> <span class="keyword">throws</span> Exception</span></div><div class="line">&#123;</div><div class="line">	</div><div class="line">	InputStream in = req.getInputStream();</div><div class="line">	<span class="keyword">byte</span>[] data = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">	<span class="keyword">int</span> readLen = <span class="number">0</span>;</div><div class="line">	ByteArrayOutputStream bos = <span class="keyword">new</span> ByteArrayOutputStream();</div><div class="line">	<span class="keyword">while</span> ((readLen = in.read(data)) != -<span class="number">1</span>)</div><div class="line">	&#123;</div><div class="line">		bos.write(data, <span class="number">0</span>, readLen);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> bos.toString(<span class="string">"UTF-8"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h1><p>Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Could not get JDBC Connection; nested exception is java.sql.SQLException: Timed out waiting for a free available connection.原因有可能是：</p>
<p>You call DB.getConnection() twice. Perhaps because of this the JDBC driver creates 2 connections, but you close only the second one.<br>    创建了两个连接，程序只关闭了第二个<br>    mybatis会自动关闭数据库连接</p>
<h1 id="java调用声音"><a href="#java调用声音" class="headerlink" title="java调用声音"></a>java调用声音</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> sun.audio.AudioPlayer;</div><div class="line"><span class="keyword">import</span> sun.audio.AudioStream;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sounda</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">	    FileInputStream fileau = <span class="keyword">new</span> FileInputStream(<span class="string">"E:/tet/1.wav"</span>);</div><div class="line">	    AudioStream as = <span class="keyword">new</span> AudioStream(fileau);</div><div class="line">	    AudioPlayer.player.start(as);</div><div class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">	&#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[MyBatis]]></title>
      <url>https://volc1605.github.io/2016/10/18/MyBatis/</url>
      <content type="html"><![CDATA[<h1 id="1-判断字段值是否存在并录入数据sql"><a href="#1-判断字段值是否存在并录入数据sql" class="headerlink" title="1.判断字段值是否存在并录入数据sql"></a>1.判断字段值是否存在并录入数据sql</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 录入短信套餐信息 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addSmsPackage"</span> <span class="attr">parameterType</span>=<span class="string">"java.util.Map"</span>&gt;</span></div><div class="line">	INSERT INTO</div><div class="line">	tp_package_info (</div><div class="line">	f_station_id,</div><div class="line">	f_type,</div><div class="line">	f_buy_count,</div><div class="line">	f_package_count,</div><div class="line">	f_cur_count,</div><div class="line">	f_first_month_count,</div><div class="line">	f_sec_month_count,</div><div class="line">	f_third_month_count,</div><div class="line">	f_first_month_surplus,</div><div class="line">	f_sec_month_surplus,</div><div class="line">	f_is_first_accrued,</div><div class="line">	f_is_sec_accrued,</div><div class="line">	f_every_month,</div><div class="line">	f_package_create_time</div><div class="line">	) SELECT</div><div class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"combo != null and combo != '' and combo == 1"</span>&gt;</span></div><div class="line">		#&#123;userId&#125;,#&#123;combo&#125;,0,50000,5000,5000,3000,3000,0,0,0,0,0,#&#123;currentTime&#125;</div><div class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"combo != null and combo != '' and combo == 2"</span>&gt;</span></div><div class="line">		#&#123;userId&#125;,#&#123;combo&#125;,0,50000,5000,5000,3000,3000,0,0,0,0,0,#&#123;currentTime&#125;</div><div class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"combo != null and combo != '' and combo == 0"</span>&gt;</span></div><div class="line">		#&#123;userId&#125;,#&#123;combo&#125;,0,0,0,0,0,0,0,0,0,0,0,#&#123;currentTime&#125;</div><div class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">	FROM</div><div class="line">	DUAL</div><div class="line">	WHERE</div><div class="line">	NOT EXISTS (</div><div class="line">	SELECT</div><div class="line">	*</div><div class="line">	FROM</div><div class="line">	tp_package_info st</div><div class="line">	WHERE</div><div class="line">	st.f_station_id = #&#123;userId&#125;)</div><div class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="2-sql索引"><a href="#2-sql索引" class="headerlink" title="2.sql索引"></a>2.sql索引</h1><p>创建唯一索引时，可以使用REPLACE INTO 进行修改或新增数据<br>13if判断不能加引号<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">SELECT</div><div class="line"><span class="tag">&lt;<span class="name">INCLUDE</span> <span class="attr">REFID</span>=<span class="string">"Base_Column_List"</span> /&gt;</span> ,</div><div class="line"><span class="tag">&lt;<span class="name">INCLUDE</span> <span class="attr">REFID</span>=<span class="string">"Blob_Column_List"</span> /&gt;</span> FROM txm_publish t WHERE 1 = 1 AND</div><div class="line">t.f_type = "1" OR t.f_type = "2"</div><div class="line"><span class="tag">&lt;<span class="name">IF</span> <span class="attr">TEST</span>=<span class="string">"fUserTypeId==8 "</span>&gt;</span><span class="tag">&lt;<span class="name">!—不能加引号</span> <span class="attr">--</span>&gt;</span></div><div class="line">			OR t.f_center_id = #&#123;fUserId&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"fUserTypeId != 8 "</span>&gt;</span></div><div class="line">			OR EXISTS (</div><div class="line">			SELECT</div><div class="line">			f_manager_id</div><div class="line">			FROM</div><div class="line">			txm_user_detail d</div><div class="line">			WHERE</div><div class="line">			d.f_user_id = #&#123;fUserId&#125;</div><div class="line">			AND d.f_manager_id = t.f_center_id)</div><div class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">		AND t.f_publishstate = #&#123;fPublishState&#125;</div></pre></td></tr></table></figure></p>
<h1 id="3-mybatis分页sql注意数据类型"><a href="#3-mybatis分页sql注意数据类型" class="headerlink" title="3.mybatis分页sql注意数据类型"></a>3.mybatis分页sql注意数据类型</h1><p>一定要BIGINT类型，传进的map中pageStart和pageSize必须将其设置为int<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">IF</span> <span class="attr">TEST</span>=<span class="string">"pageStart !=-1"</span>&gt;</span> LIMIT</div><div class="line">#&#123;pageStart,jdbcType=BIGINT&#125;,#&#123;pageSize,jdbcType=BIGINT&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">IF</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h1 id="4-mybatis日期转换"><a href="#4-mybatis日期转换" class="headerlink" title="4.mybatis日期转换"></a>4.mybatis日期转换</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">SQL</span> <span class="attr">ID</span>=<span class="string">"Base_Column_List"</span>&gt;</span> f_parcel_id, f_exp_id, f_branch_id,</div><div class="line">f_station_id, f_mail_no, f_company_id, f_company_name, f_recipient_name,</div><div class="line">f_recipient_mobile, f_frame_code, f_take_code, f_num, f_input_way,</div><div class="line">f_input_source, date_format(f_arrive_time,'%Y-%c-%d %h:%i:%s') AS</div><div class="line">'f_arrive_time' , f_parcel_status, f_is_detention, f_out_way, f_out_source,</div><div class="line">f_app_notice_status, f_weixin_notice_status, f_sms_notice_status,</div><div class="line">f_out_time, f_last_time, f_type, f_comment</div><div class="line"><span class="tag">&lt;/<span class="name">SQL</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">SELECT</span> <span class="attr">ID</span>=<span class="string">"queryParcleList"</span> <span class="attr">RESULTMAP</span>=<span class="string">"BaseResultMap"</span>&gt;</span>select</div><div class="line">   <span class="tag">&lt;<span class="name">INCLUDE</span> <span class="attr">REFID</span>=<span class="string">"Base_Column_List"</span> /&gt;</span> from tp_parcel_info WHERE 1=1</div><div class="line">   <span class="tag">&lt;<span class="name">IF</span> <span class="attr">TEST</span>=<span class="string">"mi.startTime!='' and mi.startTime!=null"</span>&gt;</span> and</div><div class="line">   date_format(f_arrive_time, '%Y%m%d%') &amp;gt;= date_format(#&#123;mi.startTime&#125;,</div><div class="line">   '%Y%m%d%')</div><div class="line">   <span class="tag">&lt;/<span class="name">IF</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">IF</span> <span class="attr">TEST</span>=<span class="string">"mi.endTime!='' and mi.endTime!=null"</span>&gt;</span> and</div><div class="line">   date_format(f_arrive_time, '%Y%m%d%') &amp;lt;= date_format(#&#123;mi.endTime&#125;,</div><div class="line">   '%Y%m%d%')</div><div class="line">   <span class="tag">&lt;/<span class="name">IF</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">IF</span> <span class="attr">TEST</span>=<span class="string">"mi.fCompanyId!='-1' and mi.fCompanyId!=null"</span>&gt;</span> and f_company_id</div><div class="line">   = #&#123;mi.fCompanyId&#125;</div><div class="line">   <span class="tag">&lt;/<span class="name">IF</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">IF</span> <span class="attr">TEST</span>=<span class="string">"mi.fParcelStatus!='-1' and mi.fParcelStatus!=null and mi.fParcelStatus !=''"</span>&gt;</span></div><div class="line">   and f_parcel_status = #&#123;mi.fParcelStatus&#125;</div><div class="line">   <span class="tag">&lt;/<span class="name">IF</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">IF</span> <span class="attr">TEST</span>=<span class="string">"mi.fStationId !=null and mi.fStationId !=''"</span>&gt;</span> and f_station_id</div><div class="line">   = #&#123;mi.fStationId&#125;</div><div class="line">   <span class="tag">&lt;/<span class="name">IF</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">IF</span> <span class="attr">TEST</span>=<span class="string">"pageNum!='-1' and pageSize!='-1'"</span>&gt;</span> LIMIT #&#123;pageNum&#125;,</div><div class="line">   #&#123;pageSize&#125;</div><div class="line">   <span class="tag">&lt;/<span class="name">IF</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">SELECT</span>&gt;</span></div></pre></td></tr></table></figure>
<h1 id="spring-mybatis"><a href="#spring-mybatis" class="headerlink" title="spring+mybatis"></a>spring+mybatis</h1><pre><code>配置参考：https://my.oschina.net/wangt10/blog/508344
</code></pre>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Hexo之NexT主题搭建博客详细过程]]></title>
      <url>https://volc1605.github.io/2016/10/03/Hexo%E4%B9%8BNexT%E4%B8%BB%E9%A2%98%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p><div><center><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="https://music.163.com/outchain/player?type=2&id=33856282&auto=0&height=66"></iframe></center></div><br>本站是用hexo来搭建的，使用的是next主题。这里记录一下搭建的整个过程，仅供参考！有什么问题请留言通知，谢谢支持！</p>
<h1 id="1-环境准备"><a href="#1-环境准备" class="headerlink" title="1.环境准备"></a>1.环境准备</h1><p>下载安装nodejs和git(for window)，声明一下我的搭建环境win764</p>
<h2 id="1-1-nodejs安装"><a href="#1-1-nodejs安装" class="headerlink" title="1.1.nodejs安装"></a>1.1.nodejs安装</h2><p>官网下载地址：<a href="https://nodejs.org/en/" target="_blank" rel="external">https://nodejs.org/en/</a> 下载v<em>*</em> LTS Recommended For Most Users</p>
<blockquote>
<p>设置系统变量      </p>
</blockquote>
<p>我把nodejs安装在c盘program files的nodejs目录下<br>编辑系统环境变量path的值，追加C:\Program Files\nodejs</p>
<blockquote>
<p>安装Express开发框架  </p>
</blockquote>
<p>以管理员打开cmd命令窗口，执行命令<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> install -g express</div><div class="line"><span class="attribute">npm</span> install -g express-generator</div></pre></td></tr></table></figure></p>
<p>在C:\Program Files\nodejs\node_modules中会生成express和express-generator两个文件夹表示安装好了</p>
<blockquote>
<p>新建项目  </p>
</blockquote>
<p>进入C:\Program Files\nodejs，新建名称为newproject的项目<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">cd</span> C:\Program Files\nodejs</div><div class="line"><span class="attribute">express</span> -t ejs newsproject</div></pre></td></tr></table></figure></p>
<p>新建成功在nodesj目录下会生成newproject目录，其目录下大致有以下文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">bin          相关运行脚本</div><div class="line">public       静态资源</div><div class="line">routes       路由表</div><div class="line">views        试图模板  </div><div class="line">app.js       视图文件夹  </div><div class="line">packge.json  项目依赖说明</div></pre></td></tr></table></figure></p>
<blockquote>
<p>关于执行npm install -g express命令的出现错误的解决方式  </p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> config list # 查看以前修改过的命令，针对错误的地方删除掉。</div></pre></td></tr></table></figure>
<p>删除代理<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> config delete proxy</div></pre></td></tr></table></figure></p>
<p>删除注册的目录<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> config delete registry</div></pre></td></tr></table></figure></p>
<p>npm仓库是国外服务器，经常连接不上或安装慢，这里推荐使用 淘宝 NPM 镜像 来安装，设置镜像<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> config set registry https://registry.npm.taobao.org</div></pre></td></tr></table></figure></p>
<p>查看是否修改成功<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> config list</div></pre></td></tr></table></figure></p>
<p>再重新安装express模块<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> install -g express</div></pre></td></tr></table></figure></p>
<blockquote>
<p>安装模块  </p>
</blockquote>
<p>进入newproject目录, 安装模块<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">cd</span> newsproject</div><div class="line"><span class="attribute">npm</span> install</div></pre></td></tr></table></figure></p>
<blockquote>
<p>启动项目  </p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> start</div></pre></td></tr></table></figure>
<p>在浏览器访问<a href="http://127.0.0.1:3000/" target="_blank" rel="external">http://127.0.0.1:3000/</a> 测试出现下面图视表示nodejs安装成功，并可以正常部署项目<br><img src="https://volc1605.github.io/images/Hexo之NexT主题搭建博客详细过程/result.png" alt="测试"><br>可输入以下命令查看版本号<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">node</span> -v</div><div class="line"><span class="attribute">npm</span> -v</div></pre></td></tr></table></figure></p>
<h2 id="1-2-git安装"><a href="#1-2-git安装" class="headerlink" title="1.2.git安装"></a>1.2.git安装</h2><p>官网下载地址：<a href="https://git-scm.com/downloads/" target="_blank" rel="external">https://git-scm.com/downloads/</a> 这个就不多说了</p>
<h1 id="2-安装Hexo"><a href="#2-安装Hexo" class="headerlink" title="2.安装Hexo"></a>2.安装Hexo</h1><p>git安装成功后在桌面右击选择git bash here, 命令窗口<br><img src="https://volc1605.github.io/images/Hexo之NexT主题搭建博客详细过程/desktop.png" alt="desktop"></p>
<blockquote>
<p>安装hexo  </p>
</blockquote>
<p>执行命令</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> -g hexo-cli  # g代表全局,npm默认为当前项目安装</div></pre></td></tr></table></figure>
<p>在D盘新建blog文件夹，这个文件夹就是博客的根目录，打开blog空白处右击选择git bash here执行以下命令。首先对blog文件夹进行hexo初始化<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">hexo</span> init</div></pre></td></tr></table></figure></p>
<p>会生成一些文件</p>
<blockquote>
<p>安装依赖包</p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> install</div></pre></td></tr></table></figure>
<p>可能会遇到的错误<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> ERR! registry error parsing json # 错误</div></pre></td></tr></table></figure></p>
<p>可能需要设置npm代理,执行命令<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> config set registry http://registry.cnpmjs.org</div></pre></td></tr></table></figure></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">hexo</span>:command not found</div></pre></td></tr></table></figure>
<p>删除刚刚安装的C:\Users\Administrator\AppData\Roaming\npm目录，重新执行命令npm install -g hexo安装hexo</p>
<blockquote>
<p>生成静态资源</p>
</blockquote>
<p>生成public文件夹(浏览器访问资源)<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">hexo</span> g</div></pre></td></tr></table></figure></p>
<blockquote>
<p>启动服务</p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">hexo</span> s</div></pre></td></tr></table></figure>
<p>在浏览器访问：<a href="http://localhost:4000/" target="_blank" rel="external">http://localhost:4000/</a> 便可查看hexo默认的主题<br><img src="https://volc1605.github.io/images/Hexo之NexT主题搭建博客详细过程/h.png" alt="hexo"><br><a id="more"></a></p>
<blockquote>
<p>clone NexT主题</p>
</blockquote>
<p>在blog根目录执行命令<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">git</span> clone https://github.com/iissnan/hexo-theme-next themes/next</div></pre></td></tr></table></figure></p>
<p>clone完成后打开blog下的themes文件夹就可以看到有两个主题，一个是默认的，一个是刚刚clone的NexT主题<br>站点配置文件D:\blog\_config.yml<br>主题配置文件D:\blog\themes\next\_config.yml<br>在站点配置文件_config.yml中进行搜索key为’theme’，如果没有theme就添加key为theme，其值为next<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Extensions</div><div class="line">## Plugins: https://hexo.io/plugins/</div><div class="line">## Themes: https://hexo.io/themes/</div><div class="line"># theme: landscape</div><div class="line"># 设置主题为next</div><div class="line">theme: next</div></pre></td></tr></table></figure></p>
<p>需要注意的是冒号后面有一个空格<br>在blog目录中右击选择git bash here 分别执行清除静态资源，生成静态资源，启动服务命令<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">hexo</span> clean</div><div class="line"><span class="attribute">hexo</span> g</div><div class="line"><span class="attribute">hexo</span> s</div></pre></td></tr></table></figure></p>
<p>在浏览器中访问<a href="http://localhost:4000/" target="_blank" rel="external">http://localhost:4000/</a> 便可看到效果</p>
<p>打开主题配置文件_config.yml找到Schemes，如下所示有三种方案可选，只需将#去掉就可以了，可以都尝试一下，选择喜欢的风格，修改之后不用重启服务直接刷新浏览器就能看到效果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># 切换样式</div><div class="line"># Schemes</div><div class="line">#scheme: Muse</div><div class="line">#scheme: Mist</div><div class="line">scheme: Pisces</div></pre></td></tr></table></figure></p>
<p>到此本地资源基本上完成了，下面贴出站点配置_config.yml和主题配置_config.yml里面注释了信息可以参考</p>
<h2 id="2-1站点配置文件-config-yml"><a href="#2-1站点配置文件-config-yml" class="headerlink" title="2.1站点配置文件_config.yml"></a>2.1站点配置文件_config.yml</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line"># Hexo Configuration</div><div class="line">## Docs: https://hexo.io/docs/configuration.html</div><div class="line">## Source: https://github.com/hexojs/hexo/</div><div class="line"></div><div class="line"># Site</div><div class="line">title: Blog  # 首页title名称</div><div class="line">subtitle: Volc&apos;s Blog  </div><div class="line">description: volc #作者简介</div><div class="line">author: VOLC # 作者名称</div><div class="line">language: zh-Hans # 修改语言环境为简体汉字</div><div class="line">timezone:</div><div class="line"></div><div class="line"># URL</div><div class="line">## If your site is put in a subdirectory, set url as &apos;http://yoursite.com/child&apos; and root as &apos;/child/&apos;</div><div class="line">url: https://volc1605.github.io/</div><div class="line">root: /</div><div class="line">permalink: :year/:month/:day/:title/</div><div class="line">permalink_defaults:</div><div class="line"></div><div class="line"># Directory</div><div class="line">source_dir: source</div><div class="line">public_dir: public</div><div class="line">tag_dir: tags</div><div class="line">archive_dir: archives</div><div class="line">category_dir: categories</div><div class="line">code_dir: downloads/code</div><div class="line">i18n_dir: :lang</div><div class="line">skip_render:</div><div class="line"></div><div class="line"># Writing</div><div class="line">new_post_name: :title.md # File name of new posts</div><div class="line">default_layout: post</div><div class="line">titlecase: false # Transform title into titlecase</div><div class="line">external_link: true # Open external links in new tab</div><div class="line">filename_case: 0</div><div class="line">render_drafts: false</div><div class="line">post_asset_folder: false</div><div class="line">relative_link: false</div><div class="line">future: true</div><div class="line">highlight:</div><div class="line">  enable: true</div><div class="line">  line_number: true</div><div class="line">  auto_detect: false</div><div class="line">  tab_replace:</div><div class="line"></div><div class="line"># Category &amp; Tag</div><div class="line">default_category: uncategorized</div><div class="line">category_map:</div><div class="line">  编程: programming</div><div class="line">  生活: life</div><div class="line">  其他: other</div><div class="line">tag_map:</div><div class="line"></div><div class="line"># Date / Time format</div><div class="line">## Hexo uses Moment.js to parse and display date</div><div class="line">## You can customize the date format as defined in</div><div class="line">## http://momentjs.com/docs/#/displaying/format/</div><div class="line">date_format: YYYY-MM-DD</div><div class="line">time_format: HH:mm:ss</div><div class="line"></div><div class="line"># Pagination</div><div class="line">## Set per_page to 0 to disable pagination</div><div class="line">per_page: 10</div><div class="line">pagination_dir: page</div><div class="line"></div><div class="line"># Extensions</div><div class="line">## Plugins: https://hexo.io/plugins/</div><div class="line">## Themes: https://hexo.io/themes/</div><div class="line">#theme: landscape</div><div class="line"># 设置主题为next</div><div class="line">theme: next</div><div class="line"></div><div class="line"># Deployment</div><div class="line">## Docs: https://hexo.io/docs/deployment.html</div><div class="line">deploy:</div><div class="line">  type: git</div><div class="line">  repository: git@github.com:volc1605/volc1605.github.io.git</div><div class="line">  branch: master</div><div class="line"></div><div class="line"># 设置头像</div><div class="line">avatar: /images/0.png</div><div class="line"></div><div class="line"># Social links</div><div class="line">social:</div><div class="line">  GitHub: https://github.com/volc1605</div><div class="line">  Twitter: https://twitter.com/volcliu</div><div class="line">  微博: http://weibo.com/2297464654/profile?topnav=1&amp;wvr=6&amp;is_all=1</div><div class="line">  知乎: https://www.zhihu.com/people/volc</div><div class="line"></div><div class="line"># hexo sitemap网站地图</div><div class="line">sitemap:</div><div class="line">  path: sitemap.xml</div><div class="line">baidusitemap:</div><div class="line">  path: baidusitemap.xml</div><div class="line"></div><div class="line">search:</div><div class="line">  path: search.xml</div><div class="line">  field: post</div><div class="line"># 百度站点统计</div><div class="line">baidu_analytics: 87980c**************99ec5e26fb5</div><div class="line"># google统计</div><div class="line">google_analytics: 85*****1</div></pre></td></tr></table></figure>
<h2 id="3-2-主题配置文件-config-yml"><a href="#3-2-主题配置文件-config-yml" class="headerlink" title="3.2.主题配置文件_config.yml"></a>3.2.主题配置文件_config.yml</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div></pre></td><td class="code"><pre><div class="line"># ---------------------------------------------------------------</div><div class="line"># Site Information Settings</div><div class="line"># ---------------------------------------------------------------</div><div class="line"></div><div class="line"># Put your favicon.ico into `hexo-site/source/` directory.</div><div class="line">favicon: /favicon.ico</div><div class="line"></div><div class="line"># Set default keywords (Use a comma to separate)</div><div class="line">keywords: &quot;Hexo, NexT&quot;</div><div class="line"></div><div class="line"># Set rss to false to disable feed link.</div><div class="line"># Leave rss as empty to use site&apos;s feed link.</div><div class="line"># Set rss to specific value if you have burned your feed already.</div><div class="line">rss:</div><div class="line"></div><div class="line"># Specify the date when the site was setup</div><div class="line">#since: 2015</div><div class="line"></div><div class="line"># Canonical, set a canonical link tag in your hexo, you could use it for your SEO of blog.</div><div class="line"># See: https://support.google.com/webmasters/answer/139066</div><div class="line"># Tips: Before you open this tag, remeber set up your URL in hexo _config.yml ( ex. url: http://yourdomain.com )</div><div class="line">canonical: true</div><div class="line"></div><div class="line"></div><div class="line"># ---------------------------------------------------------------</div><div class="line"># Menu Settings</div><div class="line"># ---------------------------------------------------------------</div><div class="line"></div><div class="line"># When running the site in a subdirectory (e.g. domain.tld/blog), remove the leading slash (/archives -&gt; archives)</div><div class="line">menu:</div><div class="line">  home: /</div><div class="line">  categories: /categories</div><div class="line">  archives: /archives</div><div class="line">  tags: /tags</div><div class="line">  message: /message</div><div class="line">  # search: /search</div><div class="line">  about: /about</div><div class="line">  #commonweal: /404.html</div><div class="line"></div><div class="line"></div><div class="line"># Enable/Disable menu icons.</div><div class="line"># Icon Mapping:</div><div class="line">#   Map a menu item to a specific FontAwesome icon name.</div><div class="line">#   Key is the name of menu item and value is the name of FontAwsome icon. Key is case-senstive.</div><div class="line">#   When an question mask icon presenting up means that the item has no mapping icon.</div><div class="line">menu_icons:</div><div class="line">  enable: true</div><div class="line">  #KeyMapsToMenuItemKey: NameOfTheIconFromFontAwesome</div><div class="line">  home: home</div><div class="line">  categories: th</div><div class="line">  tags: tags</div><div class="line">  archives: archive</div><div class="line">  commonweal: heartbeat</div><div class="line">  message: external-link</div><div class="line">  # search: search</div><div class="line">  about: user</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"># ---------------------------------------------------------------</div><div class="line"># Scheme Settings</div><div class="line"># ---------------------------------------------------------------</div><div class="line"></div><div class="line"># 切换样式</div><div class="line"># Schemes</div><div class="line">#scheme: Muse</div><div class="line">scheme: Mist</div><div class="line">#scheme: Pisces</div><div class="line"></div><div class="line"></div><div class="line"># ---------------------------------------------------------------</div><div class="line"># Font Settings</div><div class="line"># - Find fonts on Google Fonts (https://www.google.com/fonts)</div><div class="line"># - All fonts set here will have the following styles:</div><div class="line">#     light, light italic, normal, normal intalic, bold, bold italic</div><div class="line"># - Be aware that setting too much fonts will cause site running slowly</div><div class="line"># - Introduce in 5.0.1</div><div class="line"># ---------------------------------------------------------------</div><div class="line">font:</div><div class="line">  enable: true</div><div class="line"></div><div class="line">  # Uri of fonts host. E.g. //fonts.googleapis.com (Default)</div><div class="line">  host:</div><div class="line"></div><div class="line">  # Global font settings used on &lt;body&gt; element.</div><div class="line">  global:</div><div class="line">    # external: true will load this font family from host.</div><div class="line">    external: true</div><div class="line">    family: Lato</div><div class="line"></div><div class="line">  # Font settings for Headlines (h1, h2, h3, h4, h5, h6)</div><div class="line">  # Fallback to `global` font settings.</div><div class="line">  headings:</div><div class="line">    external: true</div><div class="line">    family:</div><div class="line"></div><div class="line">  # Font settings for posts</div><div class="line">  # Fallback to `global` font settings.</div><div class="line">  posts:</div><div class="line">    external: true</div><div class="line">    family:</div><div class="line"></div><div class="line">  # Font settings for Logo</div><div class="line">  # Fallback to `global` font settings.</div><div class="line">  # The `size` option use `px` as unit</div><div class="line">  logo:</div><div class="line">    external: true</div><div class="line">    family:</div><div class="line">    size: 33</div><div class="line"></div><div class="line">  # Font settings for &lt;code&gt; and code blocks.</div><div class="line">  codes:</div><div class="line">    external: true</div><div class="line">    family:</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"># ---------------------------------------------------------------</div><div class="line"># Sidebar Settings</div><div class="line"># ---------------------------------------------------------------</div><div class="line"></div><div class="line"></div><div class="line"># Social Links</div><div class="line"># Key is the link label showing to end users.</div><div class="line"># Value is the target link (E.g. GitHub: https://github.com/iissnan)</div><div class="line">#social:</div><div class="line">  #LinkLabel: Link</div><div class="line"></div><div class="line"></div><div class="line"># Social Links Icons</div><div class="line"># Icon Mapping:</div><div class="line">#   Map a menu item to a specific FontAwesome icon name.</div><div class="line">#   Key is the name of the item and value is the name of FontAwsome icon. Key is case-senstive.</div><div class="line">#   When an globe mask icon presenting up means that the item has no mapping icon.</div><div class="line">social_icons:</div><div class="line">  enable: true</div><div class="line">  # Icon Mappings.</div><div class="line">  # KeyMapsToSocalItemKey: NameOfTheIconFromFontAwesome</div><div class="line">  GitHub: github</div><div class="line">  Twitter: twitter</div><div class="line">  微博: weibo</div><div class="line"></div><div class="line"></div><div class="line"># Sidebar Avatar</div><div class="line"># in theme directory(source/images): /images/avatar.jpg</div><div class="line"># in site  directory(source/uploads): /uploads/avatar.jpg</div><div class="line">#avatar:</div><div class="line"></div><div class="line"></div><div class="line"># Table Of Contents in the Sidebar</div><div class="line">toc:</div><div class="line">  enable: true</div><div class="line"></div><div class="line">  # Automatically add list number to toc.</div><div class="line">  number: true</div><div class="line"></div><div class="line"></div><div class="line"># Creative Commons 4.0 International License.</div><div class="line"># http://creativecommons.org/</div><div class="line"># Available: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero</div><div class="line">#creative_commons: by-nc-sa</div><div class="line">#creative_commons:</div><div class="line"></div><div class="line"></div><div class="line">sidebar:</div><div class="line">  # Sidebar Position, available value: left | right</div><div class="line">  position: left</div><div class="line">  #position: right</div><div class="line"></div><div class="line">  # Sidebar Display, available value:</div><div class="line">  #  - post    expand on posts automatically. Default.</div><div class="line">  #  - always  expand for all pages automatically</div><div class="line">  #  - hide    expand only when click on the sidebar toggle icon.</div><div class="line">  #  - remove  Totally remove sidebar including sidebar toggler.</div><div class="line">  display: post</div><div class="line">  #display: always</div><div class="line">  #display: hide</div><div class="line">  #display: remove</div><div class="line"></div><div class="line"></div><div class="line"># Blogrolls</div><div class="line">links_title: 友情链接</div><div class="line">links_layout: inline</div><div class="line">links_icon: link  # 设置图标</div><div class="line">links:</div><div class="line">  一素人: http://yisu.ren/index.php/</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"># ---------------------------------------------------------------</div><div class="line"># Misc Theme Settings</div><div class="line"># ---------------------------------------------------------------</div><div class="line"></div><div class="line"># Custom Logo.</div><div class="line"># !!Only available for Default Scheme currently.</div><div class="line"># Options:</div><div class="line">#   enabled: [true/false] - Replace with specific image</div><div class="line">#   image: url-of-image   - Images&apos;s url</div><div class="line">custom_logo:</div><div class="line">  enabled: false</div><div class="line">  image:</div><div class="line"></div><div class="line"></div><div class="line"># Code Highlight theme</div><div class="line"># Available value:</div><div class="line">#    normal | night | night eighties | night blue | night bright</div><div class="line"># https://github.com/chriskempson/tomorrow-theme</div><div class="line">highlight_theme: night eighties</div><div class="line"></div><div class="line"></div><div class="line"># Automatically scroll page to section which is under &lt;!-- more --&gt; mark.</div><div class="line">scroll_to_more: true</div><div class="line"></div><div class="line"></div><div class="line"># Automatically Excerpt. Not recommand.</div><div class="line"># Please use &lt;!-- more --&gt; in the post to control excerpt accurately.</div><div class="line">auto_excerpt:</div><div class="line">  enable: true  # 开启文章阅全文</div><div class="line">  length: 2000   # 显示长度</div><div class="line"></div><div class="line"></div><div class="line"># Wechat Subscriber</div><div class="line">#wechat_subscriber:</div><div class="line">  #enabled: true</div><div class="line">  #qcode: /path/to/your/wechatqcode ex. /uploads/wechat-qcode.jpg</div><div class="line">  #description: ex. subscribe to my blog by scanning my public wechat account</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"># ---------------------------------------------------------------</div><div class="line"># Third Party Services Settings</div><div class="line"># ---------------------------------------------------------------</div><div class="line"></div><div class="line"># MathJax Support</div><div class="line">mathjax:</div><div class="line">  enable: false</div><div class="line">  cdn: //cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML</div><div class="line"></div><div class="line"></div><div class="line"># Swiftype Search API Key</div><div class="line">#swiftype_key:</div><div class="line"></div><div class="line"># Baidu Analytics ID</div><div class="line">#baidu_analytics:</div><div class="line">baidu_tongji: true</div><div class="line"></div><div class="line"># Duoshuo ShortName</div><div class="line">duoshuo_shortname: *******  # 开启多说评论功能</div><div class="line"></div><div class="line"># Disqus</div><div class="line">#disqus_shortname:</div><div class="line"></div><div class="line"># Baidu Share</div><div class="line"># Available value:</div><div class="line">#    button | slide</div><div class="line">#baidushare: true #</div><div class="line">##  type: button</div><div class="line"></div><div class="line"># Share</div><div class="line">#jiathis:</div><div class="line">#add_this_id:</div><div class="line"></div><div class="line"># Share</div><div class="line">duoshuo_share: true  # 开启多说的文章分享功能</div><div class="line"></div><div class="line"># Google Webmaster tools verification setting</div><div class="line"># See: https://www.google.com/webmasters/</div><div class="line">#google_site_verification:</div><div class="line"></div><div class="line"></div><div class="line"># Google Analytics</div><div class="line">#google_analytics:</div><div class="line"></div><div class="line"># CNZZ count</div><div class="line">#cnzz_siteid:</div><div class="line"></div><div class="line"></div><div class="line"># Make duoshuo show UA</div><div class="line"># user_id must NOT be null when admin_enable is true!</div><div class="line"># you can visit http://dev.duoshuo.com get duoshuo user id.</div><div class="line">duoshuo_info:</div><div class="line">  ua_enable: true</div><div class="line">  admin_enable: false</div><div class="line">  user_id: 0</div><div class="line">  #admin_nickname: Author</div><div class="line"></div><div class="line"></div><div class="line"># Facebook SDK Support.</div><div class="line"># https://github.com/iissnan/hexo-theme-next/pull/410</div><div class="line">facebook_sdk:</div><div class="line">  enable: false</div><div class="line">  app_id:       #&lt;app_id&gt;</div><div class="line">  fb_admin:     #&lt;user_id&gt;</div><div class="line">  like_button:  #true</div><div class="line">  webmaster:    #true</div><div class="line"></div><div class="line"># Facebook comments plugin</div><div class="line"># This plugin depends on Facebook SDK.</div><div class="line"># If facebook_sdk.enable is false, Facebook comments plugin is unavailable.</div><div class="line">facebook_comments_plugin:</div><div class="line">  enable: false</div><div class="line">  num_of_posts: 10  # min posts num is 1</div><div class="line">  width: 100%       # default width is 550px</div><div class="line">  scheme: light     # default scheme is light (light or dark)</div><div class="line"></div><div class="line"></div><div class="line"># Show number of visitors to each article.</div><div class="line"># You can visit https://leancloud.cn get AppID and AppKey.</div><div class="line">leancloud_visitors:</div><div class="line">  enable: true</div><div class="line">  app_id: uSB1*************************Hsz</div><div class="line">  app_key: 98i************************aI5</div><div class="line"></div><div class="line"># Show PV/UV of the website/page with busuanzi.</div><div class="line"># Get more information on http://ibruce.info/2015/04/04/busuanzi/</div><div class="line">busuanzi_count:</div><div class="line">  # count values only if the other configs are false</div><div class="line">  enable: false</div><div class="line">  # custom uv span for the whole site</div><div class="line">  site_uv: true</div><div class="line">  site_uv_header: &lt;i class=&quot;fa fa-user&quot;&gt;&lt;/i&gt;</div><div class="line">  site_uv_footer:</div><div class="line">  # custom pv span for the whole site</div><div class="line">  site_pv: true</div><div class="line">  site_pv_header: &lt;i class=&quot;fa fa-eye&quot;&gt;&lt;/i&gt;</div><div class="line">  site_pv_footer:</div><div class="line">  # custom pv span for one page only</div><div class="line">  page_pv: true</div><div class="line">  page_pv_header: &lt;i class=&quot;fa fa-file-o&quot;&gt;&lt;/i&gt;</div><div class="line">  page_pv_footer:</div><div class="line"></div><div class="line"># Tencent analytics ID</div><div class="line"># tencent_analytics:</div><div class="line"></div><div class="line"># Enable baidu push so that the blog will push the url to baidu automatically which is very helpful for SEO</div><div class="line">baidu_push: false</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">#! ---------------------------------------------------------------</div><div class="line">#! DO NOT EDIT THE FOLLOWING SETTINGS</div><div class="line">#! UNLESS YOU KNOW WHAT YOU ARE DOING</div><div class="line">#! ---------------------------------------------------------------</div><div class="line"></div><div class="line"># Motion</div><div class="line">use_motion: true</div><div class="line"></div><div class="line"># Fancybox</div><div class="line">fancybox: true</div><div class="line"></div><div class="line"></div><div class="line"># Script Vendors.</div><div class="line"># Set a CDN address for the vendor you want to customize.</div><div class="line"># For example</div><div class="line">#    jquery: https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js</div><div class="line"># Be aware that you should use the same version as internal ones to avoid potential problems.</div><div class="line">vendors:</div><div class="line">  # Internal path prefix. Please do not edit it.</div><div class="line">  _internal: vendors</div><div class="line"></div><div class="line">  # Internal version: 2.1.3</div><div class="line">  jquery:</div><div class="line"></div><div class="line">  # Internal version: 2.1.5</div><div class="line">  # http://fancyapps.com/fancybox/</div><div class="line">  fancybox:</div><div class="line">  fancybox_css:</div><div class="line"></div><div class="line">  # Internal version: 1.0.6</div><div class="line">  # https://github.com/ftlabs/fastclick</div><div class="line">  fastclick:</div><div class="line"></div><div class="line">  # Internal version: 1.9.7</div><div class="line">  # https://github.com/tuupola/jquery_lazyload</div><div class="line">  lazyload:</div><div class="line"></div><div class="line">  # Internal version: 1.2.1</div><div class="line">  # http://VelocityJS.org</div><div class="line">  velocity:</div><div class="line"></div><div class="line">  # Internal version: 1.2.1</div><div class="line">  # http://VelocityJS.org</div><div class="line">  velocity_ui:</div><div class="line"></div><div class="line">  # Internal version: 0.7.9</div><div class="line">  # https://faisalman.github.io/ua-parser-js/</div><div class="line">  ua_parser:</div><div class="line"></div><div class="line">  # Internal version: 4.4.0</div><div class="line">  # http://fontawesome.io/</div><div class="line">  fontawesome:</div><div class="line"></div><div class="line"></div><div class="line"># Assets</div><div class="line">css: css</div><div class="line">js: js</div><div class="line">images: images</div><div class="line"></div><div class="line"># Theme version</div><div class="line">version: 5.0.1</div><div class="line"></div><div class="line"># Donate 文章末尾显示打赏按钮</div><div class="line">reward_comment: 如果文章对您有用请随意打赏，谢谢支持！</div><div class="line">wechatpay: /images/w.png</div><div class="line">alipay: /images/z.jpg</div></pre></td></tr></table></figure>
<h1 id="3-菜单栏"><a href="#3-菜单栏" class="headerlink" title="3.菜单栏"></a>3.菜单栏</h1><h2 id="3-1-菜单栏为中文简体字"><a href="#3-1-菜单栏为中文简体字" class="headerlink" title="3.1.菜单栏为中文简体字"></a>3.1.菜单栏为中文简体字</h2><p>主题配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">language: zh-Hans</div></pre></td></tr></table></figure></p>
<p>这样就引用了themes\next\languages\zh-Hans.yml文件，打开这个文件就可以看每个key对应的都是中文字体</p>
<h2 id="3-2标签和分类"><a href="#3-2标签和分类" class="headerlink" title="3.2标签和分类"></a>3.2标签和分类</h2><p>在主题配置文件中找到menu，如果想隐藏菜单栏中的某个选项只要在前面加上 # 即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">menu:</div><div class="line">  home: /</div><div class="line">  categories: /categories # 分类</div><div class="line">  archives: /archives     # 归档</div><div class="line">  tags: /tags             # 标签</div><div class="line">  message: /message       # 留言</div><div class="line">  about: /about           # 关于</div><div class="line">  # commonweal: /404.html # 公益</div></pre></td></tr></table></figure></p>
<p>我们将categories 和tags 设为显示<br>再找到menu_icons, 这里是每一个菜单选项前面对应的小图标<br><img src="https://volc1605.github.io/images/Hexo之NexT主题搭建博客详细过程/ioc.png" alt="ioc"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">menu_icons:</div><div class="line">  enable: true</div><div class="line">  #KeyMapsToMenuItemKey: NameOfTheIconFromFontAwesome</div><div class="line">  home: home</div><div class="line">  categories: th</div><div class="line">  tags: tags</div><div class="line">  archives: archive</div><div class="line">  commonweal: heartbeat</div><div class="line">  message: external-link</div><div class="line">  about: user</div></pre></td></tr></table></figure>
<p>我们将categories 和tags 设为显示<br>在blog文件夹中进行git bash here 执行以下命令生成categories 和 tags的页面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hexo n page &quot;categories&quot;</div><div class="line">hexo n page &quot;tags&quot;</div></pre></td></tr></table></figure></p>
<p>会生成source\categories 和 source\tags 两个文件夹，里面都有index.md文件.修改内容为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">title: categories</div><div class="line">type: categories</div><div class="line">---</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">title: tags</div><div class="line">type: tags</div><div class="line">---</div></pre></td></tr></table></figure>
<p>再使用命令生成博文文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo n &quot;name&quot;    # name 文章名称</div></pre></td></tr></table></figure></p>
<p>生成文章时，在对应的name.md中可以这样添加标签和分类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">title: Hexo之NexT主题搭建博客详细过程</div><div class="line">date: 2016-10-03 15:39:31</div><div class="line">update: 2016-10-04 06:19:11</div><div class="line">categories: hexo             # 分类</div><div class="line">tags: [nodejs, hexo, NexT]   # [标签1, 标签2..., 标签n]</div><div class="line">---</div></pre></td></tr></table></figure></p>
<h2 id="3-3-新增留言功能"><a href="#3-3-新增留言功能" class="headerlink" title="3.3.新增留言功能"></a>3.3.新增留言功能</h2><p>主题配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">menu:</div><div class="line">  home: /</div><div class="line">  categories: /categories</div><div class="line">  archives: /archives</div><div class="line">  tags: /tags</div><div class="line">  message: /message       # 新增 message</div><div class="line">  about: /about</div><div class="line">  #commonweal: /404.html</div></pre></td></tr></table></figure></p>
<p>配置图标<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">menu_icons:</div><div class="line">  enable: true</div><div class="line">  home: home</div><div class="line">  categories: th</div><div class="line">  tags: tags</div><div class="line">  archives: archive</div><div class="line">  commonweal: heartbeat</div><div class="line">  message: external-link  # 新增 message</div><div class="line">  about: user</div></pre></td></tr></table></figure></p>
<p>配置对应的中文名称，在themes\next\languages\zh-Hans.yml文件中修改如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">menu:</div><div class="line">  home: 首页</div><div class="line">  archives: 归档</div><div class="line">  categories: 分类</div><div class="line">  tags: 标签</div><div class="line">  about: 关于</div><div class="line">  search: 搜索</div><div class="line">  message: 留言            # 新增 留言</div><div class="line">  commonweal: 公益404</div><div class="line">  udpate: 更新</div></pre></td></tr></table></figure></p>
<p>然后执行如下命令<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">hexo</span> n page <span class="string">"message"</span></div></pre></td></tr></table></figure></p>
<p>重新清除，生成和启动便可看到效果，只不过留言功能什么也没有</p>
<h3 id="3-3-1-引入多说评论功能"><a href="#3-3-1-引入多说评论功能" class="headerlink" title="3.3.1.引入多说评论功能"></a>3.3.1.引入多说评论功能</h3><p>进入官网<a href="http://duoshuo.com/" target="_blank" rel="external">http://duoshuo.com/</a> 进行登录，建议不要使用微信进行登录，容易出现Scope 参数错误或没有 Scope 权限的问题。登录完成在首页进入后台管理，在设置里面包含：域名：zhangsan.duoshuo.com<br>在主题配置文件中<br>修改如下, duoshuo_shortname的值就是域名中的zhangsan<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">duoshuo_shortname: zhangsan  # 开启多说评论功能</div><div class="line"># Share</div><div class="line">duoshuo_share: true          # 开启多说的文章分享功能</div></pre></td></tr></table></figure></p>
<p>留言功能已完成<br>去掉分类和其他的选项的留言功能，只需修改index.md<br>在source\categories\index.md 中修改如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">title: categories</div><div class="line">type: categories</div><div class="line">comments: false       # 去掉评论功能</div><div class="line">date: 2016-10-01 21:07:35</div><div class="line">---</div></pre></td></tr></table></figure></p>
<p>添加留言邮件提醒功能请参阅：<a href="http://www.tuicool.com/articles/iEN7riZ" target="_blank" rel="external">http://www.tuicool.com/articles/iEN7riZ</a></p>
<h1 id="4-修改头像"><a href="#4-修改头像" class="headerlink" title="4.修改头像"></a>4.修改头像</h1><p>设置菜单栏头像<br>    把头像0.jpg图片放在themes\next\source\images中<br>    在站点的_config.yml，修改字段 avatar<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 设置头像</div><div class="line">avatar: /images/0.jpg</div></pre></td></tr></table></figure></p>
<p>可以指定网址图片url</p>
<h1 id="5-侧边栏社交链接"><a href="#5-侧边栏社交链接" class="headerlink" title="5.侧边栏社交链接"></a>5.侧边栏社交链接</h1><p>侧栏社交链接的修改包含两个部分，第一是链接，第二是链接图标。 两者配置均在 主题配置文件 中。</p>
<blockquote>
<p>链接放置在 social 字段下，一行一个链接。其键值格式是 显示文本: 链接地址</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># Social links</div><div class="line">social:</div><div class="line">  GitHub: https://github.com/your-user-name</div><div class="line">  Twitter: https://twitter.com/your-user-name</div><div class="line">  微博: http://weibo.com/your-user-name</div><div class="line">  豆瓣: http://douban.com/people/your-user-name</div><div class="line">  知乎: http://www.zhihu.com/people/your-user-name</div><div class="line">  # 等等</div></pre></td></tr></table></figure>
<p>效果图<br><img src="https://volc1605.github.io/images/Hexo之NexT主题搭建博客详细过程/lin.png" alt="lin"></p>
<blockquote>
<p>设定链接的图标，对应的字段是 social_icons。其键值格式是 匹配键: Font Awesome 图标名称， 匹配键 与上一步所配置的链接的 显示文本 相同（大小写严格匹配），图标名称 是 Font Awesome 图标的名字（不必带 fa- 前缀）。 enable 选项用于控制是否显示图标，你可以设置成 false 来去掉图标。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># Social Icons</div><div class="line">social_icons:</div><div class="line">  enable: true</div><div class="line">  # Icon Mappings</div><div class="line">  GitHub: github</div><div class="line">  Twitter: twitter</div><div class="line">  微博: weibo</div></pre></td></tr></table></figure>
<h1 id="6-友情链接"><a href="#6-友情链接" class="headerlink" title="6.友情链接"></a>6.友情链接</h1><blockquote>
<p>编辑 主题配置文件 添加：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Blogrolls</div><div class="line">links_title: 友情链接</div><div class="line">links_layout: inline</div><div class="line">links_icon: link  # 设置图标</div><div class="line">links:</div><div class="line">  一素人: http://yisu.ren/index.php/</div></pre></td></tr></table></figure>
<p><img src="https://volc1605.github.io/images/Hexo之NexT主题搭建博客详细过程/yl.png" alt="yl"></p>
<h1 id="7-文章配置"><a href="#7-文章配置" class="headerlink" title="7.文章配置"></a>7.文章配置</h1><h2 id="7-1-开启阅读全文"><a href="#7-1-开启阅读全文" class="headerlink" title="7.1.开启阅读全文"></a>7.1.开启阅读全文</h2><blockquote>
<p>方式一：在文章中进行截断(推荐使用)<br>以下给出文章md文件片段内容</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">在浏览器访问：http://localhost:4000/ 便可查看hexo默认的主题</div><div class="line">![hexo](https://volc1605.github.io/images/Hexo之NexT主题搭建博客详细过程/h.png)</div><div class="line">&lt;!-- more --&gt;    # 直接在文章的md文件中添加&lt;!-- more --&gt;标注</div><div class="line">&gt;clone NexT主题</div><div class="line"></div><div class="line">在blog根目录执行命令</div></pre></td></tr></table></figure>
<blockquote>
<p>方式二：修改主题配置文件</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">auto_excerpt:</div><div class="line">  enable: true  # 开启文章阅全文</div><div class="line">  length: 2000   # 显示长度</div></pre></td></tr></table></figure>
<h2 id="7-2-新增阅读量"><a href="#7-2-新增阅读量" class="headerlink" title="7.2.新增阅读量"></a>7.2.新增阅读量</h2><p>为每一篇文章统计阅读量  </p>
<blockquote>
<p>使用leancloud进行文章变更统计，进入官网<a href="https://leancloud.cn/" target="_blank" rel="external">https://leancloud.cn/</a> 注册</p>
</blockquote>
<p>打开LeanCloud官网，进入注册页面注册。完成邮箱激活后，点击头像，进入控制台页面</p>
<blockquote>
<p>创建新应用</p>
</blockquote>
<p>点击应用创建新应用，应用名称随便起</p>
<blockquote>
<p>创建Class文件</p>
</blockquote>
<p>进入到应用后点击存储，在左侧点击设置，选择”创建Class”，名称必须为Counter</p>
<blockquote>
<p>修改主题配置文件</p>
</blockquote>
<p>主题配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># 文章阅读量</div><div class="line">leancloud_visitors:</div><div class="line">  enable: true</div><div class="line">  app_id: **你的app_id**</div><div class="line">  app_key: **你的app_key**</div></pre></td></tr></table></figure></p>
<p>其中，app_id和app_key在你所创建的应用的设置-&gt;应用Key中  </p>
<blockquote>
<p>添加lean-analytics.swig文件</p>
</blockquote>
<p>在主题的 themes\next\layout\_scripts\third-party路径下查看是否有lean-analytics.swig 文件，如果没有新建一个 lean-analytics.swig 文件，并向里面添加以下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line">&#123;% if theme.leancloud_visitors.enable %&#125;</div><div class="line"></div><div class="line">  &#123;# custom analytics part create by xiamo #&#125;</div><div class="line">  &lt;script src=&quot;https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js&quot;&gt;&lt;/script&gt;</div><div class="line">  &lt;script&gt;AV.initialize(&quot;&#123;&#123;theme.leancloud_visitors.app_id&#125;&#125;&quot;, &quot;&#123;&#123;theme.leancloud_visitors.app_key&#125;&#125;&quot;);&lt;/script&gt;</div><div class="line">  &lt;script&gt;</div><div class="line">    function showTime(Counter) &#123;</div><div class="line">      var query = new AV.Query(Counter);</div><div class="line">      var entries = [];</div><div class="line">      var $visitors = $(&quot;.leancloud_visitors&quot;);</div><div class="line"></div><div class="line">      $visitors.each(function () &#123;</div><div class="line">        entries.push( $(this).attr(&quot;id&quot;).trim() );</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">      query.containedIn(&apos;url&apos;, entries);</div><div class="line">      query.find()</div><div class="line">        .done(function (results) &#123;</div><div class="line">          var COUNT_CONTAINER_REF = &apos;.leancloud-visitors-count&apos;;</div><div class="line"></div><div class="line">          if (results.length === 0) &#123;</div><div class="line">            $visitors.find(COUNT_CONTAINER_REF).text(0);</div><div class="line">            return;</div><div class="line">          &#125;</div><div class="line"></div><div class="line">          for (var i = 0; i &lt; results.length; i++) &#123;</div><div class="line">            var item = results[i];</div><div class="line">            var url = item.get(&apos;url&apos;);</div><div class="line">            var time = item.get(&apos;time&apos;);</div><div class="line">            var element = document.getElementById(url);</div><div class="line"></div><div class="line">            $(element).find(COUNT_CONTAINER_REF).text(time);</div><div class="line">          &#125;</div><div class="line">          for(var i = 0; i &lt; entries.length; i++) &#123;</div><div class="line">            var url = entries[i];</div><div class="line">            var element = document.getElementById(url);</div><div class="line">            var countSpan = $(element).find(COUNT_CONTAINER_REF);</div><div class="line">            if( countSpan.text() == &apos;&apos;) &#123;</div><div class="line">              countSpan.text(0);</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        &#125;)</div><div class="line">        .fail(function (object, error) &#123;</div><div class="line">          console.log(&quot;Error: &quot; + error.code + &quot; &quot; + error.message);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    function addCount(Counter) &#123;</div><div class="line">      var $visitors = $(&quot;.leancloud_visitors&quot;);</div><div class="line">      var url = $visitors.attr(&apos;id&apos;).trim();</div><div class="line">      var title = $visitors.attr(&apos;data-flag-title&apos;).trim();</div><div class="line">      var query = new AV.Query(Counter);</div><div class="line"></div><div class="line">      query.equalTo(&quot;url&quot;, url);</div><div class="line">      query.find(&#123;</div><div class="line">        success: function(results) &#123;</div><div class="line">          if (results.length &gt; 0) &#123;</div><div class="line">            var counter = results[0];</div><div class="line">            counter.fetchWhenSave(true);</div><div class="line">            counter.increment(&quot;time&quot;);</div><div class="line">            counter.save(null, &#123;</div><div class="line">              success: function(counter) &#123;</div><div class="line">                var $element = $(document.getElementById(url));</div><div class="line">                $element.find(&apos;.leancloud-visitors-count&apos;).text(counter.get(&apos;time&apos;));</div><div class="line">              &#125;,</div><div class="line">              error: function(counter, error) &#123;</div><div class="line">                console.log(&apos;Failed to save Visitor num, with error message: &apos; + error.message);</div><div class="line">              &#125;</div><div class="line">            &#125;);</div><div class="line">          &#125; else &#123;</div><div class="line">            var newcounter = new Counter();</div><div class="line">            /* Set ACL */</div><div class="line">            var acl = new AV.ACL();</div><div class="line">            acl.setPublicReadAccess(true);</div><div class="line">            acl.setPublicWriteAccess(true);</div><div class="line">            newcounter.setACL(acl);</div><div class="line">            /* End Set ACL */</div><div class="line">            newcounter.set(&quot;title&quot;, title);</div><div class="line">            newcounter.set(&quot;url&quot;, url);</div><div class="line">            newcounter.set(&quot;time&quot;, 1);</div><div class="line">            newcounter.save(null, &#123;</div><div class="line">              success: function(newcounter) &#123;</div><div class="line">                var $element = $(document.getElementById(url));</div><div class="line">                $element.find(&apos;.leancloud-visitors-count&apos;).text(newcounter.get(&apos;time&apos;));</div><div class="line">              &#125;,</div><div class="line">              error: function(newcounter, error) &#123;</div><div class="line">                console.log(&apos;Failed to create&apos;);</div><div class="line">              &#125;</div><div class="line">            &#125;);</div><div class="line">          &#125;</div><div class="line">        &#125;,</div><div class="line">        error: function(error) &#123;</div><div class="line">          console.log(&apos;Error:&apos; + error.code + &quot; &quot; + error.message);</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    $(function() &#123;</div><div class="line">      var Counter = AV.Object.extend(&quot;Counter&quot;);</div><div class="line">      if ($(&apos;.leancloud_visitors&apos;).length == 1) &#123;</div><div class="line">        addCount(Counter);</div><div class="line">      &#125; else if ($(&apos;.post-title-link&apos;).length &gt; 1) &#123;</div><div class="line">        showTime(Counter);</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">  &lt;/script&gt;</div><div class="line"></div><div class="line">&#123;% endif %&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>修改 themes\next\layout_macro\post.swig 文件</p>
</blockquote>
<p>找到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;% if not is_index and theme.facebook_sdk.enable and theme.facebook_sdk.like_button %&#125;</div><div class="line">  &amp;nbsp; | &amp;nbsp;</div><div class="line">  &lt;div class=&quot;fb-like&quot; data-layout=&quot;button_count&quot; data-share=&quot;true&quot;&gt;&lt;/div&gt;</div><div class="line">&#123;% endif %&#125;</div></pre></td></tr></table></figure></p>
<p>在其后追加以下代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;# LeanCould PageView #&#125;</div><div class="line">  &#123;% if theme.leancloud_visitors.enable %&#125;</div><div class="line">     &lt;span id=&quot;&#123;&#123; url_for(post.path) &#125;&#125;&quot; class=&quot;leancloud_visitors&quot; data-flag-title=&quot;&#123;&#123; post.title &#125;&#125;&quot;&gt;</div><div class="line">       &amp;nbsp; | &amp;nbsp;</div><div class="line">       &lt;span class=&quot;post-meta-item-icon&quot;&gt;</div><div class="line">         &lt;i class=&quot;fa fa-eye&quot;&gt;&lt;/i&gt;</div><div class="line">       &lt;/span&gt;</div><div class="line">       &lt;span class=&quot;post-meta-item-text&quot;&gt;&#123;&#123;__(&apos;post.visitors&apos;)&#125;&#125; &lt;/span&gt;</div><div class="line">       &lt;span class=&quot;leancloud-visitors-count&quot;&gt;&lt;/span&gt;</div><div class="line">  &#123;% endif %&#125;</div><div class="line">&#123;% endif %&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>配置themes\next\layout\_layout.swig文件</p>
</blockquote>
<p>在最后div标签中查找是否引用了_scripts/third-party/lean-analytics.swig文件，如果没有增加以下代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;% include &apos;_scripts/third-party/comments.swig&apos; %&#125;</div><div class="line">  &#123;% include &apos;_scripts/third-party/tinysou.swig&apos; %&#125;</div><div class="line">  &#123;% include &apos;_scripts/third-party/localsearch.swig&apos; %&#125;</div><div class="line">  &#123;% include &apos;_scripts/third-party/mathjax.swig&apos; %&#125;</div><div class="line">  &#123;% include &apos;_scripts/third-party/lean-analytics.swig&apos; %&#125;  # 新增</div><div class="line">  &#123;% include &apos;_scripts/baidu-push.swig&apos; %&#125;</div><div class="line">&lt;/body&gt;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>修改语言配置文件 themes\next\languages\zh-Hans.yml post字段</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">post:</div><div class="line">  sticky: 置顶</div><div class="line">  posted: 发表于</div><div class="line">  updated: 最近</div><div class="line">  update: 更新于</div><div class="line">  in: 分类于</div><div class="line">  visitors: 阅读量</div><div class="line">  read_more: 阅读全文</div><div class="line">  untitled: 未命名</div><div class="line">  toc_empty: 此文章未包含目录</div></pre></td></tr></table></figure>
<p>其他语言与之类似，将visitors设置成你希望翻译的字段。最后，重新清除并生成你的网站即可。</p>
<blockquote>
<p>Web安全性</p>
</blockquote>
<p>为了保证应用的统计计数功能仅应用于自己的博客系统，你可以在应用-&gt;设置-&gt;安全中心的Web安全域名中加入自己的博客域名，以保证数据的调用安全。直接加上首页地址即可,保存三分之后生效，这时在本地方访问便不会统计。<br>参阅：<a href="http://www.jeyzhang.com/hexo-next-add-post-views.html" target="_blank" rel="external">http://www.jeyzhang.com/hexo-next-add-post-views.html</a></p>
<h2 id="7-3-文章最近访问时间"><a href="#7-3-文章最近访问时间" class="headerlink" title="7.3.文章最近访问时间"></a>7.3.文章最近访问时间</h2><blockquote>
<p>改themes\next\layout_scripts\third-party\lean-analytics.swig文件</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div></pre></td><td class="code"><pre><div class="line">&#123;% if theme.leancloud_visitors.enable %&#125;</div><div class="line">  &#123;# custom analytics part create by xiamo #&#125;</div><div class="line">  &lt;script src=&quot;https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js&quot;&gt;&lt;/script&gt;</div><div class="line">  &lt;script&gt;AV.initialize(&quot;&#123;&#123;theme.leancloud_visitors.app_id&#125;&#125;&quot;, &quot;&#123;&#123;theme.leancloud_visitors.app_key&#125;&#125;&quot;);&lt;/script&gt;</div><div class="line">  &lt;script&gt;</div><div class="line">    function showTime(Counter) &#123;</div><div class="line">      var query = new AV.Query(Counter);</div><div class="line">      var entries = [];</div><div class="line">      var $visitors = $(&quot;.leancloud_visitors&quot;);</div><div class="line">      $visitors.each(function () &#123;</div><div class="line">        entries.push( $(this).attr(&quot;id&quot;).trim() );</div><div class="line">      &#125;);</div><div class="line">      query.containedIn(&apos;url&apos;, entries);</div><div class="line">      query.find()</div><div class="line">        .done(function (results) &#123;</div><div class="line">          var COUNT_CONTAINER_REF = &apos;.leancloud-visitors-count&apos;;</div><div class="line">          var UPDATED_AT = &apos;.leancloud-updated-at&apos;; // 新增代码 定义最近变更时间的class</div><div class="line">          if (results.length === 0) &#123;</div><div class="line">            $visitors.find(COUNT_CONTAINER_REF).text(0);</div><div class="line">            return;</div><div class="line">          &#125;</div><div class="line">          // console.log(results);</div><div class="line">          for(var i = 0; i &lt; results.length; i++) &#123;</div><div class="line">            var item = results[i];</div><div class="line">            var url = item.get(&apos;url&apos;);</div><div class="line">            var time = item.get(&apos;time&apos;);   // 获取阅读量</div><div class="line">            var updatedT = item.updatedAt; // 新增代码 获取最近浏览时间 需要注意的是updateT是对象并不是字符串</div><div class="line">            var element = document.getElementById(url);</div><div class="line">            $(element).find(COUNT_CONTAINER_REF).text(time);</div><div class="line">            // 新增代码 转换日期格式</div><div class="line">            if(updatedT != null &amp;&amp; updatedT != &apos;&apos;) &#123;</div><div class="line">              var a = [updatedT.getFullYear(), updatedT.getMonth() + 1, updatedT.getDate(), updatedT.getHours(), updatedT.getMinutes(), updatedT.getSeconds()];</div><div class="line">              for(var j = 0,len = a.length; j &lt; len; j++) &#123;</div><div class="line">                  if(a[j] &lt; 10) &#123;</div><div class="line">                      a[j] = &apos;0&apos; + a[j];</div><div class="line">                  &#125;</div><div class="line">              &#125;</div><div class="line">              var updateTime = a[0] + &apos;-&apos; + a[1] + &apos;-&apos; + a[2] + &apos; &apos; + a[3] + &apos;:&apos; + a[4] + &apos;:&apos; + a[5];</div><div class="line">              $(element).find(UPDATED_AT).text(updateTime);</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">          for(var i = 0; i &lt; entries.length; i++) &#123;</div><div class="line">            var url = entries[i];</div><div class="line">            var element = document.getElementById(url);</div><div class="line">            var countSpan = $(element).find(COUNT_CONTAINER_REF);</div><div class="line">            var updatedAtContent = $(element).find(UPDATED_AT);</div><div class="line">            if( countSpan.text() == &apos;&apos;) &#123;</div><div class="line">              countSpan.text(0);</div><div class="line">            &#125;</div><div class="line">            // 新增代码 如果首页的文章没有更新侧默认为无人浏览</div><div class="line">            if(updatedAtContent.text() == &apos;&apos;) &#123;</div><div class="line">              updatedAtContent.text(&apos;无人浏览&apos;);</div><div class="line">            &#125;</div><div class="line">            // 结束</div><div class="line">          &#125;</div><div class="line">        &#125;)</div><div class="line">        .fail(function (object, error) &#123;</div><div class="line">          console.log(&quot;Error: &quot; + error.code + &quot; &quot; + error.message);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">    function addCount(Counter) &#123;</div><div class="line">      var $visitors = $(&quot;.leancloud_visitors&quot;);</div><div class="line">      var url = $visitors.attr(&apos;id&apos;).trim();</div><div class="line">      var title = $visitors.attr(&apos;data-flag-title&apos;).trim();</div><div class="line">      var query = new AV.Query(Counter);</div><div class="line">      query.equalTo(&quot;url&quot;, url);</div><div class="line">      query.find(&#123;</div><div class="line">        success: function(results) &#123;</div><div class="line">          if (results.length &gt; 0) &#123;</div><div class="line">            var counter = results[0];</div><div class="line">            counter.fetchWhenSave(true);</div><div class="line">            counter.increment(&quot;time&quot;);</div><div class="line">            counter.save(null, &#123;</div><div class="line">              success: function(counter) &#123;</div><div class="line">                var $element = $(document.getElementById(url));</div><div class="line">                $element.find(&apos;.leancloud-visitors-count&apos;).text(counter.get(&apos;time&apos;));</div><div class="line">              &#125;,</div><div class="line">              error: function(counter, error) &#123;</div><div class="line">                console.log(&apos;Failed to save Visitor num, with error message: &apos; + error.message);</div><div class="line">              &#125;</div><div class="line">            &#125;);</div><div class="line">          &#125; else &#123;</div><div class="line">            var newcounter = new Counter();</div><div class="line">            /* Set ACL */</div><div class="line">            var acl = new AV.ACL();</div><div class="line">            acl.setPublicReadAccess(true);</div><div class="line">            acl.setPublicWriteAccess(true);</div><div class="line">            newcounter.setACL(acl);</div><div class="line">            /* End Set ACL */</div><div class="line">            newcounter.set(&quot;title&quot;, title);</div><div class="line">            newcounter.set(&quot;url&quot;, url);</div><div class="line">            newcounter.set(&quot;time&quot;, 1);</div><div class="line">            newcounter.save(null, &#123;</div><div class="line">              success: function(newcounter) &#123;</div><div class="line">                var $element = $(document.getElementById(url));</div><div class="line">                $element.find(&apos;.leancloud-visitors-count&apos;).text(newcounter.get(&apos;time&apos;));</div><div class="line">              &#125;,</div><div class="line">              error: function(newcounter, error) &#123;</div><div class="line">                console.log(&apos;Failed to create&apos;);</div><div class="line">              &#125;</div><div class="line">            &#125;);</div><div class="line">          &#125;</div><div class="line">        &#125;,</div><div class="line">        error: function(error) &#123;</div><div class="line">          console.log(&apos;Error:&apos; + error.code + &quot; &quot; + error.message);</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">    $(function() &#123;</div><div class="line">      var Counter = AV.Object.extend(&quot;Counter&quot;);</div><div class="line">      if ($(&apos;.leancloud_visitors&apos;).length == 1) &#123;</div><div class="line">        addCount(Counter);</div><div class="line">      &#125; else if ($(&apos;.post-title-link&apos;).length &gt; 1) &#123;</div><div class="line">        showTime(Counter);</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">  &lt;/script&gt;</div><div class="line">&#123;% endif %&#125;</div></pre></td></tr></table></figure>
<h2 id="7-4-添加文章更新时间"><a href="#7-4-添加文章更新时间" class="headerlink" title="7.4.添加文章更新时间"></a>7.4.添加文章更新时间</h2><blockquote>
<p>scaffolds\post.md 文件</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">title: &#123;&#123; title &#125;&#125;</div><div class="line">date: &#123;&#123; date &#125;&#125;</div><div class="line">categories:</div><div class="line">tags:</div><div class="line">update: &#123;&#123; date &#125;&#125;  # 新增更新时间</div><div class="line">---</div></pre></td></tr></table></figure>
<blockquote>
<p>themes\next\layout_macro\post.swig 文件</p>
</blockquote>
<p>找到以下代码的位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;span class=&quot;post-time&quot;&gt;</div><div class="line">  &lt;span class=&quot;post-meta-item-icon&quot;&gt;</div><div class="line">    &lt;i class=&quot;fa fa-calendar-o&quot;&gt;&lt;/i&gt;</div><div class="line">  &lt;/span&gt;</div><div class="line">  &lt;span class=&quot;post-meta-item-text&quot;&gt;&#123;&#123; __(&apos;post.posted&apos;) &#125;&#125;&lt;/span&gt;</div><div class="line">  &lt;time itemprop=&quot;dateCreated&quot; datetime=&quot;&#123;&#123; moment(post.date).format() &#125;&#125;&quot; content=&quot;&#123;&#123; date(post.date, config.date_format) &#125;&#125;&quot;&gt;</div><div class="line">    &#123;&#123; date(post.date, config.date_format) &#125;&#125;</div><div class="line">  &lt;/time&gt;</div><div class="line">&lt;/span&gt;</div></pre></td></tr></table></figure>
<p>进行追加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;span class=&quot;post-time&quot;&gt;</div><div class="line">  &lt;span class=&quot;post-meta-item-icon&quot;&gt;</div><div class="line">    &lt;i class=&quot;fa fa-calendar-o&quot;&gt;&lt;/i&gt;</div><div class="line">  &lt;/span&gt;</div><div class="line">  &lt;span class=&quot;post-meta-item-text&quot;&gt;&#123;&#123; __(&apos;post.posted&apos;) &#125;&#125;&lt;/span&gt;</div><div class="line">  &lt;time itemprop=&quot;dateCreated&quot; datetime=&quot;&#123;&#123; moment(post.date).format() &#125;&#125;&quot; content=&quot;&#123;&#123; date(post.date, config.date_format) &#125;&#125;&quot;&gt;</div><div class="line">    &#123;&#123; date(post.date, config.date_format) &#125;&#125;</div><div class="line">  &lt;/time&gt;</div><div class="line">&lt;/span&gt;</div><div class="line">&#123;# 追加代码 #&#125;</div><div class="line">&lt;span&gt;</div><div class="line">    |</div><div class="line">  &lt;span&gt;&#123;&#123; __(&apos;post.update&apos;) &#125;&#125;&lt;/span&gt;</div><div class="line">  &lt;time&gt;</div><div class="line">    &#123;&#123; date(post.update, config.date_format) &#125;&#125;</div><div class="line">    &#123;&#123; date(post.update, config.time_format) &#125;&#125;</div><div class="line">  &lt;/time&gt;</div><div class="line">&lt;/span&gt;</div></pre></td></tr></table></figure></p>
<p>在每次新建文章时，默认更新时间就是发表时间，更新文章时需要手动修改udpate的值。例如source_posts\hexo之next主题.md</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">title: Hexo之NexT主题搭建博客详细过程</div><div class="line">date: 2016-10-03 15:39:31</div><div class="line">update: 2016-10-03 15:39:31      # 每次更新需手动修改成这样的格式时间</div><div class="line">categories: hexo</div><div class="line">tags: [nodejs, hexo]</div><div class="line">---</div></pre></td></tr></table></figure>
<blockquote>
<p>修改themes\next\languages\zh-Hans.yml</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">post:</div><div class="line">  sticky: 置顶</div><div class="line">  posted: 发表于</div><div class="line">  updated: 最近</div><div class="line">  update: 更新于     # 新增</div><div class="line">  in: 分类于</div><div class="line">  visitors: 阅读量</div><div class="line">  read_more: 阅读全文</div><div class="line">  untitled: 未命名</div><div class="line">  toc_empty: 此文章未包含目录</div></pre></td></tr></table></figure>
<h2 id="7-5-设置阅读全文时不显示最近访问时间"><a href="#7-5-设置阅读全文时不显示最近访问时间" class="headerlink" title="7.5.设置阅读全文时不显示最近访问时间"></a>7.5.设置阅读全文时不显示最近访问时间</h2><blockquote>
<p>修改themes\next\layout_macro\post.swig 文件</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&#123;# LeanCould PageView #&#125;</div><div class="line">  &#123;% if theme.leancloud_visitors.enable %&#125;</div><div class="line">     &lt;span id=&quot;&#123;&#123; url_for(post.path) &#125;&#125;&quot; class=&quot;leancloud_visitors&quot; data-flag-title=&quot;&#123;&#123; post.title &#125;&#125;&quot;&gt;</div><div class="line">       |</div><div class="line">       &lt;span class=&quot;post-meta-item-icon&quot;&gt;</div><div class="line">         &lt;i class=&quot;fa fa-eye&quot;&gt;&lt;/i&gt;</div><div class="line">       &lt;/span&gt;</div><div class="line">       &lt;span class=&quot;post-meta-item-text&quot;&gt;&#123;&#123;__(&apos;post.visitors&apos;)&#125;&#125; &lt;/span&gt;</div><div class="line">       &lt;span class=&quot;leancloud-visitors-count&quot;&gt;&lt;/span&gt;</div><div class="line">      &#123;% if not is_pv %&#125;    &#123;# 新增is_pv字段判断是否为首页 #&#125;</div><div class="line">        |</div><div class="line">        &lt;span class=&quot;post-meta-item-text&quot;&gt;&#123;&#123;__(&apos;post.updated&apos;)&#125;&#125; &lt;/span&gt;</div><div class="line">        &lt;span class=&quot;leancloud-updated-at&quot;&gt;&lt;/span&gt;</div><div class="line">        &lt;/span&gt;</div><div class="line">      &#123;% endif %&#125;           &#123;# if结束 #&#125;</div><div class="line">&#123;% endif %&#125;</div></pre></td></tr></table></figure>
<p>在文件开头修改传进的参数字段<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;% macro render(post, is_index, is_pv, post_extra_class) %&#125;   &#123;# 新增第三个字段is_pv #&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>修改themes/next/layout目录下的post.swig文件</p>
</blockquote>
<p>这个文件是文章的模板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;% block content %&#125;</div><div class="line">  &lt;div id=&quot;posts&quot; class=&quot;posts-expand&quot;&gt;</div><div class="line">  	#render方法第二个参数is_index为是否为首页</div><div class="line">  	#第三个参数is_pv为我们刚才设置的是否显示计数</div><div class="line">    &#123;&#123; post_template.render(page, false, true) &#125;&#125;</div><div class="line">    &lt;div class=&quot;post-spread&quot;&gt;</div><div class="line">      &#123;% if theme.jiathis %&#125;</div><div class="line">        &#123;% include &apos;_partials/share/jiathis.swig&apos; %&#125;</div><div class="line">      &#123;% elseif theme.duoshuo_shortname and theme.duoshuo_share %&#125;</div><div class="line">        &#123;% include &apos;_partials/share/duoshuo_share.swig&apos; %&#125;</div><div class="line">      &#123;% endif %&#125;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&#123;% endblock %&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>修改themes/next/layout目录下的index.swig文件</p>
</blockquote>
<p>这个文件是首页的模板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">找到以下代码，给render方法传入刚才第一步中设置的参数。</div><div class="line">&#123;% block content %&#125;</div><div class="line">  &lt;section id=&quot;posts&quot; class=&quot;posts-expand&quot;&gt;</div><div class="line">    &#123;% for post in page.posts %&#125;</div><div class="line">       #render方法第二个参数is_index为是否为首页</div><div class="line">       #第三个参数is_pv为我们刚才设置的是否显示计数</div><div class="line">      &#123;&#123; post_template.render(post, true, false) &#125;&#125;</div><div class="line">    &#123;% endfor %&#125;</div><div class="line">  &lt;/section&gt;</div><div class="line">  &#123;% include &apos;_partials/pagination.swig&apos; %&#125;</div><div class="line">&#123;% endblock %&#125;</div></pre></td></tr></table></figure></p>
<p>这样的效果是在首页显示最近阅读时间，阅读全文时文章标题不显示最近阅读时间。</p>
<h2 id="7-6-为文章增加分享"><a href="#7-6-为文章增加分享" class="headerlink" title="7.6.为文章增加分享"></a>7.6.为文章增加分享</h2><blockquote>
<p>使用多说分享</p>
</blockquote>
<p>多说评论在前面的使用留言功能已经介绍了，这里值修改主题配置文件即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 多说热评文章</div><div class="line">duoshuo_hotartical: true # 开启多说热评文章</div></pre></td></tr></table></figure></p>
<h2 id="7-7-为文章增加打赏"><a href="#7-7-为文章增加打赏" class="headerlink" title="7.7.为文章增加打赏"></a>7.7.为文章增加打赏</h2><blockquote>
<p>修改主题配置文件, 收款二维码放在themes\next\source\images 目录下</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># Donate 文章末尾显示打赏按钮</div><div class="line">reward_comment: 如果文章对您有用请随意打赏，谢谢支持！</div><div class="line">wechatpay: /images/w.png</div><div class="line">alipay: /images/z.jpg</div></pre></td></tr></table></figure>
<h2 id="7-8-设置代码高亮主题"><a href="#7-8-设置代码高亮主题" class="headerlink" title="7.8.设置代码高亮主题"></a>7.8.设置代码高亮主题</h2><p>NexT 使用 Tomorrow Theme 作为代码高亮，共有5款主题供你选择。 NexT 默认使用的是 白色的 normal 主题，可选的值有 normal，night， night blue， night bright， night eighties：<br>在主题配置文件中修改<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># Code Highlight theme</div><div class="line"># Available value:</div><div class="line">#    normal | night | night eighties | night blue | night bright</div><div class="line"># https://github.com/chriskempson/tomorrow-theme</div><div class="line">highlight_theme: night eighties       # 修改即可</div></pre></td></tr></table></figure></p>
<h2 id="7-9-文章添加音乐链接"><a href="#7-9-文章添加音乐链接" class="headerlink" title="7.9.文章添加音乐链接"></a>7.9.文章添加音乐链接</h2><p>Hexo支持解析markdown语法，因此每篇博文都是以.md结尾的文件。而markdown又支持如表格、脚注、内嵌HTML等等，所以在.md文件中直接添加html代码！<br>网音乐云音乐，虾米音乐都可以生成内嵌音乐的html代码，复制粘贴到.md文件中即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;div&gt;</div><div class="line">	&lt;center&gt;</div><div class="line">		&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=330 height=86</div><div class="line">			src=&quot;https://music.163.com/outchain/player?type=2&amp;id=33856282&amp;auto=0&amp;height=66&quot;&gt;</div><div class="line">		&lt;/iframe&gt;</div><div class="line">	&lt;/center&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<h1 id="8-本地站内搜索"><a href="#8-本地站内搜索" class="headerlink" title="8.本地站内搜索"></a>8.本地站内搜索</h1><p>以前使用的Swiftype现在不能免费使用了，我这里就是用本地配置进行站内搜索</p>
<blockquote>
<p>安装 hexo-generator-search，在站点的根目录下执行以下命令:</p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> install hexo-generator-search --save</div></pre></td></tr></table></figure>
<blockquote>
<p>编辑 站点配置文件，新增以下内容到任意位置：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">search:</div><div class="line">  path: search.xml</div><div class="line">  field: post</div></pre></td></tr></table></figure>
<h1 id="9-统计站点访次数和访问量"><a href="#9-统计站点访次数和访问量" class="headerlink" title="9.统计站点访次数和访问量"></a>9.统计站点访次数和访问量</h1><blockquote>
<p>修改themes/next/layout/_partials目录下的footer.swig</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;div class=&quot;theme-info&quot;&gt;</div><div class="line">  &#123;&#123; __(&apos;footer.theme&apos;) &#125;&#125; -</div><div class="line">  &lt;a class=&quot;theme-link&quot; href=&quot;https://github.com/iissnan/hexo-theme-next&quot;&gt;</div><div class="line">    NexT.&#123;&#123; theme.scheme &#125;&#125;</div><div class="line">  &lt;/a&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&#123;# 新增代码 #&#125;</div><div class="line">&lt;script async src=&quot;https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;div style=&quot;margin:-20px;position: absolute;right:265px;&quot;&gt;</div><div class="line">&lt;dl style=&quot;float:left&quot;&gt;</div><div class="line">  &lt;dt style=&quot;float:left&quot;&gt;</div><div class="line">    &lt;dd style=&quot;float:left;width:300px&quot;&gt;</div><div class="line">      &lt;span style=&quot;float:right&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&lt;/span&gt;</div><div class="line">      &lt;span style=&quot;float:right&quot;&gt;本站总访问量&lt;span&gt;&lt;span style=&quot;float:right&quot; id=&quot;busuanzi_value_site_pv&quot;&gt;&lt;/span&gt;</div><div class="line">    &lt;/dd&gt;</div><div class="line">  &lt;/dt&gt;</div><div class="line">  &lt;dt style=&quot;float:left;width:300px&quot;&gt;</div><div class="line">    &lt;dd&gt;</div><div class="line">      &lt;span style=&quot;float:left&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;</div><div class="line">      &lt;span style=&quot;float:left&quot;&gt;您是第&lt;/span&gt;</div><div class="line">      &lt;span style=&quot;float:left&quot; id=&quot;busuanzi_value_site_uv&quot;&gt;&lt;/span&gt;</div><div class="line">      &lt;span style=&quot;float:left&quot;&gt;个小伙伴&lt;/span&gt;</div><div class="line">    &lt;/dd&gt;</div><div class="line">  &lt;/dt&gt;</div><div class="line">&lt;/dl&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&#123;# 结束 #&#125;</div></pre></td></tr></table></figure>
<p>到此本地资源博客搭建已经完成，有些细微调节可根据浏览器控制台找到对应的模板进行调节，比如站点背景(可以指定动画图片，参考资源： <a href="http://michaelxiang.me/2015/11/30/hexo-next-optimize/" target="_blank" rel="external">http://michaelxiang.me/2015/11/30/hexo-next-optimize/</a> )，代码字体字体颜色(参考资源： <a href="http://gniba.com/2016/07/11/next-custom.html" target="_blank" rel="external">http://gniba.com/2016/07/11/next-custom.html</a> )，页面宽度等等</p>
<h1 id="10-博客项目托管到github"><a href="#10-博客项目托管到github" class="headerlink" title="10.博客项目托管到github"></a>10.博客项目托管到github</h1><blockquote>
<p>注册github账号</p>
</blockquote>
<p>网址：<a href="https://github.com/" target="_blank" rel="external">https://github.com/</a><br>点击 new repository<br><img src="https://volc1605.github.io/images/Hexo之NexT主题搭建博客详细过程/g.png" alt="xinjian"></p>
<blockquote>
<p>修改站点配置文件</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Deployment</div><div class="line">## Docs: https://hexo.io/docs/deployment.html</div><div class="line">deploy:</div><div class="line">  type: git</div><div class="line">  repository: git@github.com:volc1605/volc1605.github.io.git</div><div class="line">  branch: master</div></pre></td></tr></table></figure>
<p>点击进入新建的项目，如图<br><img src="https://volc1605.github.io/images/Hexo之NexT主题搭建博客详细过程/d.png" alt="xj"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">repository： git@github.com:上图划线部分.git</div></pre></td></tr></table></figure></p>
<blockquote>
<p>配置sshkey</p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">ssh</span>-keygen -t rsa -C <span class="string">"注册git的邮箱"</span></div></pre></td></tr></table></figure>
<p>连续几个按回车，密码为空，然后在在C:\Users\Administrator.ssh下，得到两个文件id_rsa和id_rsa.pub<br>复制id_rsa.pub中的所有内容</p>
<blockquote>
<p>GitHub上添加SSH密钥</p>
</blockquote>
<p>打开<a href="https://github.com/settings/ssh" target="_blank" rel="external">https://github.com/settings/ssh</a> new SSH key 添加密钥，title随便写，key为刚刚复制的内容</p>
<blockquote>
<p>验证是否能否连接到github</p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh -T git@github.com</div></pre></td></tr></table></figure>
<p>如果提示<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">The</span> authenticity of host 'github.com (192.30.253.112)' can't be established.</div><div class="line"><span class="attribute">RSA</span> key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8.</div><div class="line"><span class="attribute">Are</span> you sure you want to continue connecting (yes/no)? y</div><div class="line"><span class="attribute">Please</span> type 'yes' or 'no': yes</div></pre></td></tr></table></figure></p>
<p>或者提示覆盖原来的文件，选择yes回车，只要能看到，如下提示就能成功连接到github</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">Hi</span> zhangsan! You've successfully authenticated, but GitHub does not provide shell access.</div></pre></td></tr></table></figure>
<h1 id="11-百度-google收录你的站点"><a href="#11-百度-google收录你的站点" class="headerlink" title="11.百度/google收录你的站点"></a>11.百度/google收录你的站点</h1><blockquote>
<p>安装sitemap插件</p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> install hexo-generator-sitemap --save        # google</div><div class="line"><span class="attribute">npm</span> install hexo-generator-baidu-sitemap --save  # 百度</div></pre></td></tr></table></figure>
<blockquote>
<p>在站点配置文件_config.yml中添加如下代码：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># 自动生成sitemap</div><div class="line">sitemap:</div><div class="line">path: sitemap.xml</div><div class="line">baidusitemap:</div><div class="line">path: baidusitemap.xml</div></pre></td></tr></table></figure>
<p>会在public目录下生成baidusitmap.xml 和 sitemap.xml两个文件  </p>
<blockquote>
<p>安装hexo-deployer-git插件</p>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">npm</span> install hexo-deployer-git --save</div></pre></td></tr></table></figure>
<blockquote>
<p>部署到github</p>
</blockquote>
<p>在blog目录下执行命令<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">hexo</span> clean # 清除资源</div><div class="line"><span class="attribute">hexo</span> g     # 生成静态资源</div><div class="line"><span class="attribute">hexo</span> d     # 部署</div></pre></td></tr></table></figure></p>
<p>登录在github打开存放博客资源的仓库，就能看到部署的资源文件<br><img src="https://volc1605.github.io/images/Hexo之NexT主题搭建博客详细过程/git.png" alt=""></p>
<blockquote>
<p>分别向google,baidu提交站点地图sitemap.xml,baidusitmap.xml</p>
</blockquote>
<p>百度站长： <a href="http://zhanzhang.baidu.com/site/index" target="_blank" rel="external">http://zhanzhang.baidu.com/site/index</a><br>输入你想添加的网站：你的博客首页地址<br>下一步，下载html文件验证，在原来内容上添加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">layout: false</div><div class="line">---</div></pre></td></tr></table></figure></p>
<p>例如<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">layout: false</div><div class="line">---</div><div class="line">HTYJLXSGJOnjlg</div></pre></td></tr></table></figure></p>
<p>目的是不让站点解析这个baidu_verify_lpmmZiuzEL.html文件，修改完成后放到blog/source目录下重新部署，然后点击完成验证。<br>google站长： <a href="https://www.google.com/webmasters/tools/home?hl=zh-CN" target="_blank" rel="external">https://www.google.com/webmasters/tools/home?hl=zh-CN</a><br>添加网站后，进行左侧抓取站点地图，添加/测试站点地图，填写sitemap.xml。sitemap.xml就在github存放博客仓库的根目录下<br>验证完成后大概过一天时间便可google到你的站点了。<br>而百度的话，就看造化了。</p>
<h1 id="12-关于github访问不到css、js文件"><a href="#12-关于github访问不到css、js文件" class="headerlink" title="12.关于github访问不到css、js文件"></a>12.关于github访问不到css、js文件</h1><p>浏览器控制可以看到问题所在访问不到vendors/source<br><img src="https://volc1605.github.io/images/Hexo之NexT主题搭建博客详细过程/vendors.png" alt="vendors"><br>问题原因不清楚，但通过一下方式可以解决问题<br>根据作者的提示 @iissnan ，首先修改source/vendors为source/lib，然后修改_config.yml， 将 _internal: vendors修改为_internal:lib 然后修改next底下所有引用source/vendors路径为source/lib。这些地方可以通过文件查找找出来。<br>主要集中在这几个文件中。  </p>
<ol>
<li>Hexo\themes\next.bowerrc   </li>
<li>Hexo\themes\next.gitignore   </li>
<li>Hexo\themes\next.javascript_ignore   </li>
<li>Hexo\themes\next\bower.json   </li>
</ol>
<h1 id="13-统计本站运行天数"><a href="#13-统计本站运行天数" class="headerlink" title="13.统计本站运行天数"></a>13.统计本站运行天数</h1><p>修改blog\themes\next\layout_partials\footer.swig文件，在后面追加一下代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">	<span class="keyword">var</span> birthDay = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'09/1/2016'</span>);</div><div class="line">	<span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">	<span class="keyword">var</span> duration = now.getTime() - birthDay.getTime();</div><div class="line">	<span class="keyword">var</span> total= <span class="built_in">Math</span>.floor(duration / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>));</div><div class="line">	<span class="built_in">document</span>.getElementById(<span class="string">'showDays'</span>).innerHTML=<span class="string">'本站已运行'</span> + total + <span class="string">'天'</span>;</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure></p>
<p>在最后一个div中追加一下代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;<span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></div><div class="line">&lt;span id=<span class="string">"showDays"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></div></pre></td></tr></table></figure></p>
<blockquote>
<p>写博客推荐工具:<br><a href="https://www.zybuluo.com/mdeditor" target="_blank" rel="external">https://www.zybuluo.com/mdeditor</a><br><a href="https://atom.io/" target="_blank" rel="external">https://atom.io/</a><br>参考资料：<br>  为NexT主题添加文章阅读量统计功能:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.tuicool.com/articles/YB3EJnz" target="_blank" rel="external">http://www.tuicool.com/articles/YB3EJnz</a><br>git - 简易指南:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.bootcss.com/p/git-guide/" target="_blank" rel="external">http://www.bootcss.com/p/git-guide/</a><br>hexo之next主题优化整理:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://michaelxiang.me/2015/11/30/hexo-next-optimize/" target="_blank" rel="external">http://michaelxiang.me/2015/11/30/hexo-next-optimize/</a><br>自定义NexT.Pisces主题:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://gniba.com/2016/07/11/next-custom.html" target="_blank" rel="external">http://gniba.com/2016/07/11/next-custom.html</a><br>为Hexo博客的每一篇文章自动追加版权信息:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://kuangqi.me/tricks/append-a-copyright-info-after-every-post/" target="_blank" rel="external">http://kuangqi.me/tricks/append-a-copyright-info-after-every-post/</a><br>为Hexo博客添加版权说明和打赏功能:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.tuicool.com/articles/m6bIJfq" target="_blank" rel="external">http://www.tuicool.com/articles/m6bIJfq</a><br>[CSS] 给 HEXO 博客自定义背景图:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://blog.qiji.tech/archives/7854" target="_blank" rel="external">http://blog.qiji.tech/archives/7854</a><br>主题配置:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://theme-next.iissnan.com/theme-settings.html" target="_blank" rel="external">http://theme-next.iissnan.com/theme-settings.html</a><br>多说、RSS和sitemap插件:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://blog.csdn.net/willxue123/article/details/50994854" target="_blank" rel="external">http://blog.csdn.net/willxue123/article/details/50994854</a><br>在Github上面搭建Hexo博客（一）：部署到Github:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cnblogs.com/cherishzy/p/5694658.html" target="_blank" rel="external">http://www.cnblogs.com/cherishzy/p/5694658.html</a><br>第三方服务集成:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://theme-next.iissnan.com/third-party-services.html#analytics-google" target="_blank" rel="external">http://theme-next.iissnan.com/third-party-services.html#analytics-google</a></p>
</blockquote>
]]></content>
    </entry>
    
  
  
</search>
